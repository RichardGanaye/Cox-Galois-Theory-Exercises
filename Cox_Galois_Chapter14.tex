%&LaTeX
\documentclass[11pt,a4paper]{article}
\usepackage[frenchb,english]{babel}
\usepackage[applemac]{inputenc}
\usepackage[OT1]{fontenc}
\usepackage[]{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{tikz}
%\input{8bitdefs}

% marges
\topmargin 10pt
\headsep 10pt
\headheight 10pt
\marginparwidth 30pt
\oddsidemargin 40pt
\evensidemargin 40pt
\footskip 30pt
\textheight 670pt
\textwidth 420pt

\def\imp{\Rightarrow}
\def\gcro{\mbox{[\hspace{-.15em}[}}% intervalles d'entiers 
\def\dcro{\mbox{]\hspace{-.15em}]}}

\newcommand{\be} {\begin{enumerate}}
\newcommand{\ee} {\end{enumerate}}
\newcommand{\deb}{\begin{eqnarray*}}
\newcommand{\fin}{\end{eqnarray*}}
\newcommand{\ssi} {si et seulement si }
\newcommand{\D}{\mathrm{d}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\U}{\mathbb{U}}
\newcommand{\re}{\,\mathrm{Re}\,}
\newcommand{\im}{\,\mathrm{Im}\,}
\newcommand{\ord}{\mathrm{ord}}
\newcommand{\Gal}{\mathrm{Gal}}
\newcommand{\legendre}[2]{\genfrac{(}{)}{}{}{#1}{#2}}

\title{Solutions to David A.Cox  "Galois Theory''}

\refstepcounter{section} \refstepcounter{section}
\refstepcounter{section} \refstepcounter{section}
\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}
\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}


\begin{document}



\section{Chapter 14 : SOLVABLE PERMUTATION GROUPS}

\subsection{POLYNOMIAL OF PRIME DEGREE}

\paragraph{Ex. 14.1.1}
{\it This exercise is concerned with the proof of part (a) of Lemma 14.1.2. Let $\theta =(1\, 2 \ldots p)\in S_p$.
\begin{enumerate}
\item[(a)] Prove that $\tau\in S_p$ lies in the normalizer of $\langle\theta\rangle$ if and only if $\tau\theta =\theta^l\tau$ for some $1\leq l\leq p-1$.
\item[(b)] Prove that (14.1) implies that $\tau(i+j)=\tau(i)+jl$ for all positive integers j.
\end{enumerate}
}
\begin{proof}
\begin{enumerate}
\item[(a)]
If $\theta$ lies in the normalizer of $\langle \theta\rangle = \{e,\theta,\theta^2,\ldots,\theta^{p-1}\}$, then
$$\tau \theta \tau^{-1} \in \tau \langle \theta \rangle \tau^{-1}= \langle \theta \rangle,$$
hence
$$\tau \theta \tau^{-1} =\theta^l \text{ for some } l = 0,1\ldots,p-1.$$
If $l = 0$, then $\tau \theta \tau^{-1} = e$, thus $\tau \theta = \tau$, and $\theta = e$, which is false. Therefore $l \ne 0$.
$$\tau \theta \tau^{-1} =\theta^l , \ 1\leq l \leq p-1.$$

 \item[(b)] By induction suppose that $\tau(i+j)=\tau(i)+jl$, then $\tau(i+j+1)=\tau(i+j)+l=\tau(i)+(j+1)l$. Case $j=1$ is valid by the identity (14.1). Hence, $\tau(i+j)=\tau(i)+jl$ for all positive integers $j$.  
\end{enumerate}
\end{proof}

\paragraph{Ex. 14.1.2}

{\it Let $H$ be a normal subgroup of a finite group $G$ and let $g\in G$. The goal of this exercise is to prove Lemma 14.1.3.
\begin{enumerate}
\item[(a)] Explain why $(gH)^{o(g)}=(gH)^{[G:H]}=H$ in the quotient group $G/H$.
\item[(b)] Now assume that $\gcd(o(g),[G:H])=1$. Prove that $g\in H$.
\end{enumerate}
}
\begin{proof}
\begin{enumerate}
\item[(a)] Since $(gH)^2=gHgH=g^2H$ and $g^{o(g)}=e$, $(gH)^{o(g)}=g^{o(g)}H=H$.

Since $gH\in G/H$, exists some minimal $l$ such that $(gH)^l=H$ and $l\mid [G:H]$, i.e. $[G:H]=ql$. Then $(gH)^{[G:H]}=(gH)^{ql}=H^q=H$.
\item[(b)] The assumption $\gcd(o(g),[G:H])=1$ means that $o(g)q+[G:H]l=1$ for some $q,l\in\mathbb{Z}$. Then $gH=(gH)^{o(g)q+[G:H]l}=((gH)^{o(g)})^q((gH)^{[G:H]})^l=H^qH^l=H$, i.e. $g\in H$.
\end{enumerate}

\end{proof}

\paragraph{Ex. 14.1.3}

{\it Let $G$ satisfy (14.2). Use (14.2) and the Third Sylow Theorem to prove that $G$ has a unique p-Sylow subgroup $H$ of order $p$. Then conclude that $H$ is normal in $G$.
}

\begin{proof}
By (14.2),
 $$|G|= |\Gal(L/F)| =pm, \qquad 1\leq m \leq p-1.$$

According the Third Sylow Theorem the number $N$ of p-Sylow subgroups of G satisfies
 $$N\equiv 1 \pmod p,  \qquad N\mid |G|,$$ 
so that $N = 1 + kp,\ k\geq 0$, thus $N \wedge p = 1$, and $N \mid pm$, therefore $N \mid m$. If $k\ne 0$, then $N>p$, but $N \mid m>0$, which implies $N \leq m <p$. This contradiction shows that $k = 0$, and $N = 1$, i.e. there is exactly one $p$-Sylow subgroup $H$ of $G$.

For all $g \in G$, $gHg^{-1}$ is also a $p$-Sylow subgroup of $G$, hence $gHg^{-1}=H$ for all
$g \in G$: $H$ is normal in $G$.

\end{proof}

\paragraph{Ex. 14.1.4}

{\it The definition of Frobenius group given in the Mathematical Notes involves a group $G$ acting transitively on a set $X$. Prove that a group $G$ is a Frobenius group if and only if $G$ has a subgroup $H$ such that $1<|H|<|G|$ and $H\cap gHg^{-1}=\{e\}$ for all $g \notin H$.
}

\begin{proof}

$(\Rightarrow)$ Assume that $G$  is a Frobenius group. Then $G$ acts transitively on a set $X$ such that $1< |X| < |G|$, and for every $(x,y) \in X \times X$ such that $x \ne y$, the identity is the only element of $G$ fixing $x$ and $y$.

First we show that every isotropy group $G_x$ is non trivial, i.e. $G_x \ne \{e\}$ and $G_x \ne G$, for all $x \in G$.

Since $G$ acts transitively on $X$, $X = G\cdot x$ is the orbit of $x$, thus
$$ |X| = |G\cdot x | = (G:G_x) = |G| / |G_x|,$$
and since $1 < |X| < |G|$, this proves $1 < |G_x| < |G|$, so $ G_x \ne \{e\}, G_x \ne G$.
Fix $x_0 \in G, x_0 \ne e$, and take $H = G_{x_0}$ the isotropy group of this chosen element $x_0$. Then $1<|H|<G$.

Assume that $g \in G, g \not \in H$, and $h \in H \cap gHg^{-1}$. Then $h$ and $g^{-1}hg$ are both in $H = G_{x_0}$, so that $h \cdot x_0 = x_0$, and 
$(g^{-1}h g) \cdot x_0 = x_0$,
that is
$$
\left\{
\begin{array}{lll}
h \cdot x_0 &= &x_0,\\
h \cdot (g\cdot x_0) &= & (g\cdot x_0).
\end{array}
\right.
$$
Since $g \not \in H = G_{x_0}$, $x_0 \ne g\cdot x_0$, thus $h$ fixes two distinct elements of $X$, and this shows that $h =e$. We have proved $H \cap gHg^{-1} = \{e\}$ for all $g\not \in H$.

\bigskip

$(\Leftarrow)$ Conversely, assume that $G$ has a subgroup $H$ such that $1<|H|<|G|$ and $H\cap gHg^{-1}=\{e\}$ for all $g \notin H$.

Take $X$ as the set of left cosets $hH, \ h\in G$ relative to $H$, and consider the action of $G$ on $X$ defined for all $h \in G$ by
$$g \cdot hH = (gh)H.$$
\be
\item[$\bullet$] This action is transitive: if $kH$ and $lH$ are left cosets, then $(lk)^{-1}\cdot kH = lH$.

\item[$\bullet$] Since $1 < |H| < |G|$, then $1 < |G|/|H| < |G|$, thus $1<|X| < |G|$.

\item[$\bullet$] Assume that $g$ fixes two distinct left cosets $hH \ne kH$:
\begin{align*}
g\cdot hH &= hH,\\
g\cdot kH &= k H.
\end{align*}
Then $l = h^{-1} g h \in H, m = k^{-1} g k \in H$, therefore $m = k^{-1}g k = k^{-1} h l h^{-1} k \in H$, so that
$$l \in H,\qquad(h^{-1}k)^{-1} l (h^{-1}k) \in H.$$
This proves $l \in H \cap gHg^{-1}$, where $g = h^{-1}k\not \in H$ (since $hH \ne k H$), and the hypothesis $H\cap gHg^{-1}=\{e\}$ gives $l = e$, and $g = hlh^{-1} =e$. The identity is the only element of $G$ fixing $hH$ and $kH$.
\ee
Therefore $G$ is a Frobenius group.
\end{proof}

\paragraph{Ex. 14.1.5}

{\it Let $F$ be a subfield of the real numbers, and let $f\in F[x]$ be irreducible of prime degree $p>2$. Assume that $f$ is solvable by radicals. Prove that $f$ has either a single real root or $p$ real roots. 
}

\begin{proof}
Since $\deg(f) = p$ is odd, $f$ has at least a real root. Suppose that $f$ has two distinct real roots $\alpha, \beta$.  By Theorem 14.1.1, since $f$ is solvable by radicals, the splitting field of $f$ over $F$ is $F(\alpha, \beta) \subset \R$. In this case all roots of $f$ are real, and these roots are distinct, since the characteristic of $F$ is $0$, thus the irreducible polynomial $f$ is separable.

We have proved that $f$ has either a single real root or $p$ real roots. 

\end{proof}

\paragraph{Ex. 14.1.6}

{\it By Example 8.5.5, $f=x^5-6x+3$ is not solvable by radicals over $\mathbb{Q}$. Give a new proof of this fact using the previous exercise together with the irreducibility of f and part (b) of Exercise 6 from Section 6.4.
}

\begin{proof}
The given polynomial $f$ has prime degree 5 and only three real roots, according to part (b) of Exercise 6.4.6. Since $f$ has more than one but less than 5 real roots, it is not solvable by radicals by Exercise 14.1.5. 

\end{proof}

\paragraph{Ex. 14.1.7}

{\it Use Lemma 14.1.3 and part (a) of Lemma 14.1.2 to give a proof of part (b) of Lemma 14.1.2 that doesn't use the Sylow Theorems.
}

\begin{proof}
Assume that $\tau\in S_p$ satisfies $\tau\theta\tau^{-1}\in \mathrm{AGL}(1,\mathbb{F}_p)$. Then, since $\langle\theta\rangle$ is a group of order $p$, $\langle\tau\theta\tau^{-1}\rangle=\tau\langle\theta\rangle\tau^{-1}$ is a subgroup of $\mathrm{AGL}(1,\mathbb{F}_p)$ of order $p$ and each element of this subgroup has order $p$ (or $1$).

By part (a) of Lemma 14.1.2, $\mathrm{AGL}(1,\mathbb{F}_p)$ is the normalizer of $\langle\theta\rangle$ in $S_p$, therefore $\langle\theta\rangle$ is normal in $\mathrm{AGL}(1,\mathbb{F}_p)$, with $[\mathrm{AGL}(1,\mathbb{F}_p):\langle\theta\rangle]=p-1$. The order of each element of $\tau\langle\theta\rangle\tau^{-1}$ is relatively prime to $p-1$, then, by Lemma 14.1.3, $\tau\langle\theta\rangle\tau^{-1}\subset\langle\theta\rangle$, therefore $\tau\langle\theta\rangle\tau^{-1}=\langle\theta\rangle$, since both groups have the same order $p$.  

Thus $\tau$ normalizes $\langle\theta\rangle$, hence $\tau\in \mathrm{AGL}(1,\mathbb{F}_p)$.
\end{proof}
\paragraph{Ex. 14.1.8}

{\it Let $f\in F[x]$ be irreducible of prime degree $p\geq 5$, where $F$ has characteristic 0, and let $\alpha\ne\beta$ be roots of f in some splitting field. If $F(\alpha,\beta)$ contains all other roots of $f$, then $f$ is solvable by radicals by Theorem 14.1.1. But suppose that there is some third root $\gamma$ such that $\gamma\in F(\alpha,\beta)$. Is this enough to force $f$ to be solvable by radicals?
\begin{enumerate}
\item[(a)] Use the classification of transitive subgroups of $S_5$ from Section 13.2 to show that the answer is ``yes'' when p=5.
\item[(b)] Use the polynomial $x^7-154\,x+99$ from Example 13.3.10 to show that the answer is ``no'' when p=7.
\end{enumerate}
}
\begin{proof}
\begin{enumerate}
\item[(a)]   
By hypothesis, $\deg(f) = p = 5$, and $\alpha \ne \beta$ are roots of $f$ in some splitting field.

Since $\alpha$ is a root of $f$, which is irreducible over $F$,
$$[F(\alpha) : F] = \deg(f) = p = 5.$$
Then $\beta$ is a root of $\frac{f(x)}{x-\alpha} \in F(\alpha)[x]$, so that the minimal polynomial of $\beta$ over $F(\alpha)$ has degree $d\leq p-1$. Thus
$$[F(\alpha,\beta) : F(\alpha] \leq p-1 = 4.$$
By the Tower Theorem,
$$[F(\alpha,\beta):F]  =   [F(\alpha,\beta):F(\alpha)] \ [F(\alpha):F] \leq p(p-1) = 20.$$
Now, suppose that there is some third root $\gamma$ such that $\gamma\in F(\alpha,\beta)$. Then $F(\alpha,\beta,\gamma) = F(\alpha,\beta)$. Let $\delta, \varepsilon$ be the remaining roots of $f$. Since the characteristic is $0$, the irreducible polynomial $f$ is separable.Then $\delta$ is a root of $\frac{f(x)}{(x-\alpha)(x-\beta)(x-\gamma)} \in F(\alpha,\beta,\gamma)[x]$, so that
$$[F(\alpha,\beta,\gamma,\delta):F(\alpha,\beta,\gamma)] \leq 2.$$
Since $F(\alpha,\beta,\gamma) = F(\alpha,\beta)$, the tower theorem gives
$$[F(\alpha,\beta,\gamma, \delta):F] \leq 40.$$
Moreover $\alpha + \beta +\gamma + \delta + \varepsilon = \sigma_1(\alpha,\beta,\gamma, \delta,\varepsilon) \in F$, thus $F(\alpha,\beta,\gamma, \delta,\varepsilon) = F(\alpha,\beta,\gamma, \delta)$. Write $L = F(\alpha,\beta,\gamma, \delta,\varepsilon)$ the splitting field of $f$ over $F$. We have proved
$$[L:F]\leq 40.$$
The classification of transitive subgroups of $S_5$ from Section 13.2 shows that any transitive subgroup of $S_5$ with cardinality $\le 40$ is a subgroup of $\mathrm{AGL}(1,\F_5)$, thus is solvable. So $\Gal(L/F)$ is a solvable group, where $F$ has characteristic $0$, therefore $f$ is solvable (Theorem 8.5.3).

To conclude, the answer is ``yes''  when $p = \deg(f) = 5$.
\item[(b)] To prove that the answer is ``no''  when $p = \deg(f) = 7$, we use the counterexample $f = x^7-154\, x+99$ from Example 13.3.10.

The polynomial $f$ is not solvable, since its Galois group is $\mathrm{GL}(3,\F_2)$, which is simple (Section 14.3) and not commutative, thus non solvable.

We prove that there are roots $\alpha,\beta, \gamma$ of $f$ such that $\gamma \in F(\alpha,\beta)$.

As in Example 13.3.10, consider the resolvant
$$\Theta_f(y) = \prod_{1\leq i < j < k \leq 7} \left(y - (\alpha_i + \alpha_j + \alpha_k)\right) \in \Q[y].$$
Then the factorization of $\Theta_f(y)$ over $\Q$ is 
$$\Theta_f(y) = g(y) h(y),$$
where the polynomials $g,h$, given in Example 13.3.10, are irreducible factors of degrees $7$ and $28$.

Take three roots $\alpha,\beta,\gamma$ of $f$ such that $y-(\alpha+\beta+ \gamma)$ is any linear factor of $g$, so that the minimal polynomial of $\alpha+\beta+ \gamma$ is $g$, with $\deg(g) = 7$, thus
$$[\Q(\alpha+\beta+\gamma) : \Q] = 7.$$
Now we prove that $\gamma \in F(\alpha,\beta)$. Consider the chain of extensions
$$\Q\subset \Q(\alpha) \subset \Q(\alpha,\beta) \subset \Q(\alpha,\beta,\gamma) \subset L,$$
where $L$ is the splitting field of $f$ over $\Q$.

The minimal polynomial of $\alpha$ over $\Q$ is $f$, thus $[\Q(\alpha) : \Q] = 7$, and 
$$[L:\Q] = |\Gal(L/\Q)| = |\mathrm{GL}(3,\F_2)| = 168 = 2^3 \times 3 \times 7.$$
By the Tower Theorem,
$$[L : \Q(\alpha)] = \frac{ [L : \Q]}{[ \Q(\alpha) : \Q]} = 2^3 \times 3$$
is not divisible by 7.

Since $\gamma$ is a root of $f$, the minimal polynomial of $\gamma$ over $f$ divides $f$. Thus
$$[\Q(\alpha,\beta,\gamma) : \Q(\alpha,\beta)] = 1\text{ or } 7.$$
If $[\Q(\alpha,\beta,\gamma) : \Q(\alpha,\beta)]  = 7$, by the Tower Theorem, $7$ divides $[L : \Q(\alpha)] = 2^3\times 3$. This contradiction proves that 
$$[\Q(\alpha,\beta,\gamma) : \Q(\alpha,\beta)] = 1,$$
therefore $\gamma \in \Q(\alpha,\beta).$

In this example, there exist roots $\alpha \ne \beta$ of $f$, and some third root $\gamma$ such that $\gamma \in F(\alpha,\beta)$, but $f$ is not solvable.

This shows that the answer is ``no'' when $p =\deg(f) = 7$.
\end{enumerate}

\end{proof}
\qquad

Note: In the proof of the Proposition 13.3.9, we saw that $G_f$ must be conjugate to $\mathrm{GL}(3,\F_2)$. This means that there is some numbering of the roots
$$
\left\{
\begin{array}{ccc}
\F_2^3\setminus\{(0,0,0\} & \to &\{\alpha \in L \, |\, f(\alpha) = 0\}\\
(\nu_1,\nu_2,\nu_3) &\to &\alpha_{\nu_1,\nu_2,\nu_3}
\end{array}
\right.
$$
which verify that, for all $\sigma \in\Gal(L/F)$, there is some $g \in \mathrm{GL}(3,\F_2)$ such that
$$\sigma(\alpha_{\nu_1,\nu_2,\nu_3}) = \alpha_{g \cdot (\nu_1,\nu_2,\nu_3)}.$$

In this correspondance, the roots of $f$ are seen as nonzero vectors in $\F_2^3$, and the seven roots of $g$ correspond to the seven (unordered)  triples of  linearly dependent  nonzero vectors in $\F_2^3$. So the roots $\alpha,\beta, \gamma$ where chosen in the preceding proof such that the corresponding vectors $u,v,w$ verify $w= u+v$ (but not $\gamma = \alpha + \beta$) .

This is what we understand in the hint of D.A. Cox ``Regard the roots as the nonzero vectors of $\F_2^3$ and pick roots $\alpha,\beta, \gamma$ such that $\gamma = \alpha+\beta$''.

This last equality is not true in $L$, but true for the corresponding vectors in $\F_2^3$.

Moreover, let $\alpha\ne \beta$ be {\it any} pair of roots. The corresponding vectors $u,v$ are such that $u,v,u+v = -u-v$ is not a base, so that the root $\gamma$ corresponding to $u+v$ is such that $ y - (\alpha+\beta+\gamma)$ is a factor of $g$, and the preceding proof shows that $\gamma \in \Q(\alpha,\beta)$. For each pair $\alpha\ne \beta$ of roots of $f = x^7-154\, x+99$, there exists a third root $\gamma \not \in \{\alpha,\beta\}$ such that $\gamma \in F(\alpha,\beta)$.







\subsection{IMPRIMITIVE POLYNOMIALS OF PRIME-SQUARED DEGREE}
\paragraph{Ex. 14.2.1}

{\it Prove (14.7).
}

\begin{proof}
Given $\sigma'=(\tau';\mu_1',...,\mu_k'),\sigma=(\tau;\mu_1,...,\mu_k)\in A\wr B$. Since $\sigma'$ maps $R_i$ to $R_{\tau'(i)}$ via $\mu_i'$, if we set $j=\tau'(i)$, then $\sigma$ maps $R_j$ to $R_{\tau(j)}=R_{\tau(\tau'(i))}=R_{\tau\tau'(i)}$ via $\mu_j=\mu_{\tau'(i)}$.

Hence $\sigma\sigma'$ maps $R_i$ to $R_{\tau\tau'(i)}$ via $\mu_{\tau'(i)}\mu_i'$.

More explicitly, by the definition of $(\tau; \mu_1,\ldots,\mu_k)$, for all $(i,j) \in \{1,\ldots,k\} \times \{1,\ldots,l\}$,
$$(\tau;\mu_1,\ldots,\mu_k)(i,j) = (\tau(i), \mu_i(j)).$$
Applying three times this definition, we obtain
\begin{align*}
(\tau; \mu_1,\ldots,\mu_k)(\tau'; \mu'_1,\ldots,\mu'_k)&= (\tau; \mu_1,\ldots,\mu_k)(\tau'(i),\mu'_i(j))\\
&= (\tau( \tau'(i)), \mu_{\tau'(i)}(\mu'_i(j))\\
&= ((\tau \tau')(i), (\mu_{\tau'(i)} \mu'_i)(j)\\
&=(\tau\tau';\mu_{\tau'(1)}\mu_1',...,\mu_{\tau'(k)}\mu_k')(i,j)
\end{align*}
Since this equality is true for all $(i,j) \in \{1,\ldots,k\} \times \{1,\ldots,l\}$,
$$(\tau;\mu_1,...,\mu_k)(\tau';\mu_1',...,\mu_k')=(\tau\tau';\mu_{\tau'(1)}\mu_1',...,\mu_{\tau'(k)}\mu_k').$$
\end{proof}

\paragraph{Ex. 14.2.2}
{\it The wreath product $S_3 \wr S_2 \subset S_6$ can be thought of as the subgroup of all permutations that preserve the blocs $R_1 = \{1,2\}, R_2 = \{3,4\},R_3 = \{5,6\}$. As noted in Example 14.2.11, $S_3 \wr S_2$ has order $6\cdot3^3 = 48$.
\be
\item[(a)] Show that $(S_3 \wr S_2) \cap A_6$ has order $24$.
\item[(b)] Show that $S_3 \wr S_2$ is the centralizer of $(1\,2)(3\,4)(5\,6)$ in $S_6$ (meaning that $S_3 \wr S_2$ consists of all permutations in $S_6$ that commute with $(1\,2)(3\,4)(5\,6)$).
\item[(c)] Use part (b) to show that $S_3 \wr S_2$ is isomorphic to $((S_3 \wr S_2) \cap A_6) \times S_2$.
\ee
See the next exercise for more on $S_3 \wr S_2$ and $(S_3 \wr S_2) \cap A_6$.
}
\begin{proof}
\item[(a)] Let $\varphi$ the restriction of the sign $\mathrm{sgn}$ to $(S_3 \wr S_2) \cap A_6$:
$$
\varphi \left\{
\begin{array}{ccc}
S_3 \wr S_2 & \to & \{-1,1\}\\
\sigma & \mapsto & \mathrm{sgn}(\sigma)
\end{array}
\right.
$$
Since $\mathrm{sgn}$ is a morphism, its restriction $\varphi$ is also a morphism, and $\varphi$ is surjective (onto), because $\varphi(e) = 1$, and $\varphi((1\,2)) = -1$, where $(1\,2) \in S_3\wr S_2$. Moreover the kernel of $\varphi$ is $\ker(\varphi) =  (S_3 \wr S_2) \cap A_6$.

Therefore $\mathrm{im}(\varphi) =  \{-1,1\} \simeq (S_3 \wr S_2)/ ((S_3 \wr S_2) \cap A_6)$. This shows that $$|(S_3 \wr S_2) \cap A_6| = \frac{1}{2} |S_3 \wr S_2| = 24.$$

\item[(b)] Let $\tau \in S_n$. Then $\tau$ is in the centralizer of $\sigma = (1\,2)(3\,4)(5\,6)$ if and only if
$$\tau (1\,2)(3\,4)(5\,6) \tau^{-1} = (1\,2)(3\,4)(5\,6),$$
which is equivalent to
$$(\tau(1)\, \tau(2))(\tau(3)\, \tau(4))(\tau(5)\, \tau(6)) = (1\,2)(3\,4)(5\,6).$$
Write $R_1 = \{1,2\}, R_2 = \{3,4\},R_3 = \{4,5\}$. Then $R_1, R_2,R_3$ are the three orbits  of $\sigma$ acting on $\{1,\ldots,6\}$, the supports of the decomposition of $\sigma$ in disjoint cycles.

Since $\tau$ is a bijection, the 6 values $\tau(1),\tau(2),\tau(3), \tau(4),\tau(5), \tau(6)$ are distinct, so $(\tau(1)\, \tau(2)),(\tau(3)\, \tau(4)),(\tau(5)\, \tau(6))$ are disjoint $2$-cycles. 

If $\tau$ is the centralizer of $\sigma$, the equality $(\tau(1)\, \tau(2))(\tau(3)\, \tau(4))(\tau(5)\, \tau(6)) = (1\,2)(3\,4)(5\,6)$ shows that $\tau(R_1),\tau(R_2),\tau(R_3)$ are also the three orbits of $\sigma$, so that
$$\{\{1,2\},\{3,4\},\{5,6\}\} =\{\{ \tau(1), \tau(2)\},\{\tau(3), \tau(4)\},\{\tau(5), \tau(6)\}\},$$
that is
$$\{R_1,R_2,R_3\} = \{\tau(R_1),\tau(R_2),\tau(R_3)\},$$
which means that there is some permutation $\tau'$ of $\{1,2,3\}$ such that $\tau(R_i) = R_{\tau'(i)}, \ i=1,2,3$. In other words, $\sigma$ preserves the blocks $R_1,R_2,R_3$, so that $\sigma \in S_3 \wr S_2$.

To prove the converse, it is more convenient to use the other usual representation of $S_3\wr S_2$. Then $\sigma = (e; \mu,\mu,\mu)$, where $\mu = (1\, 2) \in S_2$. Let $\tau = (\lambda; \mu_1,\mu_2,\mu_3)$ be any element of $S_3 \wr S_2$ (then $\mu_i = ()$ or $\mu_i = \mu)$. Then (14.7) gives
\begin{align*}
\tau \sigma &= (\lambda; \mu_1,\mu_2,\mu_3)(e; \mu,\mu,\mu)\\
&=(\lambda;\mu_1\mu, \mu_2 \mu,\mu_3\mu)\\
\sigma \tau &= (e;\mu,\mu;\mu)(\lambda,\mu_2,\mu_2,\mu_3)\\
&= (\lambda; \mu \mu_1, \mu \mu_2,\mu \mu_3)
\end{align*}
Since $S_2 = \{e,\mu\}$ is commutative, $\mu \mu_i = \mu_i \mu,\ i=1,2,3$, thus $\tau \sigma = \sigma \tau$.

The centralizer of $(1\,2)(3\,4)(5\,6)$ in $S_n$ is $S_3 \wr S_2$.

\item[(c)] Since the order of $\sigma = (1\,2)(3\,4)(5\,6)$ is $2$, $\langle \sigma \rangle = \{e,\sigma\} \simeq S_2$ and we can write $\sigma^{\varepsilon }, \varepsilon \in \{0,1\}$ the two elements of $\langle \sigma \rangle$.
Let
$$
\varphi
\left \{
\begin{array}{ccc}
(S_3 \wr S_2) \cap A_6 \times \langle \sigma \rangle & \to & S_3\wr S_2\\
(\tau, \sigma^{\varepsilon}) & \mapsto &\tau \sigma^{\varepsilon}.
\end{array}
\right.
$$
$\bullet$ $\varphi$ is a morphism: For all $\tau, \tau' \in (S_3 \wr S_2) \cap A_6$ and $\sigma^{\varepsilon}, \sigma^{\varepsilon'} \in \langle \sigma \rangle $, $\sigma \tau' = \tau' \sigma$ by part (b), thus
\begin{align*}
\varphi(\tau \sigma^{\varepsilon}) \varphi(\tau' \sigma^{\varepsilon'})&= \tau \sigma^{\varepsilon} \tau' \sigma^{\varepsilon'}\\
&= \tau \tau' \sigma^\varepsilon \sigma^{\varepsilon'}\\
&= \varphi((\tau,\sigma^\varepsilon) (\tau', \sigma^{\varepsilon'}))
\end{align*}

$\bullet$ $\ker \varphi$ is trivial: if $\varphi(\tau, \sigma^{\varepsilon}) = e$, then $\tau \sigma^{\varepsilon} = e$, so that $\tau  = \sigma^{-\varepsilon} \in \{e, \sigma\}$. $\tau = \sigma$ is impossible, since $\tau$ is an even permutation, and $\sigma$ is odd. Therefore $\tau = e$, and $\sigma^{\varepsilon} = e$. Thus $\varphi$ is injective (one to one).

$\bullet$ Since $|((S_3 \wr S_2) \cap A_6) \times \langle \sigma \rangle | = |S_3\wr S_2|$, $\varphi$ is a bijection, thus $\varphi$ is a group isomorphism.

$$S_3 \wr S_2 \simeq ((S_3 \wr S_2) \cap A_6) \times \langle \sigma \rangle  \simeq  ((S_3 \wr S_2) \cap A_6) \times S_2 .$$
\end{proof}

\paragraph{Ex. 14.2.3}
{\it One of the challenges of group theory is that the same group can have radically differnet descriptions. For instance, $S_4$ and the group $G = (S_3 \wr S_2) \cap A_6$ appearing in Example 14.2.11 both have order $24$. In this exercise, you will prove that they are isomorphic. We will use the notation of Exercise 2.
\be
\item[(a)] There is a natural homomorphism $G \to S_3$ given by how elements of $G$ permute the blocks $R_1,R_2,R_3$. Show that this map is onto, and express the elements of the kernel as products of disjoints cycles.
\item[(b)] Use the Sylow Theorems to show that $G$ has one or four $3$-Sylow subgroups.
\item[(c)] Show that $A_6$ has no element of order $6$.
\item[(d)] Use part (c) and the kernel of the map $G \to S_3$ from part (a) to show that $G$ has four $3$-Sylow subgroups.
\item[(e)] $G$ acts by conjugation on its four $3$-Sylow subgroups. Use this to prove that $G \simeq S_4$.
\item[(f)] Using Exercise 2, conclude that $S_3 \wr S_2 \simeq S_4 \times S_2$.

We note without proof that $S_3 \wr S_2 \simeq S_4 \times S_2$ is also isomorphic to the full symmetry group (rotations and reflexions) of the octahedron.
\ee
}

\begin{proof}
\item[(a)] Let $\varphi : G \to S_3$ defined by $\tau = \varphi(\sigma)$ iff $\sigma(R_i) = R_{\tau(i)}$. In other notations, this is the restriction to $G$ of the homomorphism of part (b) of Lemma 14.2.8, thus $\varphi$ is an homomorphism.

$\bullet$ $\varphi$ is surjective: Let $\tau$ be any permutation in $S_3$. 

If $\tau$ is even, $\tau = (1\,2\,3)^k,\ k = 0,1,2$. Let
$$\sigma =
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
3 & 4 & & 5 & 6 & & 1& 2\\
\end{array}
\right)
= (1\,3\,5)(2\,4\,6).
$$
$\sigma$ preserves the block structure defined by $R_1,R_2,R_3$, and $\sigma \in A_6$, so that $\sigma \in G = (S_3 \wr S_2) \cap A_6$. Moreover $\sigma(R_1) = R_2, \sigma(R_2) = R_3, \sigma(R_3) = R_1$, thus $\varphi(\sigma) = (1\,2\,3)$, and $\varphi(\sigma^k )= (1\,2\,3)^k = \tau$.

If $\tau$ is odd, then $\tau \in \{(1\,2),(2\,3),(1\,3)\}$, and
\begin{align*}
(1\,2) = \varphi(\sigma_1), \qquad \sigma_1 = 
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
3 & 4 & & 1 & 2 & & 5& 6\\
\end{array}
\right) = (1\,3)(2\,4) \in G,\\
(2\,3) = \varphi(\sigma_2), \qquad \sigma_2 = 
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
1 & 2 & & 5 & 6 & & 3& 4\\
\end{array}
\right) = (3\,5)(4\,6) \in G,\\
(1\,3) = \varphi(\sigma_3), \qquad \sigma_3 = 
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
5 & 6 & & 3 & 4 & & 1& 2\\
\end{array}
\right) = (1\,5)(2\,6) \in G.\\
\end{align*}
Therefore $\varphi$ is surjective.

$\bullet$ Let $\sigma \in S_6$. Then $\sigma \in \ker \varphi$ iff $\sigma \in A_6$ and $\sigma(R_1) = R_1, \sigma(R_2) = R_2, \sigma(R_3) = R_3$.

Morerover, for all $\sigma \in A_6$,
\begin{align*}
&\sigma(R_1) = R_1, \sigma(R_2) = R_2, \sigma(R_3) = R_3\\
\iff& \{\sigma(1), \sigma(2)\} = \{1,2\}, \{\sigma(3),\sigma(4)\} = \{3,4\}, \{\sigma(5),\sigma(6)\} = \{5,6\}\\
\iff &\sigma \in \{e,(1\,2)(3\,4), (1\,2)(5\,6), (3\,4)(5\,6)\}.
\end{align*}
$$\ker \varphi = \{e,(1\,2)(3\,4), (1\,2)(5\,6), (3\,4)(5\,6)\}.$$
Verification: $6 = |S_3| = |G/\ker(\varphi)| = 24/4$.

\item[(b)] Let $N$ be the number of $3$-Sylow subgroups of $G$. By the third Slow Theorem,
$$N \mid 24 = |G|, \qquad N \equiv 1 \pmod 3.$$
Therefore $N = 1$ or $N = 4$.

\item[(c)] Let $\tau \in S_6$ be a permutation of order 6. If $\tau = \tau_1\cdots \tau_k$ is the decomposition of $\tau$ in disjoint cycles, then the order of $\tau$ is the lcm of the order of$ \tau_1,\ldots,\tau_k$. Therefore $\tau$ is a $6$-cycle or a product of a $2$-cycle by a $3$-cycle. In both cases $\tau$ is odd. Therefore $A_6$ has no element of order $6$.


\item[(d)] Reasoning by contradiction, suppose that $G$ has only one $3$-Sylow subgroup $H$. Then, for all $g \in G$, $gH g^{-1}$ is a $3$-Sylow, thus $gH g^{-1} = H$, and $H$ is a normal subgroup of $G$. 

Moreover $K = \ker \varphi = \{e,(1\,2)(3\,4), (1\,2)(5\,6), (3\,4)(5\,6)\}$ is normal in $G$, and has order 4. Therefore $H \cap K = \{e\}$.

The usual characterization of direct products (see Ex. 14.3.7) shows that, for all $h \in H$, all $k \in K$, $hk = kh$, and $HK$ is a normal subgroup of $G$ isomorphic to $H \times K$. 

Take $h$ an element of order $3$ in $H,$ and $k$ and element of order 2 in $K$. Since $kh = hk$, the order of $hk \in A_6$ is 6, which is impossible by part (c).

Therefore $G$ has exactly four $3$-Sylow subgroups.

\item[(e)] Write $X = \{H_1,H_2,H_3,H_4\}$ the set of $3$-Sylow subgroups of $G$, and $S(X)$ the set of permutations of $X$. Then $S(X) \simeq S_4$, and $g\cdot H = g H g^{-1}$ defines a left action of $G$ on $X$, so that
$$
\psi 
\left\{
\begin{array}{ccc}
G & \to & S(X)\\
g & \mapsto & 
\sigma = \left(
    \begin{array}{cccc}
      H_1&H_2&H_3&H_4\\
      gH_1g^{-1} & gH_2 g^{-1} & gH_3g^{-1} & gH_4g^{-1}
    \end{array}
\right)
\end{array}
\right.
$$
is a group homomorphism.

It is not obvious that $\psi$ is bijective. We prove first that $\psi$ is surjective (onto). We give explicitly the $3$-Sylow subgroups. Let
\begin{align*}
&\lambda_1 = 
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 3&4&&5&6&&1&2 \\
\end{array}
\right) = (1\,3\,5)(2\,4\,6),\\
&\lambda_2 = 
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 3&4&&6&5&&2&1 \\
\end{array}
\right) = (1\,3\,6)(4\,5\,2),\\
&\lambda_3 = 
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 6&5&&2&1&&3&4 \\
\end{array}
\right) = (1\,6\,4)(5\,3\,2),\\
&\lambda_4 =
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 4&3&&6&5&&1&2 \\
\end{array}
\right) = (1\,4\,5)(3\,6\,2).
\end{align*}
Then $\lambda_1,\ldots,\lambda_4 \in G$ have order $3$, and $H_1 = \langle \lambda_1 \rangle = \{e,\lambda_1,\lambda_1^2\},\ldots,H_4 = \langle \lambda_1 \rangle = \{e,\lambda_4,\lambda_4^2\}$ are distinct, thus they are the four $3$-Sylow of $G$.

Now take 
\begin{align*}
&g = 
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 4&3&&2&1&&5&6 \\
\end{array}
\right) = (1\,4)(2\,3)\\
&h=
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 2&1&&5&6&&4&3 \\
\end{array}
\right) = (1\,2)(3\,5\,4\,6)
\end{align*}
(We give a geometrical explanation of this choice in the final note.)

Then 
\begin{align*}
g \lambda_1 g^{-1} &= (1\,4)(2\,3)(1\,3\,5)(2\,4\,6)(1\,4)(2\,3)\\
&=
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 6&5&&1&2&&4&3 \\
\end{array}
\right) = (1\,6\,3)(2\,5\,4) = \lambda_2^2,
\end{align*}
thus $gH_1g^{-1} = H_2$, and since $g = g^{-1}$, $g H_2 g^{-1} = H_1$.
Moreover
\begin{align*}
g \lambda_3g^{-1} &=(1\,4)(2\,3)(1\,6\,4)(5\,3\,2)(1\,4)(2\,3)\\
&= 
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 4&3&&5&6&&2&1 \\
  \end{array}
  \right)
 =(1\,4\,6)(2\,3\,5)
 =\lambda_3^2,
\end{align*}
thus $gH_3g^{-1} = H_3$, and since $\psi(g)$ is a permutation, $gH_4 g^{-1} = H_4$.

Therefore $\psi(g) \in S(X)$ is the permutation 
$ 
\left(
\begin{array}{cccc}
H_1&H_2&H_3&H_4\\
H_2&H_1&H_3&H_4
\end{array}
\right)
$, which corresponds to the transposition $(1\,2) \in S_4$.
Similarly,
\begin{align*}
h\lambda_1h^{-1}&= (1\,2)(3\,5\,4\,6)(1\,3\,5)(2\,4\,6)(3\,6\,4\,5)(1\,2)\\
&=
\left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 6&5&&1&2&&4&3 \\
  \end{array}
  \right) =(1\,6\,3)(2\,5\,4) = \lambda_2^2,\\
 h\lambda_2h^{-1} &= (1\,2)(3\,5\,4\,6)(1\,3\,6)(4\,5\,2)(3\,6\,4\,5)(1\,2)\\
 &=
 \left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 6&5&&2&1&&3&4 \\
  \end{array}
  \right) = (1\,6\,4)(2\,5\,3) = \lambda_3,\\
   h\lambda_3h^{-1} &= (1\,2)(3\,5\,4\,6)(1\,6\,4)(5\,3\,2)(3\,6\,4\,5)(1\,2)\\
 &=
 \left(
\begin{array}{cccccccc}
1 & 2 & & 3 & 4 & & 5 & 6\\
 4&3&&6&5&&1&2 \\
  \end{array}
  \right) = (1\,4\,5)(2\,3\,6) = \lambda_4,
\end{align*}
thus $hH_1h^{-1} = H_2, hH_2h^{-1} = H_3, hH_1h^{-1} = H_4$, and since $\psi(g)$ is a permutation, $h H_4h^{-1} = H_1$. Therefore 
$\psi(g) = \left(
\begin{array}{cccc}
H_1&H_2&H_3&H_4\\
H_2&H_3&H_4&H_1
\end{array}
\right)
$
corresponds to the $4$-cycle $(1\,2 \,3 \,4)$. 

Since $\{(1\,2), (1\,2\,3\,4)\}$ is a set of generators of $S_4$, $S(X)$ is generated by $\psi(g), \psi(h)$, so that $S(X) = \psi(G)$, and $\psi$ is surjective. Moreover, $|G| = |S(X)| = 24$, thus $\psi$ is a bijection, and a group isomorphism:
$$G \simeq S(X) \simeq S_4.$$

\item[(f)] To conclude, using Exercise 2, we obtain
$$S_3\wr S_2 \simeq ((S_3 \wr S_2) \cap A_6) \times S_2  = G \times S_2 \simeq S_4 \times S_2.$$
\bigskip

Note: We have proved in Exercise 7.5.10 that the symmetry group $G_0$ of the cube (or octahedron), is isomorphic to $S_4$. By composition with the indirect isometry $\sigma : v\mapsto -v$, which commutes with all elements in the group, we obtain the full symmetry group, isomorphic to $S_4 \times S_2$.

We have a geometrical description of $G = (S_3\wr S_2) \cap A_6$ by regrouping the opposite faces of a cube in blocs: stick $1$ on a face of a dice, $2$ on the opposite face, and so on (I stuck labels on my Rubik's cube). Then the $24$ rotations of the cube send opposite faces on opposite faces, so that the bloc structure $\{\{1,2\},\{3,4\},\{5,6\}\}$ is preserved by rotations.

We have proved in Exercise 7.5.10 that $G_0$ acts on the 4 long diagonals $D_1,D_2,D_3,D_4$ of the cube, so that $G_0 \simeq S_4$. Each of the four $3$-Sylow of $G_0$ is generated by the rotation with angle $\frac{2\pi}{3}$ around such a  long diagonal. They correspond to the $3$-Sylow $H_1,\ldots,H_4$ of $G$: this was useful for the above description of the $H_i$. Each $3$-Sylow corresponds to a long diagonal, so that $gH_ig^{-1} = H_j$ is equivalent to $\sigma(D_i) = D_j$, where $\sigma$ corresponds to $g$. It remains to find a rotation which acts on these diagonals as some given permutation in $S_4$, such that $(1\,2)$ or $(1\,2\,3\,4)$. The corresponding permutations $g,h \in G $ are given in the text.

\end{proof}

\paragraph{Ex. 14.2.4}
{ \it
Let $A$ and $B$ be solvable permutation groups. Prove that their wreath product $A\wr B$ is also solvable.
}

\medskip

We first proof a lemma, which is not given in Chapter 8.

\medskip

{\bf Lemma.} {\it If $G,H$ are solvable groups, then $G \times H$ is solvable.}

\medskip

{\it Proof of Lemma.} We have subgroups 
\begin{align*}
&\{e\} \subset G_n \subset \cdots \subset G_1 \subset G_0 = G\\
&\{e'\} \subset H_m \subset \cdots \subset H_1 \subset H_0 = H
\end{align*}
such that $G_i$ is normal in $G_{i-1}$ and $G_{i-1}/G_i$ is Abelian for $i=1,\ldots,n$, and $H_i$ is normal in $H_{i-1}$ and $H_{i-1}/H_i$ is Abelian for $i=1,\ldots,m$.

If $n >m$, we can define $H_{m+1} = H_{m+2} =\cdots=H_n=\{e'\}$,  and proceed similarly if $n<m$, so we can assume that $n=m$: 
\begin{align*}
&\{e\} \subset G_n \subset \cdots \subset G_1 \subset G_0 = G\\
&\{e'\} \subset H_n \subset \cdots \subset H_1 \subset H_0 = H
\end{align*}
Then
$$
\{(e,e')\} =G_n\times H_n \subset \cdots \subset G_1\times H_1 \subset G_0\times H_0 = G \times H.
$$
We prove 
$$(G_{i-1}\times H_{i-1}) / (G_i \times H_i) \simeq G_{i-1}/G_i \times H_{i-1}/H_i.$$
Indeed, 
$$
\psi
\left\{
\begin{array}{ccc}
G_{i-1} \times H_{i-1} & \to  & G_{i-1}/G_i \times H_{i-1}/H_i\\
(g,h) & \mapsto & (gG_i, hH_i)
\end{array}
\right.
$$
is surjective, and its kernel is $G_i \times H_i$. This proves our assertion.

Therefore $(G_{i-1}\times H_{i-1}) / (G_i \times H_i)$ is Abelian. Then Exercise 8.1.8 shows that $G\times H $ is solvable.
\qed
\begin{proof} {\it (of Ex.14.2.4.)}
Let 
$$
\varphi
\left\{
\begin{array}{ccc}
A \wr B & \to & A\\
(\tau; \mu_1,\ldots,\mu_k) & \mapsto &\tau.
\end{array}
\right.
$$
By Lemma 14.2.8, $\varphi$ is onto, and its kernel $H = \ker(\varphi)$ is isomorphic to $B^k$. Then $B^k$ is solvable by induction with the above Lemma, so that $H$ is solvable, and $(A \wr B) / H  = (A \wr B)/\ker(\varphi) \simeq A$ is solvable. By Theorem 8.1.4, $A\wr B$ is solvable.
\end{proof}

\paragraph{Ex. 14.2.5}
{\it This exercise will complete the proof of Theorem 14.2.15.
\be
\item[(a)] Let $G_i \to S_p$ be the map defined in (14.9). Prove that it is a group homomorphism and that its image $G'_i \subset S_p$ is transitive and solvable.
\item[(b)] Let $\sigma = (\tau; \mu_1,\ldots,\mu_p)$ and $(\rho;\nu_1,\ldots,\nu_p)$ be as in the proof of Theorem 14.2.15. Thus we have a fixed $j$ such that $i=\tau(j), \nu_i = \theta$, and $\rho(i) = i$. Now let $\gamma = (\tau^{-1} \rho \tau; \lambda_1,\ldots,\lambda_p)$ be as in (14.11). Prove carefully that $\lambda_j = \mu_j^{-1} \theta \mu_j$.
\ee
}

\begin{proof}
\item[(a)] The map $\varphi_i$ defined in  (14.9) is
$$
\varphi_i 
\left\{
\begin{array}{ccc}
G_i & \to &S_p\\
(\tau; \mu_1,\ldots,\mu_p) & \mapsto &\mu_i.
\end{array}
\right.
$$
Let $\lambda = (\tau; \mu_1,\ldots,\mu_p),\lambda' =  (\tau'; \mu_1,\ldots,\mu_p)$ be elements of $G_i$. The definition of $G_i$ shows that $\lambda(R_i) = \lambda'(R_i) = R_i$, so that $\tau(i) =\tau'(i)=i$.  

By (14.7) (see Exercise 1),
$$\lambda \lambda' =(\tau;\mu_1,...,\mu_k)(\tau';\mu_1',...,\mu_k')=(\tau\tau';\mu_{\tau'(1)}\mu_1',...,\mu_{\tau'(k)}\mu_k'),$$ 
therefore, using $\tau'(i) = i$,
\begin{align*}
\varphi_i( \lambda \lambda') &= \mu_{\tau'(i)} \mu'_i\\
&=\mu_i \mu'_i\\
&= \varphi_i(\lambda) \varphi_i(\lambda'),
\end{align*}
thus $\varphi_i$ is a group homomorphism.

\bigskip

Write $G'_i = \varphi_i(G_i) \subset S_p$. We prove first that $G'_i$ is transitive.

Take any $k$ and $l$ in $\{1,\ldots,p\}$. Since $G$ is transitive, there exists some $\lambda = (\tau;\mu_1,...,\mu_k) \in G$ which sends $(i,j)$ on $(i,k)$:
$$(\tau;\mu_1,\ldots,\mu_k)(i,j) = (\tau(i), \mu_i(j)) = (i,k).$$
Then $\tau(i) = i$, so that $\lambda \in G_i$ and $\mu_i = \varphi_i(\lambda) \in G'_i$. Moreover $\mu_i(j) = k$. This proves that $G'_i$ is a transitive subgroup of $S_p$.

Moreover, $G_i$ is a subgroup of the solvable group $G$, thus $G_i$ is solvable. Then $G'_i = \varphi_i(G_i)$ is isomorphic to $G_i/\ker(\varphi_i)$, which is a quotient of a solvable group, thus $G'_i$ is solvable.
\item[(b)] As in the proof of Theorem 14.2.15, let $\sigma = (\tau; \mu_1,\ldots,\mu_p) \in G$ be arbitrary, and fix $j$ between $1$ and $p$. By (14.10) with  $i = \tau(j)$, $\theta \in G'_i = \varphi_i(G_i)$, thus there exists $\lambda = (\rho; \nu_1,\ldots,\nu_p) \in G_i$ such that $\theta = \varphi_i(\lambda)$, thus $\theta = \nu_i$ and $\rho(i) = i$.

Now consider the element $\gamma = \sigma^{-1} \lambda \sigma \in G$. Using (14.6) and (14.7), we obtain
\begin{align*}
\gamma &=  (\tau; \mu_1,\ldots,\mu_p)^{-1} (\rho; \nu_1,\ldots,\nu_p)(\tau; \mu_1,\ldots,\mu_p)\\
&=(\tau^{-1};\mu^{-1}_{\tau^{-1}(1)},\ldots,\mu^{-1}_{\tau^{-1}(p) })(\rho \tau; \nu_{\tau(1)}\mu_1,\ldots,\nu_{\tau(p)} \mu_p)\\
&=(\tau^{-1};\xi_1,\ldots,\xi_p)(\rho \tau; \nu_{\tau(1)}\mu_1,\ldots,\nu_{\tau(p)} \mu_p)\qquad (\text{where }\xi_1 =\mu^{-1}_{\tau^{-1}(1)},\ldots, \xi_p =\mu^{-1}_{\tau^{-1}(p)}) \\
&= (\tau^{-1} \rho \tau; \xi_{(\rho \tau)(1)}\nu_{\tau(1)}\mu_1,\ldots,\xi_{(\rho \tau)(p)}\nu_{\tau(p)}\mu_p)\\
&= (\tau^{-1} \rho \tau; \mu^{-1}_{\tau^{-1}((\rho \tau)(1))}\nu_{\tau(1)}\mu_1,\ldots,\mu^{-1}_{\tau^{-1}((\rho \tau)(p))}\nu_{\tau(p)}\mu_p)\\
&=(\tau^{-1} \rho \tau; \mu^{-1}_{(\tau^{-1}\rho \tau)(1)}\nu_{\tau(1)}\mu_1,\ldots,\mu^{-1}_{(\tau^{-1}\rho \tau)(p)}\nu_{\tau(p)}\mu_p)\\
\end{align*}
If we write $\gamma = (\tau^{-1} \rho \tau; \lambda_1,\ldots,\lambda_p)$, we obtain
$$\lambda_k = \mu^{-1}_{(\tau^{-1}\rho \tau)(k)}\nu_{\tau(k)}\mu_k,\qquad k = 1,\ldots,p,$$
and at the index $j$, using $\theta = \nu_i = \nu_{\tau(j)}$,
\begin{align*}
\lambda_j &= \mu^{-1}_{(\tau^{-1}\rho \tau)(j)}\nu_{\tau(j)}\mu_j\\
&=\mu^{-1}_{(\tau^{-1}\rho \tau)(j)}\theta\mu_j.\\
\end{align*}
Since $i = \tau(j)$ and $\rho(i) = i$, 
$$(\tau^{-1} \rho\tau)(j) = (\tau^{-1} \rho)(i) = \tau^{-1} (i) = j,$$
thus
$$\lambda_j = \mu_j^{-1} \theta \mu_j.$$
\end{proof}



\paragraph{Ex. 14.2.6}
{\it Let $A$ be a subgroup of $S_n$, and let $G$ be any group. Then define $A \wr G$ as in the Mathematical Notes.
\be
\item[(a)] Prove that $A \wr G$ is a group under the multiplication defined in the Mathematical Notes.
\item[(b)] State and prove a version of part (b) of Lemma 14.2.8 for $A \wr G$.
\item[(c)] Prove that $|A \wr G | = |A| |G|^n$ when $G$ is finite.
\ee
}

\begin{proof}
\be
\item[(a)]
Let $G$ be any group and let $A \subset S_n$ be a permutation group. Then set
$$A \wr G = \{ (\tau; g_1,\ldots,g_n)\, | \, \tau \in A,\  g_1,\ldots,g_n \in G\},$$
with an operation on this set defined by
$$(\tau; g_1,\ldots,g_n)(\tau'; g'_1,\ldots,g'_n) = (\tau \tau'; g_{\tau'(1)}g'_1,\ldots,g_{\tau'(n)} g'_n) \in A \wr G.$$
We write $e$ the identity of $G$, and $()$ the identity of $S_n$.

\be
\item[$\bullet$] Let $\lambda = (\tau; g_1,\ldots,g_n), \lambda' = (\tau';g'_1,\ldots,g'_n), \lambda''=(\tau'';g''_1,\ldots,g''_n)$ be elements of $A \wr G$. Then
\begin{align*}
\lambda(\lambda'\lambda'' )&=  (\tau; g_1,\ldots,g_n)(\tau' \tau''; g_{\tau''(1)}g''_1,\ldots,g_{\tau''(n)} g''_n) \\
&= (\tau\tau'\tau''; g_{(\tau'\tau'')(1)} g'_{\tau''(1)} g''_1,\ldots,g_{(\tau'\tau'')(n)} g'_{\tau''(n)} g''_n)\\
(\lambda \lambda')\lambda'' &= (\tau \tau'; g_{\tau'(1)}g'_1,\ldots,g_{\tau'(n)} g'_n)(\tau'';g''_1,\ldots,g''_n)\\
&=(\tau\tau';h_1,\ldots,h_n)(\tau'';g''_1,\ldots,g''_n)\qquad (\text{where } h_k = g_{\tau'(k)}g'_k)\\
&=(\tau\tau'\tau''; h_{\tau''(1)} g''_1,\ldots,h_{\tau''(n)} g''_n)\\
&=(\tau\tau'\tau''; g_{\tau'(\tau''(1))}g'_{\tau''(1)}g''_1,\cdots,g_{\tau'(\tau''(n))}g'_{\tau''(n)}g''_n)\\
&=(\tau\tau'\tau''; g_{(\tau'\tau'')(1)} g'_{\tau''(1)} g''_1,\ldots,g_{(\tau'\tau'')(n)} g'_{\tau''(n)} g''_n)
\end{align*}
thus $\lambda(\lambda'\lambda'' ) = (\lambda \lambda')\lambda'' $, and the law is associative.

\item[$\bullet$] Write $\varepsilon = (();e,\ldots,e) = (\iota; e_1,\ldots, e_n)$, where $\iota = ()$, and $e_k = e, k=1,\ldots,n$. Then
\begin{align*}
\varepsilon \lambda &= (\iota;e_1,\ldots,e_n)(\tau; g_1,\ldots,g_n)\\
&=(\tau; e_{\tau'(1)}g_1,\ldots,e_{\tau'(n)} g_n)\\
&= (\tau; g_1,\ldots,g_n) = \lambda\qquad (\text{since } e_{\tau'(k)} = e)\\
\lambda \varepsilon &= (\tau; g_{\iota(1)} e_1,\ldots,g_{\iota(n)} e_n)\\
&= (\tau; g_1,\ldots,g_n) = \lambda \qquad(\text{since } \iota(k) = k, e_k = e).
\end{align*}
Therefore $\varepsilon =(();e,\ldots,e) $ is the identity of $A \wr G$.

\item[$\bullet$] Set $\mu = (\tau^{-1}; h_1,\ldots,h_n) = (\tau^{-1}; g_{\tau^{-1}(1)}^{-1}, \ldots,g_{\tau^{-1}(n)}^{-1})$, with $h_k = g_{\tau^{-1}(k)}^{-1},\ k=1,\ldots,n$. Then
\begin{align*}
\lambda \mu &= (\tau; g_1,\ldots,g_n)(\tau^{-1}; h_1,\ldots,h_n)\\
&=((); g_{\tau^{-1}(1)} h_1,\ldots,g_{\tau^{-1}(n)} h_n)\\
&=((); g_{\tau^{-1}(1)} g_{\tau^{-1}(1)}^{-1}, \ldots,g_{\tau^{-1}(n)} g_{\tau^{-1}(n)}^{-1})\\
&=((); e,\ldots,e) =\varepsilon\\
\mu \lambda &= (\tau^{-1}; h_1,\ldots,h_n)(\tau; g_1,\ldots,g_n)\\
&=((); h_{\tau(1)} g_1,\ldots,h_{\tau(n)} g_n\\
&=((); g_{\tau^{-1}(\tau(1))}^{-1} g_1,\ldots,g_{\tau^{-1}(\tau(n))}^{-1} g_n)\\
&=((); g_1^{-1}g_1,\ldots, g_n^{-1}g_n) = (();e,\ldots,e) = \varepsilon.
\end{align*}
Therefore every element in $A \wr G$ is invertible.

$A \wr G$ is a group under the multiplication defined in the Mathematical Notes.
\ee
\item[(b)] For the group $A \wr G$ of part (a), where $A \subset S_n$ and $G$ is a group, we show the following lemma:

{\bf Lemma.}
{\it The map
$$
\varphi 
\left\{
\begin{array}{ccc}
A \wr G & \to A\\
(\tau; g_1,\ldots,g_n) & \mapsto \tau
\end{array}
\right.
$$
is a group homomorphism that is surjective and whose kernel is isomorphic to $G^n$.
}

\bigskip

Let $\lambda = (\tau; g_1,\ldots,g_n) , \lambda' = (\tau'; g'_1,\ldots,g'_n)$ be any elements of $A \wr G$. By definition,
$\lambda \lambda' = (\tau \tau'; g_{\tau'(1)}g'_1,\ldots,g_{\tau'(n)} g'_n),$
so that
$$\varphi(\lambda \lambda') = \tau \tau' = \varphi(\lambda) \varphi(\lambda').$$
$\varphi$ is a group homormphism.

If $\tau$ is any element of $A$, then $\varphi(\tau; e,\ldots,e) = \tau$, where $(\tau; e,\ldots,e) \in A \wr G$. Therefore $\varphi$ is surjective.

Moreover $(\tau; g_1,\ldots,g_n) \in \ker \varphi$ if and only if $\tau = ()$, therefore
$$\ker \varphi = \{\iota; g_1,\ldots, g_n)\, |\, (g_1,\ldots,g_n) \in G^n\}, \qquad \text{where } \iota = ().$$

Consider
$$
\psi
\left\{
\begin{array}{ccc}
\ker \varphi & \to & G^n\\
(\iota; g_1,\ldots,g_n) & \mapsto &(g_1,\ldots, g_n)
\end{array}
\right.
$$
Then $\psi$ is bijective (with inverse map $(g_1,\ldots,g_n) \mapsto (\iota,g_1,\ldots,g_n)$). We verify that $\psi$ is a group homomorphism: if $\lambda = (\iota; g_1,\ldots,g_n) , \lambda' = (\iota; g'_1,\ldots,g'_n)$ are elements of $\ker \varphi$, then
\begin{align*}
\psi (\lambda \lambda') &= \psi((\iota; g_1,\ldots,g_n)(\iota; g'_1,\ldots,g'_n))\\
&=\psi(\iota; g_{\iota(1)} g'_1,\ldots, g_{\iota(n)} g'_n)\\
&=\psi(\iota; g_1 g'_1,\ldots, g_n g'_n)\qquad (\text{since } \iota(k) = k)\\
&=(g_1 g'_1,\ldots, g_n g'_n)\\
&=(g_1\ldots,g_n)(g'_1,\ldots,g'_n)\\
&= \psi(\lambda) \psi(\lambda').
\end{align*}
So $\psi$ is an group isomorphism, and $\ker \varphi \simeq G^n$.

\item[(c)] By part (b), since $\varphi$ is a surjective homomorphism,
$$
(A\wr G )/ \ker \varphi \simeq A,
$$
and $\ker \varphi \simeq G^n$. Therefore
$$
|A| = |A \wr G| / |\ker \varphi| = |A\wr G|/ |G|^n,
$$
which proves
$$|A \wr G| = |A| |G|^n.$$
\ee
\end{proof}

\paragraph{Ex. 14.2.7}
{\it Let $A \wr G$ be as in Exercise 6, and let $H$ be the set of all functions
$$\phi:\{1,\ldots,n\} \to G.$$
\be
\item[(a)] Given $\phi,\chi \in H$, define $\phi \chi \in H$ by $(\phi \chi)(i) = \phi(i)\chi(i)$. Prove that this makes $H$ into a group isomorphic to the product group $G^n$.
\item[(b)] Elements of $A \wr G$ can be written $(\tau,\phi)$, where $\phi \in H$. Prove that in this notation, (14.7) becomes
$$(\tau,\phi)(\tau',\phi') = (\tau \tau',((\tau')^{-1} \cdot \varphi) \phi').$$
\item[(c)] $A \subset S_n$ acts on $\{1,\ldots,n\}$. Show that this induces an action of $A$ on $H$ via $(\tau\cdot \phi)(i) = \phi(\tau^{-1}(i))$. Be sure you understand why the inverse is necessary.
\item[(d)] The action of part (c) enable us to define the semidirect product $H \rtimes A$. Using the description of $A \wr G$ given in part (b), prove that the map
$$(\tau, \phi) \mapsto (\tau \cdot \phi, \tau)$$
defines a group isomorphism $A \wr G \simeq H \rtimes A$. This shows that wreath products can be represented as semidirect products.

\ee
}
\begin{proof}
\be
\item[(a)] Consider the two maps
$$
\varphi
\left\{
\begin{array}{ccc}
H & \to &G^n\\
\phi & \mapsto &(\phi(1),\ldots,\phi(n)),
\end{array}
\right.
\qquad
\psi
\left\{
\begin{array}{ccc}
G^n & \to &H\\
(x_1,\ldots,x_n)& \mapsto &
\xi
\left\{
   \begin{array}{ccc}
   \{1,\ldots,n\} & \to & G\\
   i& \mapsto & x_i.
   \end{array}
   \right.
\end{array}
\right.
$$
Then $\psi \circ \varphi = 1_H$ and $\varphi \circ \psi = 1_{G^n}$, therefore $\varphi$ is bijective.

Moreover, for all $(\phi,\chi) \in H$,
\begin{align*}
\varphi(\phi \chi) &= ((\phi\chi)(1),\ldots, (\phi \chi)(n))\\
&=(\phi(1) \chi(1), \ldots, \phi(n) \chi(n))\\
&= (\phi(1),\ldots,\phi(n)) (\chi(1),\ldots,\chi(n))\\
&= \varphi(\phi) \varphi(\chi)).
\end{align*}
Therefore $H \simeq G^n$ via $\varphi$.

\item[(b,c)] If we define $\phi^\tau$, for $\tau \in S_n$ and $\phi \in H$, by $(\phi^\tau)(i) = \phi(\tau(i)),\ i=1,\ldots,n$, we obtain a right action: if $\tau, \tau' \in S_n$, for all $i\in\{1,\ldots,n\}$,
$$((\phi^{\tau})^{\tau'})(i) =  (\phi^\tau)(\tau'(i)) = \phi(\tau(\tau'(i))) = \phi((\tau \tau')(i)) = \phi^{\tau \tau'}(i)),$$
thus $(\phi^{\tau})^{\tau'} = \phi^{\tau \tau'}$. To obtain a left action, we must define, as in part (c),
$$(\tau\cdot \phi)(i) = \phi(\tau^{-1}(i)),\ i=1,\ldots,n.$$
Then
$$(\tau' \cdot (\tau\cdot \phi))(i) = (\tau\cdot \phi)(\tau'^{-1}(i)) = \phi(\tau^{-1}(\tau'^{-1}(i))) = \phi(\tau'\tau)^{-1}(i) = ((\tau' \tau)\cdot \phi)(i),$$
so that $\tau' \cdot (\tau\cdot \phi) = (\tau' \tau)\cdot \phi)$ (and $e \cdot \tau = \tau$).

This is a proof of part (c), and this explains the recurrent and stressful injonction from D.A.Cox ``{\bf Be sure you understand} why the inverse is necessary''.

Using this action for part (b), we define $(\tau, \phi)$ for $\tau \in S_n, \phi \in H = G^{\{1,\cdots,n\}}$,by
$$(\tau, \phi) = (\tau; \phi(1),\ldots,\phi(n)),$$
so that
$$(\tau, \phi) = (\tau; g_1,\ldots,g_n) \iff  \phi(1) = g_1,\ldots,\phi(n) = g_n.$$
If $(\tau, \phi) = (\tau; g_1,\ldots,g_n), (\tau', \phi') = (\tau; g'_1,\ldots,g'_n)$, then
\begin{align*}
(\tau, \phi) (\tau', \phi') &= (\tau; g_1,\ldots,g_n)(\tau; g'_1,\ldots,g'_n)\\
&=(\tau \tau'; g_{\tau'(1)}g'_1,\ldots,g_{\tau'(n)} g'_n) \\
&=(\tau \tau'; \phi(\tau'(1))\phi'(1),\ldots,\phi(\tau'(n)) \phi'(n)\\
&=(\tau \tau'; ((\tau')^{-1}\cdot\phi)(1)\phi'(1),\ldots,((\tau')^{-1}\cdot\phi)(n))\phi'(n)\\
&= (\tau \tau', ((\tau')^{-1}\cdot\phi)\phi').
\end{align*}

\item[(d)] Consider the map
$$
\varphi
\left\{
\begin{array}{ccc}
A \wr G & \to & H \rtimes A\\
(\tau,\phi) & \mapsto & (\tau\cdot \phi, \tau).
\end{array}
\right.
$$
If $\psi : H \rtimes A \to A \wr G$ is defined by $\psi(\chi, \tau) = (\tau, \tau^{-1} \cdot \chi)$, then, for all $\tau \in S_n, \phi,\chi \in H$,
\begin{align*}
(\psi \circ \varphi)(\tau, \phi) &= \psi(\tau\cdot \phi, \tau) = (\tau, \tau^{-1}\cdot (\tau \cdot \phi) = (\tau, \phi),\\
(\varphi \circ \psi)(\chi, \tau) &= \varphi(\tau, \tau^{-1} \cdot \chi) = (\tau \cdot (\tau^{-1} \cdot \chi), \tau) = (\chi, \tau). 
\end{align*}
Thus $\psi \circ \varphi = 1_{A \wr G},\  \varphi \circ \psi = 1_{H \rtimes A}$. This proves that $\varphi$ is bijective.

Recall that the binary operation in $ H \rtimes A$ is defined by (6.9):
$$(\phi,\tau) (\phi',\tau') = (\phi(\tau\cdot \phi'), \tau \tau').
$$
We verify that $\varphi$ is a group homomorphism. Note first that, for $\tau \in S_n, \phi \chi \in H$, 
$$\tau \cdot (\phi \chi) = (\tau \cdot \phi)(\tau \cdot \chi).$$
Indeed, for all $i \in \{1,\ldots,n\}$,
\begin{align*}(\tau \cdot (\phi \chi))(i) &= (\phi\chi)(\tau^{-1}(i))\\
&=\phi(\tau^{-1}(i)) \chi(\tau^{-1}(i))\\
&=(\tau \cdot \phi)(i) (\tau \cdot \chi)(i)\\
&=((\tau \cdot \phi)(\tau \cdot \chi))(i).
\end{align*}
Using this rule, we obtain
\begin{align*}
\varphi((\tau,\phi) (\tau',\phi')) &= \varphi(\tau \tau'; ((\tau')^{-1}\cdot\phi)\phi')\\
&= ((\tau\tau')\cdot((\tau')^{-1}\cdot\phi)\phi'),\tau \tau')\\
&=  ((\tau\tau')\cdot((\tau')^{-1}\cdot\phi) ((\tau\tau')\cdot\phi'), \tau \tau')\\
&=((\tau \cdot\phi) ((\tau\tau' )\cdot \phi'), \tau \tau'),\\
\end{align*}
and using the binary operation in $H\rtimes A$,
\begin{align*}
\varphi(\tau, \phi) \varphi(\tau',\phi') &=(\tau\cdot \phi, \tau)((\tau'\cdot \phi', \tau')\\
&= ((\tau \cdot \phi) (\tau \cdot (\tau' \cdot \phi')), \tau \tau')\\
&=((\tau \cdot\phi) ((\tau\tau' )\cdot \phi'), \tau \tau'),
\end{align*}
thus $\varphi((\tau,\phi) (\tau',\phi')) = \varphi(\tau, \phi) \varphi(\tau',\phi') $.
We have proved that $\varphi$ is a group isomorphism, so
$$A \wr G \simeq H \rtimes A = G^{\{1,\ldots,n\} }\rtimes A.$$ 
Wreath products can be represented by semidirect products.
\ee
\end{proof}

\paragraph{Ex. 14.2.8}
{\it
The goal of this exercise is to relate Definition 14.2.2 to Galois's definition of not primitive. Let $f \in F[x]$ be monic, separable, and irreducible with splitting field $F \subset L$. Also assume that $f$ is imprimitive with blocks of roots given by $R_1,\ldots,R_m$, where each block has $n$ elements (thus $\deg(f) = mn$). Let $f_i$ be the monic polynomial whose roots are the elements of $R_i$, and let $K \subset L$ be the fixed field of $$\{\sigma \in \Gal(L/F)\, | \, \sigma(R_i) = R_i \text{ for all } i\}.$$
\be
\item[(a)] Show that $f = \prod_{i=1}^m f_i$ and that $f_i \in K[x]$ for all $i$.
\item[(b)] In Galois' definition, $K$ is obtained by adjoining the roots of a separable polynomial of degree $m$. In modern terms, Galois wants $F \subset K$ to be Galois extension such that $\Gal(K/F)$ (*) is isomorphic to a subgroup of $S_m$. Prove that the field $K$ defined in part (a) has these properties.
See Exercise 14 for some examples.

[(*) misprint in Cox.]
\ee
}

\begin{proof}
\be
\item[(a)] By Definition 14.2.2, $R = R_1 \cup \cdots \cup R_m$ (disjoint union) is the set of roots of $f$. Since $f$ is separable, by definition of $f_i$,
$$f = \prod_{\alpha \in R} (x - \alpha) = \prod_{i=1}^m \prod_{\alpha \in R_i} (x - \alpha) = \prod_{i=1}^m f_i.$$
Let 
$$G = \{\sigma \in \Gal(L/F)\, | \, \forall i \in \gcro 1, m \dcro, \ \sigma(R_i) = R_i \}.$$
If $G_i = \{\sigma \in \Gal(L/F)\, | \, \sigma(R_i) = R_i \}$ for $i = 1,\ldots,n$, then $G = \bigcap\limits_{i=1}^m G_i$.

Each $G_i$ is a subgroup of $\Gal(L/F)$: $e(R_i) = R_i$, and if $\sigma, \tau \in R_i$, then  $(\sigma \tau)(R_i) = \sigma(R_i) = R_i$ and $R_i = \sigma^{-1}(R_i)$. Therefore $G = \bigcap\limits_{i=1}^m G_i$ is a subgroup of $\Gal(L/F)$.

Let $K = L_G$ be the fixed field of $G$. By the Galois correspondence, $G = \Gal(L/K)$.

If $\sigma \in G_i$, since $\sigma(R_i) = R_i$, where le restriction of $\sigma$ to $R_i$ is bijective, then 
$$\sigma \cdot f_i = \prod_{\alpha \in R_i} (x - \sigma(\alpha)) = \prod_{\beta \in R_i} (x - \beta) = f_i, \qquad (\beta = \sigma(\alpha)).$$
Therefore, if $\sigma \in G = \bigcap\limits_{i=1}^m G_i$, then for all $i \in \{1,\ldots,m\}$, $\sigma\cdot f_i = f_i$. The coefficients of $f_i$ are in the fixed field $K$ of $G$, so that
$$f_i\in K[x],\ i=1,\ldots,m.$$
To give a first example, $f = x^4 - 2$ is imprimitive with blocks $$R_1 =\{\sqrt[4]{2},-\sqrt[4]{2}\},R_2 = \{i \sqrt[4]{2},-i\sqrt[4]{2}\}.$$

If $\tau,\sigma$ are defined by $\tau(\sqrt[4]{2}) = \sqrt[4]{2}, \tau(i) = -i$, and $\sigma(\sqrt[4]{2}) = i \sqrt[4]{2}, \sigma(i) = i$, then
$$\Gal(L/F) = \{e,\sigma,\sigma^2,\sigma^3, \tau, \sigma \tau, \sigma^2 \tau, \sigma^3\tau\} \simeq D_8.$$
Here $G = G_1 = G_2 = \{e,\sigma^2,\tau,\sigma^2 \tau\}$, and $K = L_G = \Q(\sqrt{2})$ (see Ex. 6.3.2 and Ex. 7.3.3).

We verify $f_1(x) = x^2 -\sqrt{2}, f_2(x) = x^2 + \sqrt{2} \in K[x]$.

\item[(b)] We prove that $G$ is a normal subgroup of $\Gal(L/F)$. 

Let $\lambda \in \Gal(L/F)$, and $\sigma \in G$. Since $f$ is imprimitive, $\lambda \in \Gal(L/F)$ permutes the blocks $R_i$: there exists $\tau \in S_m$ such that
$$\lambda(R_i) = R_{\tau(i)},\ i=1,\ldots,m.$$
Let $j$ be any fixed index in $\{1,\ldots,m\}$, and $i$ such that $\tau(i) = j$. Since $\sigma \in G \supset G_i$, $\sigma(R_i) = R_i$, thus
$$(\lambda \sigma \lambda^{-1})(R_j) = (\lambda \sigma)(R_i) = \lambda(R_i) = R_j.$$
Since this is true for all $j \in \{1,\ldots,m\}$, $\lambda \sigma \lambda^{-1} \in G$. This proves that $G$ is a normal subgroup of $\Gal(L/F)$. Therefore $F \subset K$ is a Galois extension (Theorem 7.2.5). 

Now we prove that $\Gal(K/F)$ is isomorphic to a subgroup of $S_m$.

Since $f$ is imprimitive with blocks of roots given by $R_1,\ldots,R_m$, for each $\sigma \in \Gal(L/F)$, there exists $\tau \in S_m$ such that $\sigma(R_i) = R_{\tau(i)},\ i=1,\ldots,m$.
Consider the map $\varphi$ sending $\sigma$ to $\tau$:
$$
\varphi
\left\{
\begin{array}{ccl}
\Gal(L/F) & \to & S_m\\
\sigma & \mapsto &\tau : \forall i \in \gcro 1,m \dcro,\ \sigma(R_i) = R_{\tau(i)}.
\end{array}
\right.
$$
Then , for all $\sigma \in \Gal(L/F)$,
$$\varphi(\sigma) = ()  \iff \forall i \in \gcro 1,m \dcro,\ \sigma(R_i) = R_i \iff \sigma \in G.$$
Therefore, $\ker(\varphi) = G$, and by the Galois correspondence (see part (a)) $G = \Gal(L/K)$, so that
$$\ker(\varphi) = G = \Gal(L/K).$$
Then, by Theorem 7.3.2, since $K$ is Galois over $F$,
$$ S_m \supset \mathrm{im}(\varphi) \simeq \Gal(L/F)/ \ker(\varphi) = \Gal(L/F)/\Gal(L/K) \simeq \Gal(K/F).$$
Therefore $\Gal(K/F)$ is isomorphic to the subgroup $\mathrm{im}(\varphi)$ of $S_m$.
\ee
\end{proof}

\paragraph{Ex.14.2.9}
Assume that $G \subset S_n$ is transitive and Abelian.
\be
\item[(a)] Prove that $|G| = n$ by considering the isotropy subgroups of $G$.
\item[(b)] Prove that $G$ is primitive if and only if $|G|$ is prime.
\ee
Thus a transitive Abelian permutation group is imprimitive unless it is cyclic of prime order.

\begin{proof}
\item[(a)] $G \subset S_n$ acts on $\{1,\ldots,n\}$ by the action defined by $\sigma\cdot k = \sigma(k),\ \sigma \in G, k \in \{1,\ldots,n\}$.

Consider the isotropy group $G_1$ of $1$: $G_1 = \{\sigma \in G\, |\, \sigma(1) = 1\}$. Let $\sigma$ be any permutation in $G_1$, and let $i$ be any element in $\{1,\ldots,n\}$. Since $G$ is transitive, there exists $\tau \in G$ such that $\tau(1) = i$. By hypothesis, $G$ is Abelian, therefore
$$\sigma(i) = (\sigma \tau)(1) = (\tau \sigma)(1) = \tau(1) = i.$$
Since this is true for all $i\in \{1,\ldots,n\}$, $\sigma = e$. This proves $G_1 = \{e\}$.

Moreover, since $G$ is transitive, the orbit of $1$ is $G\cdot 1 =\{1,\ldots,n\}$, thus $|G\cdot 1| = n$.

By the Fundamental Theorem of Group Actions,
$$|G\cdot 1 | = (G:G_1) = |G|,$$
thus $|G| = n$.
\item[(b)] By Lemma 14.2.7, if $G \subset S_n$ is transitive and imprimitive, then $n =kl,\ k>1,l>1$, is composite. Thus, if $n$ is prime, a transitive subgroup of $S_n$ is primitive.

Conversely, let $G$ be a transitive Abelian subgroup of $S_n$, where $n>1$ is composite. By part (a), $|G| = n$. We must prove that $G$ is imprimitive.

By the Kronecker's Theorem on the structure of Abelian groups, 
$$G \simeq C_{n_1} \times \cdots \times C_{n_r}$$
is a product of cyclic groups.

Therefore, either $G$ is cyclic of order $n$, or $G = HK \simeq H\times K, H\ne\{e\},K \ne \{e\}$ is a direct product of two non trivial subgroups (take for instance $H \simeq C_{n_1}, K \simeq C_{n_2} \times \cdots \times C_{n_r}$). We will deal with these two cases.

$\bullet$ Case 1.  We assume that $G \simeq C_n$ is cyclic, where $n = ml, \ m>1, l>1$. Then $G = \langle \sigma \rangle$, where the permutation $\sigma$ has order $n$. Take
\begin{align*}
R_1 &= \{1,\sigma^m(1),\ldots, \sigma^{(l-1)m}(1)\},\\
R_2 &= \{\sigma(1), \sigma^{m+1}(1), \ldots,\sigma^{(l-1)m + 1}(1)\} = \sigma(R_1),\\
\cdots\\
R_m&=\{\sigma^{m-1}(1),\sigma^{m + m-1}(1), \ldots,\sigma^{lm - 1}(1)\} = \sigma^{m-1}(R_1).
\end{align*}
Since $G$ is transitive, $$R_1\cup\cdots\cup R_m =\{1,\sigma(1),\ldots,\sigma^{n-1}(1)\} = G\cdot 1 = \{1,\ldots,n\}.$$ Moreover, if $\tau \in G$, then $\tau = \sigma^{j},\ j=0,\ldots,n-1$, thus, using $\sigma^n = e$, if $k$ is the remainder of $i+j-1$ modulo $n$,
$$\tau(R_i) = (\sigma^j \sigma^{i-1})(R_1) = \sigma^{i+j-1}(R_1) = \sigma^{k}(R_1) = R_{k+1}.$$

This proves that $G$ is imprimitive, with blocks $R_1,\ldots,R_m$.

\bigskip

$\bullet$ Case 2. Now, assume that $G = HK \simeq H \times K, |H| = l>1, |K| = m>1$. Then $n = ml$. Write
\begin{align*}
H &= \{\sigma_1 =e,\ldots,\sigma_l\},\\
K &= \{\tau_1 = e,\ldots,\tau_m\},
\end{align*}
and take
\begin{align*}
R_1 &=\{ (\sigma_1 \tau_1)(1), \ldots, (\sigma_l \tau_1)(1) \},\\
R_2 &=\{ (\sigma_1 \tau_2)(1),\ldots, (\sigma_l \tau_2)(1)\},\\
\cdots\\
R_m&= \{ (\sigma_1 \tau_m)(1), \ldots, (\sigma_l \tau_m)(1)\}.
\end{align*}
Since $G = HK$, every permutation $\lambda \in G$ is a product $\lambda = \sigma_i \tau_j,\ 1\leq i\leq l, 1 \leq j \leq m$, and since $G$ is transitive,
$$R_1 \cup \cdots \cup R_m = G\cdot 1 = \{1,\ldots,n\}.$$
Take $\lambda = \sigma_i \tau_j \in G$, and $R_k = \{\sigma_u \tau_k, 1\leq u \leq n\}$. Then $\tau_j \tau_k = \tau_r$ for some fixed $r \in \{1,\ldots,m\}$. Since $G$ is Abelian,
$$\lambda(R_k) = \{(\sigma_i \sigma_u \tau_j \tau_k)(1) , 1 \leq u \leq n\} = \{(\sigma_i \sigma_u \tau_r)(1) , 1 \leq u \leq n\} =  \{(\sigma_v \tau_r)(1) , 1 \leq v \leq n\} = R_r,$$
because the map $H \to H$, $\sigma_u \mapsto \sigma_i \sigma_u$ is bijective.

This proves that $G$ is imprimitive, with blocks $R_1,\ldots,R_m$. 

To conclude, $G$ is primitive if and only if $|G|$ is prime (or $|G| = 1$). Thus a non trivial transitive Abelian permutation group is imprimitive unless it is cyclic of prime order.

\bigskip

Examples: $G = \{(), (1\,2)(3\,4), (1\,3)(2\,4),(1\,4)(2\,3)\}$ is a transitive Abelian subgroup of $S_4$, and an example of Case 2. If $H, K$ are two distinct subgroups of $G$ with order 2, then $G = HK \simeq C_2 \times C_2$. We can take $R_1 = \{1,2\}, R_2 = \{3,4\}$, but we can also take $R'_1 = \{1,3\},R'_2 = \{2,4\}$. G is imprimitive with blocks $R_1,R_2$, or with blocks $R'_1,R'_2$.

$G' = \langle (1\,2\,3\,4) \rangle$ is a another transitive Abelian subgroup of $S_4$, and an example of Case 1. This times, we can take only $R_1 = \{1,3\},R_2 = \{2,4\}$.
\end{proof}

\paragraph{Ex.14.2.10} {\it Let $\Phi_p(x)$ be the cyclotomic polynomial whose roots are the primitive $p$th roots of unity, where $p$ is prime. We know that $\Phi_p(x)$ is irreducible of degree $p-1$. In the quotation given in the Historical Notes, Galois asserts that $\Phi_p(x)$ is imprimitive.
\be
\item[(a)]
Prove Galois's claim for $p>3$ using Exercise 9.
\item[(b)] Explain why we need to assume that $p>3$ in part (a).
\ee
}

\begin{proof}
\item[(a)]
We know that the splitting field of $\Phi_p(x)$ over $\Q$ is $L = \Q(\zeta_p)$ (where $\zeta_p = e^{\frac{2i\pi}{p}}$), and that $\Gal(L/\Q) \simeq (\Z/p\Z)^*$, via the isomorphism 
$$
\left\{
\begin{array}{ccl}
\Gal(L/\Q) & \to & (\Z/p\Z)^*\\
\sigma & \mapsto & a : \sigma(\zeta_p) = \zeta_p^a.
\end{array}
\right.
$$
Therefore, $\Gal(L/\Q)$ is Abelian, and even cyclic with order $p-1$. Let $\Gal(L/\Q) \simeq G  \subset S_{p-1}$. If $p>3$, then $p-1$ is not prime, and Exercise 9 prove that  $G_n$ is imprimitive, so that $\Phi_p(x)$ is imprimitive.

\item[(b)] If $p = 3$, $p-1 = 2$ is prime, and $(\Z/3\Z)^* = \{1 ,-1 \}$ is cyclic of prime order. Moreover $\Phi_3(x) = x^2+x + 1$ is not imprimitive, as every polynomial of degree 2: by Definition 14.2.2, if $f$ is imprimitive, since $k>1,l>1$, $\deg(f) \geq |R_1|+|R_2| >2$.

If $p = 2$, $(\Z/2\Z)^* = \{1\}$, and $\Phi_2(x) = x+1$. Since $\deg(\Phi_2) = 1$, $\Phi_2(x)$  is not imprimitive.
 
\end{proof}


\paragraph{Ex. 14.2.11}{\it
Given a prime $p$, let $C_p \subset S_p$ be the cyclic subgroup generated by the $p$-cycle $(1\,2\cdots p)$. As explained in the text, this gives the wreath product $C_p \wr C_p \subset S_{p^2}$. Prove that $C_p \wr C_p$ is a $p$-Sylow subgroup of $S_{p^2}$.
}
\begin{proof}
By Lemma 14.2.8, we know that $C_p \wr C_p$ is a subgroup of $S_p \wr S_p$, which may be viewed as $S_{p^2}$.

Exercise 6 shows that $|C_p \wr C_p| = |C_p| |C_p|^p = p^{p+1}$.

Moreover $|S_{p^2}| = (p^2)!$, and, if $\nu_p(n)$ is the exponent of $p$ in the prime factorization of $n!$, then
$$\nu_p(n!) =\left \lfloor \frac{n}{p} \right \rfloor +  \left \lfloor \frac{n}{p^2}\right  \rfloor + \cdots + \left \lfloor \frac{n}{p^k} \right \rfloor + \cdots.$$
(see for instance Ex. 2.6 in Ireland and Rosen)
 
Therefore\begin{align*}
\nu_p((p^2)!) &=\left \lfloor \frac{p^2}{p} \right \rfloor +  \left \lfloor \frac{p^2 }{p^2}\right  \rfloor + \cdots + \left \lfloor \frac{p^2}{p^k} \right \rfloor + \cdots\\
&=\left \lfloor \frac{p^2}{p} \right \rfloor +  \left \lfloor \frac{p^2 }{p^2}\right  \rfloor\\
&=p + 1.
\end{align*}
Therefore $p^{p+1}$ is the maximal power of $p$ which divides $(p^2)! = S_{p^2}$, so that $C_p \wr C_p$ is a $p$-Sylow subgroup of $S_{p^2}$.
\end{proof}


\paragraph{Ex. 14.2.12}{\it Let $f$ be an irreducible imprimitive polynomial of degree 6,8 or 9 over a field $F$ of characteristic 0. Prove that $f$ is solvable by radicals over $F$.
}

\begin{proof}
Write $L$ the splitting field of $f$. Since the characteristic of $F$ is 0, the irreducible polynomial $f$ is separable, so $f$ is separable, irreducible and imprimitive.  By Corollary 14.2.10, $G = \Gal(L/F)$ is isomorphic to a subgroup of $S_k \wr S_l$, where $n = kl$ is a nontrivial factorization. The only nontrivial factorizations of 6,8 or 9 are
$$6 = 2 \times 3 = 3 \times 2, \qquad 8 = 2 \times 4 = 4 \times 2, \qquad 9 = 3 \times 3.$$
Thus $G$ is isomorphic to a subgroup of the list
$$S_2 \wr S_3, S_3\wr S_2,S_4 \wr S_2,S_2 \wr S_4, S_3\wr S_3,$$
whose cardinalities are
\begin{align*}
|S_2 \wr S_3| &= 2!3^2 = 2 \times 3^2,\\
 |S_3\wr S_2| &= 3!2^3 = 2^4 \times 3,\\
 |S_4 \wr S_2| &= 4!2^4 = 2^7 \times 3,\\
 |S_2 \wr S_4| &= 2!4^2 = 2^5,\\
 |S_3\wr S_3| &=3!3^3 = 2 \times 3^4. 
\end{align*}
So $S_k \wr S_l$ has only two prime factors 2 and 3. By Burnside's Theorem (Theorem 8.1.8), $S_k \wr S_l$ solvable for these values of $k,l$, thus the subgroup $G$ is solvable. Since the characteristic of $F$ is 0, this proves that $f$ is solvable by radicals over $f$.
\end{proof}



\paragraph{Ex. 14.2.13}{\it Let $f = x^6 + bx^3 + c \in F[x]$ be irreducible, where $F$ has characteristic different from 2 or 3. We will study the size of the Galois group of $f$ over $F$.
\be
\item[(a)] Show that $f$ is separable. So we can think of the Galois group as a subgroup of $S_6$.
\item[(b)] Show that $x^6+bx^3 + c$ is imprimitive and that its Galois group lies in $S_2 \wr S_3$. Also show that $|S_2 \wr S_3| = 72$. Thus the Galois group has order $\leq 72$.
\item[(c)] Let $F \subset L $ be the splitting field of $f$ over $F$. Use the Tower Theorem to show that $[L:F] \leq 36$. Hence the Galois group has order at most $36$.
\ee
Using Maple or Sage, one can show that the Galois group of $x^6 + 2x^3 - 2$ over $\Q$ has order $36$ and hence is as large as possible.
}
\begin{proof}
\item[(a)] Since $F$ has characteristic different from 2 or 3, $f' = 6x^5 + 3bx^2 \ne 0$. By hypothesis, $f$ is irreducible, thus any factor of $f$ is associate to $f$ or $1$. Since $f' \ne 0$, $\gcd(f,f')$ divides $f'$, thus $\deg(\gcd(f,f')) \leq \deg(f') = 5$, and $\gcd(f,f')$ is a factor of $f$, which cannot be associate to $f$, therefore $\gcd(f,f') = 1$. This proves that $f$ is separable.
\item[(b)]  If $\alpha$ is a root of $f$ in $L$, then $ \lambda = \alpha^3 \in L $ is a root of $g = x^2 +bx+c$. Let $\mu = -b-\lambda \in L$. Then $\mu$ is a root of $g$: 
 $$\mu^2+b\mu+c = (-b-\lambda)^2 + b(-b-\lambda)+c = \lambda^2 + b\lambda + c = 0.$$
Moreover $\lambda \ne \mu$, otherwise $b = -2\lambda, c = -\lambda^2 - b\lambda = \lambda^2$, and $g = (x-\lambda)^2$, where $\lambda = -b/2 \in F$, so that  $f =g(x^3) = (x^3-\lambda)^2$ would not be irreducible over $f$. Therefore
$$g = (x- \lambda)(x-\mu),\qquad \lambda\ne \mu.$$
Write $K = F(\lambda,\mu)$. Then $F\subset K \subset L$ is an intermediate field which is a splitting field of $g$ over $F$.
If $\lambda \in F$, then $\mu \in F$ and $f = g(x^3) = (x^3 - \lambda)(x^3 - \mu)$ would not be irreducible over $F$. Therefore $\lambda \not \in F,\mu \not \in F$, $g$ is irreducible over $F$. $K$ is the splitting field of the separable polynomial $g$, thus $F \subset K$ is a Galois extension, where $F \subsetneq K \subset L$.

Moreover,
$$f = g(x^2) = (x^3 - \lambda)(x^3 - \mu) = f_1 f_2,$$
where $f_1 = x^3 - \lambda, f_2 = x^3 - \mu \in K[x]$.
Therefore three roots $\alpha,\alpha',\alpha''$ of $f$ are the roots of $x^3 -\lambda$, and three other roots $\beta,\beta',\beta''$ of $f$ are the roots of $x^3 - \mu$ :
$$\alpha^3 = \alpha'^3 = \alpha''^3 = \lambda,\qquad \beta^3 = \beta'^3 = \beta''^3 = \mu.$$
This gives the blocks
$$R_1 = \{\alpha, \alpha', \alpha''\},\qquad R_2 = \{\beta,\beta',\beta''\}.$$
If $\sigma \in \Gal(L/F)$, then $g = \sigma\cdot g = (x -\sigma(\lambda))(x - \sigma(\mu))$, thus $\{\lambda, \mu\} = \{\sigma(\lambda), \sigma(\mu)\}$: $\sigma$ fixes $\lambda, \mu$, or exchanges $\lambda, \mu$. Since $\alpha,\beta,\gamma$ are the roots of $x^3 - \lambda$, $\sigma(\alpha), \sigma(\beta), \sigma(\gamma)$ are the roots of $x^3 - \sigma(\lambda)$, thus $\sigma(R_1) = R_1$ or $\sigma(R_1) = R_2$, and similarly $\sigma(R_2) = R_1$ or $R_2$. This proves that $f$ is imprimitive, with blocks $R_1,R_2$, and $\Gal(L/F)$ is isomorphic to a subgroup of $S_2 \wr S_3$(Corollary 14.2.10), whose order is $2(3!)^2 = 72$ (see Ex. 6 (c)).

\item[(c)] We don't know if $F$ or $K$ contains the cubic roots of unity, but $L$ does: since $\alpha, \alpha'$ are two distinct roots of $x^3 - \lambda$ (where $\alpha \ne 0$, otherwise $\lambda = 0 \in F$), then $(\frac{\alpha'}{\alpha})^3 = 1$. If we write $\omega = \frac{\alpha'}{\alpha}$, then $\omega \in L$ and $\omega^3 = 1, \omega\ne 1$, thus $1,\omega, \omega^2$ are three distinct roots of $x^3 - 1$, and $1 + \omega + \omega^2 = 0$, so that $[K(\omega) : K ] = 1$ or $2$. 

Then the six roots of $f$ are 
$$\alpha_1 = \alpha, \alpha_2 = \omega \alpha, \alpha_3 = \omega^2 \alpha, \alpha_4 = \alpha', \alpha_5 = \omega \alpha', \alpha_6 = \omega^2 \alpha'.$$
Therefore
$$L = F(\alpha,\omega \alpha, \omega^2 \alpha, \beta, \omega \beta, \beta^2) = F(\omega,\alpha,\beta) = K(\omega, \alpha, \beta). $$

Consider the chain of fields
$$F \subset K = F(\lambda, \mu) \subset  K(\omega) \subset K(\omega,\alpha) \subset L = K(\omega, \alpha, \beta).$$

\begin{center}
\begin{tikzpicture}
    \node (L) at (4,8) {$L = K(\omega,\alpha,\beta)$};
    \node (A3) at (1,6) {$K(\omega,\alpha)$};
    \node (t23) at (7,6) {$K(\omega,\beta)$};
    \node (id) at (4,4) {$K(\omega)$};
    \node (K) at (4,2) {$K = F(\lambda,\mu)$};
    \node (F) at (4,0) {$F$};
    \draw[<-] (L) edge (A3)   edge (t23);
    \draw[->] (id) edge (A3)  edge (t23);
    \draw[->] (K) edge (id);
     \draw[->] (F) edge (K);
\end{tikzpicture}
\end{center}


$\bullet$ Since $\lambda,\mu$ are the roots of the irreducible polynomial $f$, $K=F(\lambda,\mu)$ is a quadratic extension of $F$, so $[K:F] = 2$.

$\bullet$ Since $\omega^2 + \omega + 1 = 0$, $[K(\omega) : K] \leq 2$.

$\bullet$ Since $\alpha^3 - \lambda = 0$, where $\lambda \in K \subset K(\omega)$, $[K(\omega,\alpha) : K(\omega)] \leq 3$.

$\bullet$ Since $\beta^3 - \mu = 0$, where $\mu \in K \subset K(\omega, \alpha)$,  $[K(\omega, \alpha,\beta) : K(\omega, \alpha)] \leq 3$.

By the Tower Theorem,
$$[L:K] = [K(\omega, \alpha,\beta) : K] = [K(\omega, \alpha,\beta) : K(\omega, \alpha)] [K(\omega,\alpha) : K(\omega)][K(\omega) : K]  \leq 3\times3 \times2 \times 2 = 36.$$
Therefore,
$$|\Gal(L/K) | = [L:K] \leq 36.$$
\end{proof}
Note : Some permutations of $S_2\wr S_3$ can't lie in the Galois group $G \subset S_6$ of $f$, for instance if the transposition $(4\,5)$ corresponds to $\sigma \in \Gal(L/F)$, given by
$$
\left(
\begin{array}{cccccc}
\alpha & \omega\alpha &\omega^2\alpha & \beta & \omega \beta & \omega^2 \beta\\
\alpha & \omega\alpha &\omega^2\alpha & \omega\beta &  \beta & \omega^2 \beta
\end{array}
\right),
$$
then $\sigma(\alpha) = \alpha$ and $\sigma(\omega \alpha) = \omega \alpha$ show that $\sigma(\omega) = \omega$, and $\sigma(\beta) = \omega \beta$ implies $\sigma(\omega \beta) = \omega^2 \beta \ne \beta$. This contradiction proves that $(4\,5) \not \in G$ (but $(4\, 5) \in S_3 \wr S_2 \subset S_6$). More generally, all odd permutations are impossible, so that $G$ is a subgroup of $(S_2\wr S_3) \cap A_6$.




\paragraph{Ex. 14.2.14} {\it Here are some examples to illustrate Galois's definition of imprimitive. We will use the notation of Exercise 8. Let $F$ be a field of characteristic different from 2 or 3.
\be
\item[(a)] Let $f = x^6 + bx^4+cx^2 +d \in F[x]$ be irreducible with splitting field $F \subset L$. Show that the splitting field of $x^3+bx^2+cx+d$ gives an intermediate field $F\subset K \subset L$ such that $F \subset K$ is Galois and $f=f_1f_2f_3$, where $f_i \in K[x]$ has degree 2 for $i=1,2,3$. Also explain how $K$ relates to the field $K$ constructed in Exercise 8.
\item[(b)] Work out the analogous theory when $f = x^6 + bx^3+c \in F[x]$ is irreducible.
\ee
}
\begin{proof}

\item[(a)] By hypothesis, $f = x^6 + bx^4+cx^2 +d$ is irreducible. Since the characteristic of $F$ is different from 2 or 3, $f' = 6x^5+\cdots \ne 0$, thus $\gcd(f,f') =1$, and $f$ is separable.

If $\alpha$ is a root of $f$, then $-\alpha$ is a root of $f$. Moreover $\alpha \ne 0$, otherwise $d= 0$ and $f$ would not be irreducible, therefore $\alpha \ne -\alpha$. Since $f$ is separable, the roots of $f$ can be partitioned into three blocks
$$R_1 = \{\alpha,-\alpha\},\qquad R_2 = \{\beta,-\beta\},\qquad R_3 = \{\gamma, -\gamma\}.$$
If $\sigma \in \Gal(L/F)$ and if $\lambda \in R_i$ is a root of $f$, then $\sigma(\lambda) \in R_j$ for some index $\lambda$, and $\sigma(-\lambda) = - \sigma(\lambda) \in R_j$, thus $\sigma(R_i) = R_j$. Therefore $f$ is imprimitive, with blocks $R_1,R_2,R_3$. By Corollary 14.2.10, $\Gal(L/F)$ is isomorphic to a subgroup of $S_3 \wr S_2$.

Since $\alpha,-\alpha, \beta,-\beta,\gamma,-\gamma$ are the distinct roots of $f$, then $\alpha^2,\beta^2,\gamma^2$ are distinct and they are the roots of $g = x^3 +bx^2+cx+d$. Therefore
$$g =  x^3 +bx^2+cx+d = (x-\alpha^2)(x-\beta^2)(x-\gamma^2),$$
so that a splitting field $K$ of $g$ over $F$ is 
$$K = F(\alpha^2,\beta^2,\gamma^2),\qquad F \subset K \subset L.$$
Since $K$ is the splitting field of the separable polynomial $g$, $F \subset K$ is a Galois extension. Note that $g$ is irreducible over $F$, otherwise any non trivial factorization of $g$ over $F$ gives a factorisation of $f$ over $F$. Therefore $K \ne F$.

Moreover,
$$f = g(x^2) = (x^2-\alpha^2)(x^2-\beta^2)(x^2-\gamma^2) = f_1f_2f_3,$$
where $f_1 = x^2 - \alpha^2, f_2 = x^2 - \beta^2,f_3 = x^2 -\gamma^2 \in K[x]$. This proves the first assertion of part (a).

\bigskip

It remains to prove that $K$ is the fixed field of the subgroup $G$ of $\Gal(L/F)$ defined in Exercise 8:
$$G = \{\sigma \in \Gal(L/F)\, | \, \forall i \in \gcro 1, 3 \dcro, \ \sigma(R_i) = R_i \}.$$
To give an explicit description of $G$, note that
\begin{align*}
\sigma \in G &\iff \sigma(\alpha) = \pm \alpha,\ \sigma(\beta) = \pm \beta, \ \sigma(\gamma) = \pm \gamma\\
&\iff \sigma(\alpha^2) = \alpha^2,\ \sigma(\beta^2) = \beta^2, \sigma(\gamma^2) = \gamma^2\\
&\iff \forall \lambda \in K,\ \sigma(\lambda) = \lambda,
\end{align*}
where the last equivalence is explained by the fact that every $\lambda \in K = F(\alpha^2,\beta^2,\gamma^2)$ is a polynomial in $\alpha^2,\beta^2,\gamma^2$.

This proves that every element of $K$ is fixed by every $\sigma \in G$, thus $K \subset L_G$, where $L_G$ is the fixed field of $G$.

Since the Galois correspondence is order reversing, $K \subset L_G$ implies $\Gal(L/K) \supset G$. To prove the inverse inclusion, take $\sigma \in \Gal(L/K)$. Then $\sigma(\lambda) = \lambda$ for all $\lambda \in K$, and the preceding equivalence shows that $\sigma \in G$. Thus $\Gal(L/K) = G$. Applying the Galois correspondence once more, the fixed fields of $\Gal(L/K)$ and $G$ are equal, that is
$$K = L_G.$$
$K$ is the fixed field of $G =  \{\sigma \in \Gal(L/F)\, | \, \sigma(R_1) = R_1,\sigma(R_2) = R_2, \sigma(R_3) = R_3 \}$.

\item[(b)] We have proved in Exercise 13 that $f$ is imprimitive, with blocks
$$R_1 = \{\alpha, \beta, \gamma\},\qquad R_2 = \{\alpha',\beta',\gamma'\}.$$
With the same notations as in Exercise 13 and 8, we have 
$$G = \{\sigma \in \Gal(L/F) \,|\, \sigma(R_1) = R_1,\ \sigma(R_2) = R_2\}.$$
Since $\alpha,\beta,\gamma$ are the roots of $x^3 -\lambda$, and $\alpha',\beta',\gamma'$ the roots of $x^3 -\mu$, where $\{\lambda, \mu\} = \{\sigma(\lambda), \sigma(\mu)\}$, then, for all $\sigma \in \Gal(L/F)$,
\begin{align*}
\sigma \in G &\iff \sigma(\{\alpha,\beta, \gamma\} = \{\alpha,\beta,\gamma\},\  \sigma(\{\alpha',\beta', \gamma'\}) = \{\alpha',\beta',\gamma'\}\\
&\iff \sigma(\lambda) = \lambda,\ \sigma(\mu) = \mu\\
&\iff \forall \xi \in K,\ \sigma(\xi) \in K.
\end{align*}
This proves as in part (a) that $K = L_G$.
\end{proof}


\paragraph{Ex. 14.2.15}{\it
Let $G \subset S_n$ be transitive. Prove that $G$ is primitive if and only if the isotropy subgroups of $G$ are maximal with respect to inclusion.
}

\begin{proof}

Let $i$ be a fixed integer in $\{1,\ldots,n\}$. Since $G$ is transitive, $G\cdot i = \{1,\ldots,n\}$. The Fundamental Theorem of group actions gives
$n = |G\cdot i| = (G:G_i),$
thus $|G_i| n = |G|$.

Given a subgroup $G_i \subset H \subset G$, let $\{\tau_1=e,\ldots,\tau_m\}$ be a complete system of representatives of the left cosets $\tau H, \tau \in G$, where $m = (G:H)$, so that $\tau_1H,\ldots,\tau_mH$ partition $G$.

Consider
$$R_1 = (\tau_1H)\cdot i,\ldots,R_m = (\tau_m H)\cdot i.$$
As $G =\tau_1H \cup \cdots \cup \tau_m H$, then
$$R_1 \cup \cdots\cup R_m = (\tau_1H)\cdot i \cup \cdots \cup (\tau_mH)\cdot I =  G\cdot i = \{1,\ldots,n\}.$$
Now we show that this union is disjoint.

If $u \in R_j \cap R_k = (\tau_j H)\cdot i \cap (\tau_kH)\cdot i$, then
$$u = (\tau_j h)(i) = (\tau_k h')(i),\quad h,h'\in H.$$
Then $h'^{-1}\tau_k^{-1} \tau_j h)(i) = i$, thus
$$h'' = h'^{-1} \tau_k^{-1} \tau_j h \in G_i \subset H,$$
hence $\tau_j h = \tau_k h'h'',\ h,h',h'' \in H$. This shows that $\tau_j H =\tau_k H$, thus $j=k$. This proves
$$j \ne k \Rightarrow R_j \cap R_k = (\tau_j H)\cdot i \cap (\tau_kH)\cdot i = \varnothing.$$

Now we prove that every $\sigma \in G$ preserves the block structure:

If $\sigma \in G$ and $R_j = (\tau_j H)\cdot i$, then $\sigma \tau_j H$ is a left coset, thus $\sigma \tau_j H = \tau_k H$ for some index $k$, and
$$\sigma(R_j) =  (\sigma (\tau_j H \cdot i)) = (\sigma \tau_j H)\cdot i = (\tau_kH)\cdot i = R_k.$$
Since $G$ is transitive, all $R_j$ have same cardinality $l$, and $n = l m$.

To conclude, $R_1,\ldots,R_m$ have same cardinality, partition $\{1,\ldots,n\}$, and every $\sigma \in G$ preserves the block structure. If $l>1$ and $m>1$, then $G$ is imprimitive.

Hence, if we assume that $G$ is primitive, either $l= 1$ or $m=1$.

$\bullet$ If $l=1$, then for all indices $k$,  $(\tau_k H) \cdot i = \{\tau_k(i)\}$. With $k=1$ and $\tau_k = e$, we obtain $H\cdot i = \{i\}$, which shows that $H \subset G_i$, thus $H = G_i$.

$\bullet$ If $m=1$, then $(G:H) = m = 1$, thus $H = G$.

This proves that there is no subgroup $H$ such that $G_i \subsetneq H \subsetneq G$ : $G_i$ is maximal with respect to inclusion.

\bigskip

Conversely, suppose that $G$ is imprimitive, with respect to the blocks $R_1,\ldots,R_m$, where $m>1$. Since $G$ is transitive, all $R_j$ have the same cardinality $|R_j| = l >1$. 

If $i \in \{1,\ldots,n\}$ is some fixed integer, there is some index $j, 1\leq j \leq m$ such that $i \in R_j$. Now, consider the subgroup
$$H = \{\sigma\in G\, |\, \sigma(R_j) = R_j\}.$$
Then $G_i \subset H$: if $\sigma \in G_i$, then $\sigma(i) = i \in R_j$, thus $\sigma(R_j) = R_j$. Moreover

$\bullet$ $H\ne G$: Since $m>1$, there is some $R_k \ne R_j$, and some $w \in R_k$. Since $G$ is transitive, there is some $\sigma \in G$ such that $\sigma(i) = w$, so that $\sigma(R_j) = R_k$. Then $\sigma \not \in H$, and $H \ne G$.

$\bullet$ $G_i \ne H$: Since $|R_j|>1$, there is some $i'\ne i$ in the same block $R_j$. Since $G$ is transitive, there is some $\sigma' \in G$ such that $\sigma'(i) = i'$, so that $\sigma(R_j) = R_j$. Then $\sigma \in H$, but $\sigma \not \in G_i$, so $G_i \ne H$.

To conclude, the subgroup $H$ satisfies
$$G_i \subsetneq H \subsetneq G.$$
This proves that $G_i$ is not maximal with respect to inclusion.

We have proved that $G$ is primitive if and only if the isotropy subgroups of $G$ are maximal with respect to inclusion.

\end{proof}

 \paragraph{Ex. 14.2.16}{\it Let $p$ be prime. The ring $\Z/p^2\Z$ is not a field, but one can still define the group $\mathrm{AGL}(1,\Z/p^2\Z)$. Its action on $\Z/p^2\Z$ allows us to write $\mathrm{AGL}(1,\Z/p^2\Z) \subset S_{p^2}$.
 \be
\item[(a)] Prove that $\mathrm{AGL}(1,\Z/p^2\Z)$ is solvable and transitive of order $p^3(p-1)$.
\item[(b)] Prove that $\mathrm{AGL}(1,\Z/p^2\Z) \subset S_{p^2}$ is imprimitive.
\ee
}
\begin{proof}
\item[(a)] Recall that the group of invertible elements of $\Z/p^2\Z$ is $(\Z/p^2\Z)^*$, where $$|(\Z/p^2\Z)^*| = \phi(p^2) = p^2 - p.$$
As in section 6.4, if $a,b \in \Z/p^2\Z$, we define $\gamma_{a,b} : \Z/p^2\Z \to \Z/p^2\Z$ by $\gamma_{a,b}(x) = ax +b$. Note that $\gamma_{a,b}$ is bijective if and only if $a \in (\Z/p^2\Z)^*$.
We define
$$G = \mathrm{AGL}(1,\Z/p^2\Z) = \{\gamma_{a,b} \, | \, a \in (\Z/p^2\Z)^*, b \in \Z/p^2\Z\}.$$
We note that $\gamma_{a,b} = \gamma_{c,d}$ implies $\gamma_{a,b} (0)= \gamma_{c,d}(0)$, thus $b = d$, and then $\gamma_{a,b} (1)= \gamma_{c,d}(1)$ gives $a =c$:
$$\gamma_{a,b} = \gamma_{c,d} \Rightarrow (a,b) = (c,d).$$
Therefore the map
$$
\left\{
\begin{array}{ccc}
(\Z/p^2\Z)^* \times  \Z/p^2\Z & \to & G\\
(a,b) &\mapsto & \gamma_{a,b}
\end{array}
\right.
$$
is bijective, which proves $|G| = \phi(p^2) p^2 = (p^2-p)p^2 = p^3(p-1)$.

As in section 6.4 (and Exercise 6.4.1), we obtain, if $a,c \in (\Z/p^2\Z)^*$,
$$\gamma_{a,b} \circ \gamma_{c,d} = \gamma_{ac,ad+c} \in G,$$
since $ac \in (\Z/p^2\Z)^*$. Moreover, $\gamma_{a,b}^{-1} = \gamma_{a^{-1}, -a^{-1}b} \in G$, so that $G$ is a subgroup of $S(\Z/p^2\Z) \simeq S_{p^2}$.

The map 
$$
\varphi \left\{
\begin{array}{ccc}
G & \to & (\Z/p^2\Z)^*\\
\gamma_{a,b} &\mapsto & a
\end{array}
\right.
$$
is well-defined, and is a surjective homomorphism by definition of $G$. Moreover, the kernel of $\varphi$ is the subgroup
$$T = \{\gamma_{1,b}\, | \, b \in \Z/p^2\Z\}.$$
Therefore $ \mathrm{AGL}(1,\Z/p^2\Z)/T \simeq (\Z/p^2\Z)^*$. Since $T$ and $ (\Z/p^2\Z)^*$ are Abelian, this proves that $G = \mathrm{AGL}(1,\Z/p^2\Z)$ is solvable.

To prove that $G$ acts transitively on $\Z/p^2\Z$, for all $\alpha,\beta \in \Z/p^2 \Z$, we must find $\gamma_{a,b} \in G$ such that $\gamma_{a,b}(\alpha) = \beta$.

Write $\alpha = [u]_{p^2},  \beta = [v]_{p^2}, a = [A]_{p^2}, b = [B]_{p^2}$, where $u,v,A,B \in \Z$, and $\gcd(p,A) = 1$. Then
$$\gamma_{a,b}(\alpha) = \beta \iff a\alpha + b =\beta \iff A u + B \equiv v \pmod {p^2}.$$
If $\alpha \in (\Z/p^2\Z)^*$, $b = 0$ and $a = \alpha^{-1}\beta$ give a solution $\gamma_{a,b} = \gamma_{\alpha^{-1}\beta , 0}$.

Otherwise, $p \mid u$. If $p^2 \nmid u$, then $u = kp, k\in \Z, p \nmid k$. We can take $B = v-p$, so that
 \begin{align*}
 A u + B \equiv v \pmod {p^2} &\iff Akp + v-p \equiv v \pmod {p^2}\\
 & \iff Ak \equiv 1 \pmod p,
 \end{align*}
which has a solution $A \in \Z$ since $p \nmid A$. 

Finally, if $p^2 \mid u$, then $\alpha = 0$, and $a=1, b = \beta$ gives a solution $\gamma_{1,\beta}$. 

Thus $G$, viewed as a subgroup of $S_{p^2}$, is transitive.

\item[(b)] Consider the subgroup $H$ of $G$ defined by
$$H = p\Z/p^2 Z = \{\overline{0}, \overline{p},\overline{2p},\ldots,\overline{(p-1)p}\},$$
where we write, for every integer $a$, $\overline{a} = [a]_{p^2}$ the class of $a$ modulo $p^2$.

Then the cosets $R_i = \overline{i} + H, 0 \leq i \leq p-1$, partition $G$:
\begin{align*}
&R_0 = H = \{\overline{0}, \overline{p},\overline{2p},\ldots,\overline{(p-1)p}\},\\
&R_1 = \overline{1}+H =  \{\overline{1}, \overline{1+p},\overline{1+2p},\ldots,\overline{1+(p-1)p}\},\\
&\ldots\\
&R_{p-1} = \overline{p-1}+H = \{\overline{p-1}, \overline{p-1 + p},\overline{p-1+ 2p},\ldots,\overline{p^2-1}\}.
\end{align*}
Note that $R_i = \gamma_{1,i}(R_0)$ for all $i$ (here $\gamma_{1,i}$ refers to $\gamma_{\overline1 ,\overline i}$, and $i+H$ to $\overline{i} + H = R_i$).

 We prove
$$\gamma_{a,b}(R_0) = R_b.$$
Indeed, if $\alpha = \overline{kp} \in R_0$, then $\gamma_{a,b}(\overline{kp}) = a\overline{kp} + b \in b+ H = R_b$, thus $\gamma_{a,b}(R_0) \subset R_b$. 
Moreover the cosets $R_0, R_b$ have same cardinality, so that $\gamma_{a,b}(R_0) = R_b$.

Using this result, for all index $i$, since $R_i = i + R_0 = \gamma_{1,i}(R_0)$,
\begin{align*}
\gamma_{a,b}(R_i) &= (\gamma_{a,b}\,  \gamma_{1,i})(R_0)\\
&=\gamma_{a,a+ib}(R_0)\\
&=R_{ai+b}.
\end{align*}
Therefore $G$ permutes the blocks $R_0,\ldots,R_{p-1}$. 

This proves that $G = \mathrm{AGL}(1,\Z/p^2\Z)$ is imprimitive.
\end{proof}

\subsection{PRIMITIVE PERMUTATION GROUPS}

 \paragraph{Ex. 14.3.1}{\it The goal of this exercise is to prove that primitive permutation groups are transitive. Assume that $G \subset S_n$ is primitive but not transitive, and derive a contradiction as follows.
 \be
 \item[(a)] Explain why $n>1$.
 \item[(b)] Let the orbits of $G$ acting on $\{1,\ldots,n\}$ be $R_1,\ldots,R_k$ (see Section A.4 if you have forgotten about orbits). Explain why $k>1$ and why elements of $G$ map every orbit to itself.
 \item[(c)] Conclude that $G$ is imprimitive. Be sure to take into account the case when every orbit consists of a single element.
 \ee
 }
 \begin{proof}

 \item[(a)] If $n = 1$, then $S_n=\{e\}$ and $G = \{e\}$. Then $G$ is primitive (we can't partition $\{1,\ldots,n\} = \{1\}$ with classes $R_i$ such that $|R_i|>1$ for some $i$), but $G$ is transitive, since $e(1) = 1$. So the assumption $G \subset S_n$ is primitive but not transitive implies $n>1$.
 \item[(b)] If $k=1$, there is only one orbit $R_1 = G\cdot 1$. Then $G$ is transitive: if $i,j \in \{1,n\}$, $i = \sigma(1), j = \tau(1),\ \sigma, \tau \in G$, thus $(\tau \sigma^{-1})(i) = j$, where $\tau \sigma^{-1} \in G$. This shows that $G$ is transitive. Since $G$ is not transitive, then $k>1$.
 
 
 Now we prove that, if $\sigma \in G$ and $R_i$ is an orbit, then $\sigma(R_i)$ is an orbit $R_j$.
 
 We know that the orbits partition $\{1,\ldots,n\}$. Let $u$ a fixed element in $R_i$, and $v = \sigma(u)$. Then $v \in R_j$ for some index $j$.  We prove $\sigma(R_i) = R_j$.
 
 If $s \in R_i$, since $u,r$ are in the same orbit, there is some $\tau \in G$ such that $\tau(i) = s$. Then $\sigma(s) = (\sigma \tau \sigma^{-1})(v)$, where $\sigma \tau \sigma^{-1} \in G$, so that $\sigma(s) \in R_j$ and $v \in R_j$. This proves $\sigma(R_i) \subset R_j$. 
 
 Conversely, since $\sigma^{-1}(v) = u \in R_i$, the same reasoning shows that $\sigma^{-1}(R_j) \subset R_i$: if $t \in R_j$: there is some $\lambda \in G$ such that $\lambda(v) = t$, thus $\sigma^{-1}(t) = (\sigma^{-1} \lambda \sigma)(u)$, where $\sigma^{-1} \lambda \sigma \in G$ and $u \in R_i$, so that $t \in R_i$. The two inclusions $\sigma(R_i) \subset R_j$ and $\sigma^{-1}(R_j) \subset R_i$ show that $\sigma(R_i) = R_j$.
 
 \item[(c)] If $|R_i|>1$ for some $i$, then $G$ is imprimitive by Definition 14.2.5. By assumption, $G$ is primitive, thus $|R_i| = 1$ for all $i$, so that every orbit consists of a single element. This means that for all $\sigma \in G$, and for all $i \in \{1,\ldots,n\}$, $\sigma(i) = i$. Therefore $\sigma = e$ for all $\sigma \in G$, $G = \{e\}$. Since $n>1$ by part (a), 
 $G$ is imprimitive, because there are partitions with at least two classes, and several elements in a class, for instance $R_1 = \{1,2\},R_2 =\{1,\ldots,n\} \setminus R_1$, is preserved by $G = \{e\}$. This proves that $G = \{e\}$ is imprimitive when $n>1$, in contradiction with the assumption.
 
This contradiction proves $|R_i|>i$ for some index $i$, thus $G$ is imprimitive.
 
 To conclude, all primitive permutation groups are transitive.
 \end{proof}
 
 \paragraph{Ex. 14.3.2}
 {\it Let $\gamma_{I_n,v} \in \mathrm{AGL}(n,\F_q)$ be translation by $v \in \F_{q}^n$, and let $\gamma_{A,w} \in \mathrm{AGL}(n,\F_q)$ be arbitrary.}
 \be
 \item[(a)] Prove that $\gamma_{A,w}^{-1} = \gamma_{A^{-1},-A^{-1}w}$.
 \item[(b)] Prove that $\gamma_{A,w} \circ \gamma_{I_n,v} \circ \gamma_{A,w}^{-1} = \gamma_{I_n,Av}$.
 \item[(c)] Part (b) shows that the translation subgroup $\F_q^n \subset \mathrm{AGL}(n,\F_q)$ is normal. Prove that the quotient group $\mathrm{AGL}(n,\F_q)/\F_q^n$ is isomorphic to $\mathrm{GL}(n,\F_q)$.
 \item[(d)] Prove that $\mathrm{AGL}(n,\F_q)$ is isomorphic to the semidirect product $\F_q^n \rtimes \mathrm{GL}(n,\F_q)$, where $\mathrm{GL}(n,\F_q)$ acts on $\F_q^n$ by matrix multiplication.
 \ee
 
\begin{proof}
We give first the product of two elements in $\mathrm{AGL}(n,\F_q)$, to generalize the results of Section 6.4A. Using the definition $\gamma_{A,v}(u) = Au+v$, we obtain, for all $u \in \F_q^n$,
\begin{align*}
(\gamma_{A,v} \circ \gamma_{B,w})(u) &= \gamma_{A,v}(Bu + w)\\
&= A(Bu + w) + v\\
&= ABu + Aw +v\\
&= \gamma_{AB,Aw+v}(u),
\end{align*}
thus
\begin{align}
\gamma_{A,v} \circ \gamma_{B,w} = \gamma_{AB,Aw+v}
\end{align}
\item[(a)] For all $u,v \in \F_q^n$,
\begin{align*}
v = \gamma_{A,w}(u) &\iff v = Au + w\\
&\iff u = A^{-1}(v - w) = A^{-1} v - A^{-1}w,
\end{align*}
thus
\begin{align}
\gamma_{A,w}^{-1} = \gamma_{A^{-1}, - A^{-1}w}.
\end{align}
\item[(b)]
Using the formulas (1) and (2), we obtain
\begin{align*}
\gamma_{A,w} \circ \gamma_{I_n,v} \circ \gamma_{A,w}^{-1} &= \gamma_{A,w} \circ \gamma_{I_n,v} \circ \gamma_{A^{-1}, - A^{-1}w}\\
&= \gamma_{A,w} \circ \gamma_{A^{-1}, -A^{-1}w + v}\\
&=\gamma_{I_n,A(-A^{-1}w + v) + w}\\
&=\gamma_{I_n,Av}.
\end{align*}
We have proved
\begin{align}
\gamma_{A,w} \circ \gamma_{I_n,v} \circ \gamma_{A,w}^{-1}  = \gamma_{I_n,Av}.
\end{align}


\item[(c)] Consider the map
$$
\varphi
\left\{
\begin{array}{ccc}
\mathrm{AGL}(n,\F_q) & \to &\mathrm{GL}(n,\F_q)\\
\gamma_{A,v} & \mapsto &A.
\end{array}
\right.
$$
The map $\varphi$ is well defined, since for all $A,B \in \mathrm{GL}(n,\F_q)$ and for all $v,w \in \F_q^n$,
\begin{align}
\gamma_{A,v} = \gamma_{B,w} \iff (A,v) = (B,w).
\end{align}
Then 
$$
\varphi(\gamma_{A,v} \circ \gamma_{B,w}) =\varphi( \gamma_{AB,Aw+v}) = AB = \varphi(\gamma_{A,v} \varphi(\gamma_{B,w})),
$$
thus $\varphi$ is a group homomorphism.

Since every $A \in \mathrm{GL}(n,\F_q)$ is the image of $\gamma_{A,0}$, $\varphi$ is surjective, and
$$\ker \varphi = \{\gamma_{I,w} \, |\, w \in \F_q^*\} \simeq \F_q^n.$$
Therefore, the first Isomorphism Theorem gives
$$\mathrm{AGL}(n,\F_q)/ \F_q^n \simeq \mathrm{GL}(n,\F_q),$$
with the identification of vectors $w$ with the translations $\gamma_{I,w}$.

\item[(d)] Consider
$$
\psi
\left\{
\begin{array}{ccc}
\mathrm{AGL}(n,\F_q) & \to & \F_q^n \rtimes \mathrm{GL}(n,\F_q)\\
\gamma_{A,v} & \mapsto & (v,A).
\end{array}
\right.
$$
By formula (4), the map $\psi$ is well defined. It is a bijection, with inverse $(v,A) \mapsto \gamma_{A,v}$.

Following the formula (6.9), $(h,g)\, (h',g') = (h(g\cdot h'), gg')$, which defines the product in $H \rtimes G$, the product in $\F_q^n \rtimes \mathrm{GL}(n,\F_q)$ is given by
\begin{align}
(v,A)\, (w,B) = (v+ Aw,AB),\qquad v,w \in \F_q^n, \quad A,B \in \mathrm{GL}(n,\F_q).
\end{align}
Therefore, using (5) and (1),
\begin{align*}
\psi(\gamma_{A,v})  \psi(\gamma_{B,w}) &= (v,A)(w,B)\\
&= (v+ Aw,AB)\\
&=\psi(\gamma_{AB,Aw+v})\\
&=\psi(\gamma_{A,v}) \circ \psi(\gamma_{B,w}), 
\end{align*}
thus $\psi$ is a group isomorphism, and
$$\mathrm{AGL}(n,\F_q) \simeq \F_q^n \rtimes \mathrm{GL}(n,\F_q).$$
\end{proof}

 \paragraph{Ex. 14.3.3}{\it
 Consider the affine semilinear group $\mathrm{A\Gamma L}(n,\F_q)$ for $q = p^m$.
 \be
 \item[(a)] Prove that $\mathrm{AGL}(n,\F_q)$ is a normal subgroup of $\mathrm{A\Gamma L}(n,\F_q)$ of index $m$.
 \item[(b)] Prove that $\F_q^n$ is a normal subgroup of $\mathrm{A\Gamma L}(n,\F_q)$.
 \item[(c)] Prove that elements of $\mathrm{A\Gamma L}(n,\F_q)$ give maps $\F_q^n \to \F_q^n$ that are affine linear over $\F_p$.
 \ee
 }
 
 \bigskip
 
 We give some preliminary formulas.
 
Note that $\gamma_{A,v} = \gamma_{A,e,v}, \ A \in \mathrm{GL}(n,\F_q), v \in \F_q$, where $e$ is the identity element of $\Gal(F_{q^m}/\F_p)$, thus $\mathrm{AGL}(n,\F_q) \subset \mathrm{A\Gamma L}(n,\F_q)$.

For all $u = (\alpha_1,\ldots,\alpha_n) \in \F_q^n$, we write $\sigma(u) = (\sigma(\alpha_1),\ldots,\sigma(\alpha_n))$. 

If $A =(a_{ij})_{1\leq i,j \leq n} \in \mathrm{GL}(n,\F_q)$, then 
\begin{align*}
\sigma(A\cdot u) &= \sigma\left(\sum_{j=1}^n a_{1j} \alpha_j,\ldots,\sum_{j=i}^n a_{ij} \alpha_j,\ldots,\sum_{j=1}^n a_{nj} \alpha_k\right)\\
&=\left(\sum_{j=1}^n \sigma(a_{1j}) \sigma(\alpha_j),\ldots,\sum_{j=i}^n \sigma(a_{ij})\sigma( \alpha_j),\ldots,\sum_{j=1}^n \sigma(a_{nj})\sigma( \alpha_j)\right)\\
&=\sigma(A)\cdot \sigma(u),
\end{align*}
where $\sigma(A) = (\sigma(a_{ij}))_{1\leq i,j \leq n}$, and similarly 
$$\sigma(A\cdot u + v) = \sigma(A)\cdot  \sigma(u) + \sigma(v).$$
Then, for all $u \in \F_q^n$,
\begin{align*}
(\gamma_{A,\sigma,v} \circ \gamma_{B,\tau,w})(u) &= A\sigma(B\tau(u)+w) + v\\
&=A\sigma(B) (\sigma\tau)(u) + A\sigma(w) + v\\
&=\gamma_{A\sigma(B),\sigma \tau,A \sigma(w) + v}(u),
\end{align*}
thus
\begin{align}
\gamma_{A,\sigma,v} \circ \gamma_{B,\tau,w} = \gamma_{A\sigma(B),\sigma \tau,A \sigma(w) + v}.
\end{align}

For all $u,s \in \F_q^n$,
\begin{align*}
s = \gamma_{A,\sigma,v}(u) &\iff s = A \sigma(u) + v\\
&\iff \sigma(u) = A^{-1}(s -v)\\
&\iff u = \sigma^{-1}(A^{-1} s - A^{-1}v)\\
&\iff u = \sigma^{-1}(A^{-1}) \sigma^{-1}(s) - \sigma^{-1}(A^{-1})\sigma^{-1}(v)\\
&\iff u = \gamma_{\sigma^{-1}(A^{-1}),\sigma^{-1},- \sigma^{-1}(A^{-1})\sigma^{-1}(v)},
\end{align*}
thus
\begin{align}
\gamma_{A,\sigma,v}^{-1} = \gamma_{\sigma^{-1}(A^{-1}),\sigma^{-1},- \sigma^{-1}(A^{-1})\sigma^{-1}(v)}.
\end{align}
By (6) and (7), $\mathrm{A\Gamma L}(n,\F_q)$ is a subgroup of $S(\F_q^n)$.
Moreover, if $\gamma_{A,\sigma,v}, \gamma_{B,\tau,w} \in  \mathrm{A\Gamma L}(n,\F_q)$, then
\begin{align}
 \gamma_{A,\sigma,v} =  \gamma_{B,\tau,w} \Rightarrow (A,\sigma,v) = (B,\tau,w).
\end{align}
 Indeed, if $\gamma_{A,\sigma,v} =  \gamma_{B,\tau,w}$, then for all $u \in \F_q^n$, $A \sigma(u) + v = B \tau(u) + w$. With $u=0$, we obtain $v = w$. If we take $u =e_i =(0,\ldots,0,1,0,\ldots,0)$, where $(e_1,\ldots,e_n)$ is the standard base of $\F_q^n$, then $\sigma(e_i) = e_i = \tau(e_i)$, so that $Ae_i = Be_i,\ i=1,\ldots,n$. This implies $A = B$, and $\sigma(u) = \tau(u)$ for all $u\in \F_q^n$. Therefore, with $u = (\alpha,0,\ldots,0),\ \alpha \in \F_q$, we obtain $\sigma(\alpha) = \tau(\alpha)$, thus $\sigma = \tau$.

 \begin{proof}
 \item[(a)] 
 By (8),
 $$
 \varphi
 \left\{
 \begin{array}{ccc}
 \mathrm{A\Gamma L}(n,\F_q) &\to & \Gal(\F_{p^m},\F_p)\\
 \gamma_{A,\sigma,v} & \mapsto & \sigma
 \end{array}
 \right.
 $$
 is well defined. Moreover, by (6), if $\gamma_{A,\sigma,v}, \gamma_{B,\tau,w} \in \mathrm{AGL}(n,\F_q)$,
 $$\varphi(\gamma_{A,\sigma,v} \circ \gamma_{B,\tau,w} ) = \varphi( \gamma_{A\sigma(B),\sigma \tau,A \sigma(w) + v}) =\sigma \tau = \varphi(\gamma_{A,\sigma,v})\varphi( \gamma_{B,\tau,w}),
 $$
 thus $\varphi$ is a group homomorphism. If $\sigma$ is any element of $\Gal(\F_{p^n},\F_p)$, then $\sigma = \varphi(\gamma_{I_n, \sigma,0}$, thus $\varphi$ is surjective. The kernel of $\varphi$ is
 $$\ker \varphi = \{\gamma_{A,e,v}\, | \, A\in \mathrm{GL}(n,\F_q), v \in \F_q^n\} = \{\gamma_{A,v}\, | \, A\in \mathrm{GL}(n,\F_q), v \in \F_q^n\}  \subset \mathrm{AGL}(n,\F_q).$$

This shows that $\mathrm{AGL}(n,\F_q)$ is a normal subgroup of $\mathrm{A\Gamma L}(n,\F_q)$, and the first Isomorphism Theorem gives
$$ \mathrm{A\Gamma L}(n,\F_q)/ \mathrm{AGL}(n,\F_q) \simeq \Gal(\F_{p^m},\F_p).$$
Since $\Gal(\F_{p^m},\F_p)$ is a cyclic group of order $m$, $\mathrm{AGL}(n,\F_q)$ is a normal subgroup of $\mathrm{A\Gamma L}(n,\F_q)$ of index $m$.

\item[(b)] Here, $\F_q^n$ is identified with the group of translations $\{\gamma_{I_n,e,w}\,|\, w \in \F_q^n\}$, and, using (6) and (7),
\begin{align*}
\gamma_{A,\sigma,v} \circ \gamma_{I_n,e,w} \circ \gamma_{A,\sigma,v}^{-1} &= \gamma_{A,\sigma,v} \circ \gamma_{I_n,e,w}  \circ \gamma_{\sigma^{-1}(A^{-1}),\sigma^{-1},- \sigma^{-1}(A^{-1})\sigma^{-1}(v)}\\
&= \gamma_{A,\sigma,v} \circ  \gamma_{\sigma^{-1}(A^{-1}),\sigma^{-1},-\sigma^{-1}(A^{-1}) \sigma^{-1}(v) + w}\\
&=\gamma_{A \sigma \sigma^{-1}(A^{-1}),\sigma \sigma^{-1}, A\sigma(-\sigma^{-1}(A^{-1}) \sigma^{-1}(v) + w) + v}\\
&= \gamma_{I_n,e,A\sigma(w)}.
\end{align*}
We have proved
\begin{align}
\gamma_{A,\sigma,v} \circ \gamma_{I_n,e,w} \circ \gamma_{A,\sigma,v}^{-1} = \gamma_{I_n,e,A\sigma(w)} \in \F_q^n,
\end{align}
therefore $\F_q^n$ is a normal subgroup of $\mathrm{A\Gamma L}(n,\F_q)$.

\item[(c)]  $\F_q^n$, which is a vector space over $\F_q$, is also a vector space over $\F_p$, by restriction of the extern operation 
$
\left\{
\begin{array}{ccc}
\F_q \times \F_q^n & \to & \F_q^n\\
u & \mapsto &\lambda u
\end{array}
\right.
$
to $\F_p \times \F_q^n$.

Let ${\cal B} = (e_1,\ldots,e_m)$ be a base of $\F_q$ over $\F_p$.
As $\F_p$-vector spaces, $\F_q^n$ and $\F_p^{nm}$ are isomorphic, where an isomorphism $\varphi$ is given by
$$
\varphi \left\{
\begin{array}{ccc}
\F_q^n & \to & \F_p^{nm}\\
(\alpha_1,\ldots,\alpha_n)& \mapsto &(x_1^1,\ldots,x_m^1;\ldots;x_1^n,\ldots,x_m^n),
\end{array}
\right.
$$
where $\alpha_i = \sum_{j=1}^m x_j^i e_j,\ i=1,\ldots,n.$ (this isomorphism depends of the choice of the base $\cal B$). This proves $\dim_{\F_p} \F_q^n = nm$.
Consider the two maps
$$
\psi
\left\{
\begin{array}{ccc}
\F_q^n &\to &\F_q^n\\
u  = (\alpha_1,\ldots,\alpha_n)& \mapsto &\sigma(u) = (\sigma(\alpha_1),\ldots,\sigma(\alpha_n)),
\end{array}
\right.
\qquad 
\chi
\left\{
\begin{array}{ccc}
\F_q^n &\to &\F_q^n\\
v& \mapsto &A \cdot v.
\end{array}
\right.
$$
The automorphism $\sigma \in \Gal(\F_q/\F_p)$ is $\F_q$-linear: if $\lambda \in \F_p, \alpha \in \F_q$, $\sigma(\lambda \alpha) = \sigma(\lambda) \sigma(\alpha) = \lambda \sigma(\alpha)$. Thus $\psi$ is $\F_p$-linear. Moreover, $\chi$ is $\F_q$-linear, a fortiori $\F_p$-linear. Therefore, $\chi \circ \psi = u \mapsto A\cdot \sigma(u)$ is $\F_p$-linear, so that
$$
\gamma_{A,\sigma,v}
\left\{
\begin{array}{ccc}
\F_q^n & \to & \F_q^n\\
u &\mapsto & A\cdot \sigma(u) + v
\end{array}
\right.
$$
is affine linear over $\F_p$.
 \end{proof}
 
 
\paragraph{Ex. 14.3.4}{\it Let $F$ be any field. The definition of $\mathrm{AGL}(n,\F_q)$ given in the text extend to $\mathrm{AGL}(n,F)$.
The goal of this exercise is to prove that $\mathrm{AGL}(n,F)$ is doubly transitive when we regard elements of $\mathrm{AGL}(n,F)$ as permutations of the vector space $F^n$.
\be
\item[(a)] Use $F^n \subset \mathrm{AGL}(n,F)$ to show that $\mathrm{AGL}(n,F)$ acts transitively on $F_n$.
\item[(b)] Inside $\mathrm{AGL}(n,F)$, we have the isotropy subgroup of $\,0\in F_n$. Prove that this isotropy subgroup is $\mathrm{GL}(n,F)$.
\item[(c)] Prove that $\mathrm{GL}(n,F)$ acts transitively on $F^n\setminus \{0\}$.
\item[(d)]Use Exercise 19 below to conclude that $\mathrm{AGL}(n,F)$ is doubly transitive.
\ee
}
\begin{proof}
\item[(a)] Let $u,u'$ be any vectors in $F^n$. The equality $I_n\cdot u  + (u'- u) = u'$ shows that $\gamma_{I_n,u'-u}(u) = u'$, where $\gamma_{I_n,u'-u} \in \mathrm{AGL}(n,F)$.

Therefore $\mathrm{AGL}(n,F)$ acts transitively on $F^n$.

\item[(b)] Write $G_0$ the isotropy group of $0$. Then
$$\gamma_{A,v} \in G_0 \iff A\cdot 0 + v = 0 \iff v = 0.$$
Therefore $G_0 = \{\gamma_{A,0}\, | \,  A \in \mathrm{GL}(n,F)\} \simeq \mathrm{GL}(n,F)$.

In section 14.3.B, we identified $\{\gamma_{A,0}\, \ A \in \mathrm{GL}(n,F)\} $ with $\mathrm{GL}(n,F)$, so that
$$G_0 = \mathrm{GL}(n,F).$$

\item[(c)]

 Let $u,v \in F^n \setminus \{0\}$. Since $u \ne 0$, we can compete $u$ in a base ${\cal B} _1= (u_1,\ldots,u_n)$ of $F_n$, where $u_1 = u$. Similarly, we can complete $v\ne 0$ in a base ${\cal B}_2 = (v_1,\ldots,v_n)$, where $v_1 = v$. 

Since ${\cal B}_1,{\cal B}_2$ are two bases, there exists some bijective linear map $f : F^n \to F^n$ such that $f(u_i) = v_i,\ i=1,\ldots,n$, so that $f(u) = v$.

Let ${\cal B} = (e_1,\ldots,e_n)$ be the standard base of $F^n$. Then the matrix $A = {\cal M}_{\cal B}(f)$ of $f$ satisfies $A \in \mathrm{GL}(n,F)$, and $A \cdot u = v$. This proves that $\mathrm{GL}(n,F)$ acts transitively on $F^n \setminus\{0\}$.

\item[(d)] Since  the isotropy group $G_0$ acts transitively on $F^n\setminus \{0\}$, Exercise 14.3.19 (a) shows that $\mathrm{AGL}(n,F)$ acts transitively on $F^n$, using that  $\mathrm{AGL}(n,F)$ can be viewed as a subgroup $G$ of $S_{|F^n|}$.
\end{proof} 
 
\paragraph{Ex. 14.3.5}{\it Let $A$ and $B$ be non-Abelian simple groups. You will show that $A \times \{e_B\}$ and $\{e_A\}\times B$ are the only nontrivial normal subgroups of $A \times B$. Let $N \subset A \times B$ be a normal subgroup different from $\{(e_A,e_B)\},A \times\{e_B\}$, and $\{e_A\} \times B$.
\be
\item[(a)] Prove that $A \times\{e_B\}$ and $\{e_A\}\times B$ are normal in $A \times B$. Hence, if we can show that $N = A\times B$, then we will be done.
\item[(b)] Prove that we can find $(a,b)\in N$ such that $e_A \ne a \in A$ and $e_B \ne b\in B$.
\item[(c)] Let $(a,b)\in N$ be as in part (b). Show that $(aa_1a^{-1}a_1^{-1}, e_B) \in N$ for any $a_1 \in A$.
\item[(d)] Given $e_A\ne a \in A$, prove that there is $a_1\in A$ such that $aa_1\ne a_1a$. Then combine this with parts (b) and (c) to show that $N\cap(A\times\{e_B\}) = A \times\{e_B\}$.
\item[(e)] Part (d) implies that $A \times \{e_B\} \subset N$, and the inclusion $\{e_A\} \times B \subset N$ is proved similarly. Use this to prove that $N = A\times B$.
\ee
Exercise 18 will explore various aspects of this argument.
}

\begin{proof}
\item[(a)] Take $(a_0,e_B)$ in $A\times\{e_B\}$, and $(a,b) \in A\times B$. Then
\begin{align*}
(a,b)(a_0,e_B)(a,b)^{-1} &= (a,b)(a_0,e_B)(a,b)^{-1}\\
&=(a,b)(a_0,e_B)(a^{-1},b^{-1})\\
&=(aa_0a^{-1},be_Bb^{-1}\\
&=(aa_0a^{-1}, e_B) \in A \times\{e_B\},
\end{align*}
thus $A\times \{e_B\}$ is normal in $A \times B$, and similarly $\{e_A\} \times B$ is normal in $A \times B$.

\item[(b)] Reasoning by contradiction, suppose that we can't find $(a,b) \in N$ such that $a \ne e_A,b\ne e_B $ , then $N \subset (A \times \{e_B\}) \cup (\{e_A\} \times B)$. 

Note that $A\times \{e_B\} \simeq A$ is simple. If $N \subset A \times \{e_B\}$, then $N$ is normal in $A \times \{e_B\} \subset A \times B$, thus $N = A\times\{e_A\}$ or $N = \{(e_A,e_B)\}$, but this contradicts the assumptions on $N$. Therefore $N \not \subset A \times \{e_B\}$, and similarly $N \not \subset \{e_A\} \times B$, so that
\begin{align}
&N \subset (A \times \{e_B\}) \cup (\{e_A\} \times B), \quad N \ne \{(e_A,e_B)\}\\
&N \not \subset A \times \{e_B\}, \quad N \not \subset \{e_A\} \times B.
\end{align}
By (10), there are two symmetrical cases.

$\bullet$ Case 1: There is some $e_A \ne a \in A$ such that $n_1 = (a,0) \in N$. Since $N \not \subset A \times \{e_B\}$, there is some $b \in B, b\ne e_B$, such that $n_2 = (e_A,b) \in N$. Then $n = n_1n_2 = (a,b) \in N, a\ne e_A,b\ne e_B$, but this contradicts (10).

$\bullet$ Case 2: There is some $e_B \ne b \in B$ such that $n_2 = (0,b) \in N$: same contradiction.

Therefore
$$N \not \subset (A \times \{e_B\}) \cup (\{e_A\} \times B).$$
We can find $(a,b) \in N$ such that $a \ne e_A,b\ne e_B $.

\item[(c)] $N$ is normal, and  $(a^{-1},b^{-1}) = (a,b)^{-1} \in N$, thus
$$(a_1,e_B)(a,b)^{-1}(a_1,e_B)^{-1} = (a_1 a^{-1}a_1^{-1},b^{-1}) \in N.$$
Left multiplication by $(a,b) \in N$ gives
$$(a,b)[(a_1,e_B)(a,b)^{-1}(a_1,e_B)^{-1} ] = (aa_1a^{-1}a_1^{-1}, e_B) \in N.$$

\item[(d)] Let $a\ne e_A$ be a fixed element in $A$.

Consider the center of $A$:
$$Z(A) = \{x \in A\, | \, \forall y \in A, xy = yx\}.$$
$Z(A)$ is a normal subgroup of $A$ (it is the kernel of $f : A \to \mathrm{Aut(A)}$ defined by $f(y) =\phi_y$, where $\phi_y(x) = yxy^{-1}$ for all $x\in A$). Since $A$ is non-Abelian, $Z(A) \ne A$, and since $A$ is simple, $Z(A) = \{e_A\}$.

Therefore, $a\ne e_A$ implies $a \not \in Z(A)$, thus there exists $a_1 \in A$ such that $aa_1 \ne a_1 a$.

Since $N$ and $A\times \{e_B\}$ are normal subgroups of $A\times B$, the intersection $N \cap (A\times \{e_B\})$ is normal in $A\times B$, a fortiori in the simple group $A\times \{e_B\}$. Therefore  $N \cap (A\times \{e_B\}) =\{(e_A,e_B)\}$ or $N \cap (A\times \{e_B\}) = A \times \{e_B\}$. But $N \cap (A\times \{e_B\}) =\{(e_A,e_B)\}$ is impossible, because $(e_A,e_B) \ne (aa_1a^{-1}a_1^{-1}, e_B) \in N$. Hence $N \cap (A\times \{e_B\}) = A \times \{e_B\}$.

\item[(e)] Part (d) implies that $A \times \{e_B\} \subset N$, and the inclusion $\{e_A\} \times B \subset N$ is proved similarly. Let $(a,b)$ be any element in $A\times B$. Then 
$n_1 = (a,e_B) \in A\times\{e_B\} \subset N$, and $n_2 = (e_A,b) \in \{e_A\} \times B \subset N$, thus $n_1 \in N, n_2 \in N$, so that $n =n_1n_2 = (a,b) \in N$. This proves $A\times B \subset N$, where $N \subset A\times B$. Therefore $N = A \times B$.

To conclude, if $A,B$ are non-Abelian simple groups, the only non trivial normal subgroups of $A\times B$ are $A \times \{e_B\}$ and $\{e_A\} \times B$.
\end{proof}

\paragraph{Ex 14.3.6}{\it Let $A \subset N$ be a minimal normal subgroup, where $N$ is normal in a larger group $G$. Given $g \in G$, we set $A_g = gAg^{-1}$.
\be
\item[(a)] Prove that $A_g$ is isomorphic to $A$ and is a minimal normal subgroup of $N$.
\item[(b)] Fix $g_1 \in G$ and consider $AA_{g_1}$. By Exercise 7, we know that $AA_{g_1}$ is a subgroup of $N$. Assume that $A_g \subset AA_{g_1}$ for all $g \in G$. Prove that $AA_{g_1}$ is normal in $G$.
\item[(c)]Use the following idea to complete the proof of Proposition 14.3.10. Let $\cal A$ be the set of all subgroups of $N$ of the form $A_{g_1}\cdots A_{g_n}$ such that the map $(a_1,\ldots,a_n) \mapsto a_1\ldots a_n$ defines an isomorphism
$$A_{g_1}\times\cdots\times A_{g_n} \simeq A_{g_1}\cdots A_{g_n}.$$
Note that $A = A_e \in {\cal A}$. Then pick an element of $\cal A$ of maximal order.
\ee
}
\begin{proof}
\item[(a)] Consider
$$
\varphi_g
\left\{
\begin{array}{ccc}
N & \mapsto & N\\
a & \mapsto &gag^{-1}.
\end{array}
\right.
$$
For all $a,b \in N$, $\varphi_g(ab) = gabg^{-1} =gag^{-1} g bg^{-1} = \varphi_g(a) \varphi_g(b)$, thus $\varphi_g$ is a group homomorphism.

Moreover, $\varphi_g \circ \varphi_{g^{-1}} =  1_N = \varphi_{g^{-1}} \circ \varphi_g$, so that $\varphi$  is bijective: $\varphi$ is a group automorphism.

Since $A$ is normal subgroup of  $N$, $A_g = \varphi_g(A)$ is also a normal subgroup of $N$.

Now take $H$ a non trivial subgroup of $A_g$. Reasoning by contradiction assume that $H$ is normal in $N$. Then  $K = \varphi_g^{-1}(H) = g^{-1}H g$ is a non trivial subgroup of $A$. Since $H$ is normal in $N$, and $\varphi_g$ is an automorphism of $N$, $K = \varphi_g^{-1}(H)$ is normal in $N$. This contradicts the fact that $A$ is a minimal normal subgroup of $N$. This  contradiction proves that $H$ is not normal in $N$. We can conclude that $A_g$ is a minimal normal subgroup of $N$.

\item[(b)]  Let $g$ be any element of $G$. The hypothesis gives the inclusions $A_g = gAg^{-1} \subset AA_{g_1}$ and $A_{gg_1} = (gg_1) A (gg_1)^{-1} \subset AA_{g_1}$, therefore, since $AA_{g_1}$ is a subgroup,
\begin{align*}
gAA_{g_1} g^{-1} &= gA g^{-1}\ gA_{g_1} g^{-1}\\
&= gAg^{-1}\ gg_1A g_1^{-1}g^{-1} \subset AA_{g_1}.
\end{align*}
This proves that $A A_{g_1}$ is a normal subgroup of $G$.

\item[(c)] Let $\cal A$ be the set of all subgroups of $N$ of the form $A_{g_1}\cdots A_{g_n}$ such that the map $(a_1,\ldots,a_n) \mapsto a_1\ldots a_n$ defines an isomorphism
$$A_{g_1}\times\cdots\times A_{g_n} \simeq A_{g_1}\cdots A_{g_n}.$$
Note that $A = A_e \in {\cal A}$. Then pick an element $H$ of $\cal A$ of maximal order. Then 
$$H = A_{g_1}\cdots A_{g_n},\qquad g_1,\ldots,g_n \in G  \subset N.$$
If $H = N$, then we are done. Assume now that $H \ne N$.

If $A_g \subset H$ for all $g\in G$, then $H$ is normal in $G$: 

for all $g \in G$, $A_{gg_i}= (gg_i)A(gg_i)^{-1} \subset H$, thus
$$gHg^{-1} = gA_{g_1}g^{-1} gA_{g_2}g^{-1} \cdots gA_{g_n}g^{-1} = A_{gg_1}\cdots A_{gg_n} \subset H.$$
Since $H \ne N$, and $H \ne \{e\}$ ($|H| \geq |A|>1$), this is impossible by the minimality of $N$. Hence there is $g_{n+1} \in G$ such that $A_{g_{n+1}} \not \subset H$.

We don't know if $H$ is normal in $G$, but $H = A_{g_1}\cdots A_{g_n}$ is normal in $N$, since all $A_{g_i}$ are normal in $N$ (see Exercise 7(a)). Hence $H \cap A_{g_{n+1}}$ is a normal subgroup in $N$, and lies in the minimal normal subgroup $A_{g_{n+1}}$ of $N$. Since $A_{g_{n+1}} \not \subset H$, $H \cap A_{g_{n+1}} \ne H$, therefore $H \cap A_{g_{n+1}} = \{e\}$. By Exercise 7, this proves that the map $(a_1,\ldots,a_{n+1}) \mapsto a_1\ldots a_n$ defines an isomorphism
$$A_{g_1}\times\cdots\times A_{g_n}\times A_{g_{n+1}} \simeq A_{g_1}\cdots A_{g_n} A_{g_{n+1}} \subset N.$$
But $A_{g_{n+1}} \not \subset H$, thus $H =  A_{g_1}\cdots A_{g_n} A_{g_{n+1}}   \subsetneq A_{g_1}\cdots A_{g_n} A_{g_{n+1}} A_{g_{n+1}}$, and this contradicts the maximality of $H$. This contradiction proves that $H = N$, so that
$$N = A_{g_1}\cdots A_{g_n} \simeq A^n.$$
\end{proof}


\paragraph{Ex 14.3.7}{\it Let $H$ and $K$ be normal subgroups of a group $G$. 

Let $HK =\{hk \mid h \in H, k \in K\}$.
\be
\item[(a)] Prove that $HK$ is a normal subgroup of $G$.
\item[(b)] Assume that $H \cap K = \{e\}$. Prove that $hk = kh$ for all $h\in H, k \in K$.
\item[(c)] As in part (b), assume that $H\cap K = \{e\}$. Prove that the map $H \times K \to HK$ defined by $(h,k) \mapsto hk$ is a group isomorphism.
\ee
}
\begin{proof}
\item[(a)] 

  \item[$\bullet$] Since $e\in H, e \in K$, $e = e e \in HK$, thus $HK \ne \varnothing$.
  \item[$\bullet$] Let $x = hk, y = h'k'$ be any elements of $HK$, where $h,h' \in H,\ k,k'\in K$. Then
  \begin{align*}
  xy &= hkh'k'\\
  &= hh' h'^{-1}kh' k' = h''k'',
  \end{align*}
  where $h''= hh'\in H, k'' = (h'^{-1}kh' )k' $, and $h'^{-1}kh' \in K$, since $K$ is normal in $G$, so that $k'' =  (h'^{-1}kh' )k' \in K$. Thus $xy \in HK$
  \item[$\bullet$] If $x = hk \in HK$, where $h \in H, k \in K$, then
  $$x^{-1} = k^{-1}h^{-1} = h^{-1}(h k^{-1} h^{-1}),$$
  where $h^{-1} \in H$, and $h k^{-1} h^{-1} \in K$, since $H$ is normal in $G$. Thus $x^{-1} \in HK$.
  
  We have proved that $HK$ is a subgroup of $G$. Moreover, if $x = hk \in HK$, and $g \in G$ then
  $$gx g^{-1} = ghk g^{-1} = (ghg^{-1})(gkg^{-1}),$$
  where $ghg^{-1} \in H, gkg^{-1}$ in $K$, since $H,K$ are normal subgroups. Therefore $HK$ is a normal subgroup of $G$.

\item[(b)] Assume that $H \cap K = \{e\}$. If $h \in H,$ and $k \in K$, consider $z = hkh^{-1}k^{-1} \in G$. Then $z = h(kh^{-1}k^{-1})$, where $h \in H, k h^{-1} k^{-1} \in H$, so that $z \in H$. Similarly $z = (hkh^{-1}) k^{-1}$, where $hkh^{-1} \in H$ and $k^{-1} \in K$, so that $z \in H \cap K = \{e\}$. Thus $hkh^{-1}k^{-1} = e$, which proves $hk = kh$.

$$(H \lhd G, K \lhd G, H \cap K = \{e\} ) \Rightarrow \forall h\in H, \forall k \in K, \ hk = kh.$$

\item[(c)]  As in part (b), assume that $H\cap K = \{e\}$. Define
$$
\varphi
\left\{
\begin{array}{ccc}
H \times K & \mapsto & HK\\
(h,k) & \mapsto &hk.
\end{array}
\right.
$$
  \item[$\bullet$] If $u = (h,k) \in H\times K, v = (h',k' )\in H\times K$, then part (b) shows that $h'k = kh'$, thus
  \begin{align*}
  \varphi(uv) &=\varphi(hh',kk')\\
  &= hh'kk'\\
  &=hkh'k'\\
  &=\varphi(u) \varphi(v),
  \end{align*}
thus $\varphi$ is a group homomorphism.

 \item[$\bullet$] If $x$ is any element of $HK$, then by definition there are some $h,k,\ h\in H,k \in K$ such that $x = hk = \varphi(h,k)$, where $(h,k) \in H\times K$. Therefore $\varphi$ is surjective.
 
 \item[$\bullet$] if $u = (h,k) \in \ker \varphi$, then $hk = e$, thus $h = k^{-1} \in H\cap K = \{e\}$, and $(h,k) = (e,e)$. This proves $\ker \varphi = \{(e,e)\}$, and $\varphi$ injective.
 
 We have proved that $\varphi$ is a group isomorphism.
\end{proof}

 
 \paragraph{Ex. 14.3.19}{\it Let $G \subset S_n$ be transitive, and let $G_i$ be the isotropy subgroup of $i\in \{1,\ldots,n\}$. Thus $G_i = \{\sigma \in G \, | \, \sigma(i) = i\}$.
 \be
 \item[(a)] Prove that $G$ is doubly transitive if and only if $G_i$ acts transitively on $\{1,\ldots,n\} \setminus \{i\}$.
 \item[(b)] More generally, let $k\geq 2$. Prove that $G$ is $k$-transitive if and only if $G_i$ acts $k-1$-transitively on $\{1,\ldots,n\} \setminus \{i\}$.
 \ee
 }
 \begin{proof}
 \item[(a)] Suppose that $G$ is doubly transitive. If  $j,k\in \{1,\ldots,n\} \setminus \{i\}$, as $i \ne j, i\ne k$, there exists $\sigma \in G$ such that $\sigma(i) = i, \sigma(j) = k$, so that $\sigma \in G_i$  and $\sigma(j) = k$. This proves that $G_i$ acts transitively on $\{1,\ldots,n\} \setminus \{i\}$.
 
 Conversely, suppose that $G_i$ acts transitively on $\{1,\ldots,n\} \setminus \{i\}$ for some $i \in \{1,\ldots,n\}$.
We first show that $G_{i'}$ acts also transitively on $\{1,\ldots,n\} \setminus \{i'\}$ for all $i' \in \{1,\ldots,n\}$. 

First, since $G$ is transitive, there is some $\tau \in G$ such that $\tau(i) = i'$.

Let $j' , k' \in \{1,\ldots,n\} \setminus \{i'\}$, and define $j = \tau^{-1}(j'), k = \tau^{-1}(k')$. Then $j \ne i, k \ne i$, otherwise $j'= i'$ or $k' =i'$.
Then the hypothesis gives $\sigma \in G_i$ such that $\sigma(j) =k$, that is $\sigma(\tau^{-1}(j')) =\tau^{-1}(k')$.

Therefore
\begin{align*}
(\tau \sigma \tau^{-1})(i') &= i'\\
(\tau \sigma \tau^{-1})(j') &= k',
\end{align*}
 which shows that $\sigma'  = \tau \sigma \tau^{-1}\in G_{i'}$ satisfies $\sigma'(j') = k'$, thus $G_{i'}$ acts transitively on $\{1,\ldots,n\} \setminus \{i'\}$, and this is true for all $i'$.

Now we prove that $G$ is doubly transitive. Let $(r,s),(r',s'),r\ne s, r'\ne s'$ be pairs of distinct elements of $\{1,\ldots,n\}$. 	
Since $G_{r}$ acts transitively on $\{1,\ldots,n\} \setminus \{r\}$, and $r\ne s$, there exists $\sigma_1 \in G_r$ such that $\sigma_1(r) = r, \sigma_1(s) = s'$. Note that $r \ne s'$, otherwise $\sigma_1(r) = \sigma_1(s) ,r\ne s$, which is impossible since $\sigma_1$ is a permutation. Thus there exists $\sigma_2 \in G_{s'}$ such that $\sigma_2(r) = r', \sigma_2(s') = s'$, where $r'\ne s'$. Then $\sigma = \sigma_2\sigma_1$ satisfies $\sigma(r) = r', \sigma(s) = s'$. This proves that $G$ is doubly transitive.

\item[(b)] Suppose first that $G$ is $k$ transitive, and let $(i_1,\ldots,i_{k-1}), (j_1,\ldots,j_{k-1})$ be any ${(k-1)}$-tuples of distinct elements of $\{1,\ldots,n\}\setminus \{i\}$. Then $(i, i_1,\ldots,i_{k-1}), (i, j_1,\ldots,j_{k-1})$ are $k$-tuples of distinct elements of $\{1,\ldots,n\}$, thus there is some $\sigma \in G$ such that $\sigma\cdot(i,i, i_1,\ldots,i_{k-1}) = (i, j_1,\ldots,j_{k-1})$, so that $\sigma \in G_i$ and $\sigma(i_1) = j_1,\ldots,\sigma(i_{k-1}) = j_{k-1}$. This proves that $G_i$ acts $(k-1)$-transitively on $\{1,\ldots,n\} \setminus \{i\}$.

Conversely, suppose that $G_i$ acts $(k-1)$-transitively on $\{1,\ldots,n\} \setminus \{i\}$ for some $i \in \{1,\ldots,n\}$. As in part (a), we first show that $G_{i'}$ acts $(k-1)$-transitively on $\{1,\ldots,n\} \setminus \{i'\}$ for all $i' \in \{1,\ldots,n\}$, using a permutation $\tau \in G$ satisfying $\tau(i) = '$. Take $(i'_1,\ldots,i'_{k-1}), (j'_1,\ldots,j'_{k-1})$ two $(k-1)$-tuples of distinct elements in $\{1,\ldots,n\} \setminus \{i'\}$. We define $i_l= \tau^{-1}(i'_l), j_l = \tau^{-1}(j'_l),\ l=1,\ldots,k-1$. Since $\tau^{-1}$ is a permutation, $(i,i_1,\ldots,i_{k-1})$ and $(i,j_1,\ldots,j_{k-1})$ are $k$-tuples of distinct elements. The hypothesis gives $\sigma \in G_i$ such that $\sigma(i_l) = j_l,\ l=1,\ldots,k-1$. Then $\sigma'= \tau \sigma \tau^{-1}$ satisfies
$$(\tau \sigma \tau^{-1})(i'_l) = j'_l,\ l=1,\ldots,k-1,\text { and } \sigma'(i') = i'.$$
Therefore $G_{i'}$ acts $(k-1)$-transitively on $\{1,\ldots,n\} \setminus \{i'\}$, for all $i' \in \{1,\ldots,n\}$.

Now let $(r_1,\ldots,r_k), (s_1,\ldots,s_k)$ be any $k$-tuples of distinct elements. There exists $\sigma_1 \in G_{r_k}$ such that
$$\sigma_1\cdot (r_1,\ldots,r_{k-1},r_k) = (s_1,\ldots,s_{k-1},r_k),$$
where $s_1,\ldots,s_{k-1},r_k$ are distinct, since $r_k =s_i$ for some $i\ne k$ implies $\sigma_1^{-1}(r_k) = \sigma_1^{-1}(s_i)$, that is $r_k = r_i$, which is false. Thus there exists $\sigma_2  \in G_{s_1}$ such that
$$\sigma_2\cdot (s_1,s_2,\ldots,s_{k-1}, r_k) = (s_1,s_2,\ldots,s_{k-1},s_k).$$
Then $\sigma = \sigma_2\sigma_1$ satisfies $\sigma \cdot (r_1,\ldots,r_k) = (s_1,\ldots,s_k)$. This proves that $G$ is $k$-transitive.
 \end{proof}
\end{document}
