%&LaTeX
\documentclass[11pt,a4paper]{article}
\usepackage[frenchb,english]{babel}
\usepackage[applemac]{inputenc}
\usepackage[OT1]{fontenc}
\usepackage[]{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{tikz}
%\input{8bitdefs}

% marges
\topmargin 10pt
\headsep 10pt
\headheight 10pt
\marginparwidth 30pt
\oddsidemargin 40pt
\evensidemargin 40pt
\footskip 30pt
\textheight 670pt
\textwidth 420pt

\def\imp{\Rightarrow}
\def\gcro{\mbox{[\hspace{-.15em}[}}% intervalles d'entiers 
\def\dcro{\mbox{]\hspace{-.15em}]}}

\newcommand{\be} {\begin{enumerate}}
\newcommand{\ee} {\end{enumerate}}
\newcommand{\deb}{\begin{eqnarray*}}
\newcommand{\fin}{\end{eqnarray*}}
\newcommand{\ssi} {si et seulement si }
\newcommand{\D}{\mathrm{d}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\U}{\mathbb{U}}
\newcommand{\re}{\,\mathrm{Re}\,}
\newcommand{\im}{\,\mathrm{Im}\,}
\newcommand{\ord}{\mathrm{ord}}
\newcommand{\Gal}{\mathrm{Gal}}
\newcommand{\legendre}[2]{\genfrac{(}{)}{}{}{#1}{#2}}

\title{Solutions to David A.Cox  "Galois Theory''}

\refstepcounter{section} \refstepcounter{section} \refstepcounter{section} \refstepcounter{section}
\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}
\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}\refstepcounter{section}

\begin{document}


\section{Chapter 13 : LAGRANGE, COMPUTING GALOIS GROUPS}

\subsection{QUARTIC POLYNOMIALS}
\paragraph{Ex. 13.1.1}

{\it Let $f \in F[x]$ be separable of degree $n$, and let $\alpha_1,\ldots,\alpha_n$ be the roots of $f$ in a splitting field $F\subset L$ of $f$. In Section 6.3 we used the action of the Galois group on the roots to construct a one-to-one group homomorphism $\phi_1:\Gal(L/F) \to S_n$. Now let $\beta_1,\ldots,\beta_n$ be the same roots, possibly written in a different order. This gives $\phi_2 : Gal(L/F) \to S_n$. To relate $\phi_1$ and $\phi_2$, note that there is $\gamma \in S_n$ such that $\beta_i = \alpha_{\gamma(i)}$ for $1\leq i \leq n$. Now define the conjugation map $\hat{\gamma}:S_n \to S_n$ by $\hat{\gamma}(\tau) = \gamma^{-1} \tau \gamma$.
\be
\item[(a)] Prove that $\phi_2 = \hat{\gamma} \circ \phi_1$.
\item[(b)] Let $G \subset S_n$ be the image of $\phi_1$. Explain why part (a) justifies the assertion made in the text that "if we change the labels, then $G$ gets replaced with a conjugate subgroup".
\ee
}

\begin{proof}
\be
\item[(a)]
By definition of the isomorphism $\phi_1 : \Gal(L/F) \to S_n$ in Section 6.3, if $\tau_1 = \phi_1(\sigma)$, then 
\begin{align}
\sigma(\alpha_i) = \alpha_{\tau_1(i)},\qquad i=1,\ldots,n.\label{eq:1}
\end{align}
As $\beta_1,\ldots,\beta_n$ are the same roots in a different order, there exists a permutation $\gamma \in S_n$ such that
\begin{align}
\beta_i = \alpha_{\gamma(i)},\qquad i=1,\ldots,n.\label{eq:2}
\end{align}
This numbering of the roots is associate to the isomorphism $\phi_2$. If $\tau_2 = \phi_2(\sigma)$, then 
\begin{align}
\sigma(\beta_i) = \beta_{\tau_2(i)}, \qquad i=1,\ldots,n.\label{eq:3}
\end{align}
Therefore, for all $i=1,\ldots,n$, using \eqref{eq:2}, \eqref{eq:3}, and \eqref{eq:2} again,
\begin{align}
\sigma(\alpha_{\gamma(i)} )&= \sigma(\beta_i)  = \beta_{\tau_2(i)} = \alpha_{\gamma(\tau_2(i))}.\label{eq:4}
\end{align}
Now, with the substitution $i \to \gamma(i)$ in \eqref{eq:1}, we get
\begin{align}
\sigma(\alpha_{\gamma(i)}) &= \alpha_{\tau_1(\gamma(i))}.\label{eq:5}
\end{align}
Thus , by \eqref{eq:4},\eqref{eq:5}, $\alpha_{\gamma(\tau_2(i))} = \alpha_{\tau_1(\gamma(i))}$ for all $i$. Since $i \mapsto \alpha_i$ is one-to-one,
$$\gamma(\tau_2(i)) = \tau_1(\gamma(i)),\qquad i=1,\ldots,n,$$
so
$$\gamma  \tau_2 = \tau_1 \gamma.$$
Therefore $\tau_2 = \gamma^{-1} \tau_1 \gamma$, so  $\phi_2(\sigma) = \hat{\gamma}(\phi_1(\sigma))$, for all $\sigma \in \Gal(L/F)$:
$$\phi_2 = \hat{\gamma} \circ \phi_1.$$
\item[(b)] Let $G$ the image of $\phi_1$ in $S_n$: $G = \{\phi_1(\sigma)\ | \ \sigma \in \Gal(L/F)\} \subset S_n$. 

Similarly the image of $\phi_2$ is $G' = \{\phi_2(\sigma)\ | \ \sigma \in \Gal(L/F)\} \subset S_n$. 

Since $\phi_2(\sigma) = \gamma^{-1} \phi_1(\sigma) \gamma$ for all $\sigma \in \Gal(L/F)$ by part (a),
$$G' = \gamma^{-1} G \gamma.$$
So, if we change the labels, then $G$ gets replaced with a conjugate subgroup.
\ee
\end{proof}

\paragraph{Ex. 13.1.2}

{\it Prove that $A_4$ is the only subgroup of $S_4$ with 12 elements.
}

\begin{proof}
Let $H$ a subgroup of $S_n$ such that $[S_n:H]=2$. Then $H$ is normal in $S_n$ (by Exercise 12.1.20). Thus $S_n/H \simeq \{1,-1\}$. So there exists a group homomorphism 
$$\varphi:S_n \to \{1,-1\}, \qquad \text{with }\ker(\varphi) = H.$$

Any two transpositions $\tau_1 = (a\, b), \tau_2 = (c\, d)$ of $S_n$ are conjugate: if $\gamma = (a \, c)(b\,  d)$, then $\tau_2 = \gamma \tau_1 \gamma^{-1}$ (even if $b=c$).

Since  $ \{1,-1\} \simeq \Z/2\Z$ is abelian,
\begin{align*}
\varphi(\tau_2)  &= \varphi(\gamma) \varphi(\tau_1) \varphi(\gamma)^{-1}\\
&=  \varphi(\gamma) \varphi(\gamma)^{-1} \varphi(\tau_1) \\
&= \varphi(\tau_1)
\end{align*}
So $\tau_1, \tau_2 \in H$, or  $\tau_1, \tau_2 \in S_n  \setminus H$.

If $\tau_1, \tau_2$ are in $S_n\setminus H$, then $\varphi(\tau_1\tau_2) = \varphi(\tau_1)\varphi(\tau_2) = (-1)\times (-1) = 1$, so $\tau_1 \tau_2 \in H$. In both cases 
$\tau_1 \tau_2 \in H$. 

Since every permutation $\sigma$ of $A_n$ is the product of an even number of transpositions, $\sigma \in H$, so $A_n \subset H$. As $|A_n| = |H | = n!/2$, $H = A_n$.

$A_n$ is the only subgroup of $S_n$ with $n!/2$ elements.
\end{proof}

\paragraph{Ex. 13.1.3}

{\it Explain carefully why (13.6) follows from Exercise 9 of section 2.4.
}

\begin{proof}
By definition, 
$$y_1 = x_1x_2+x_3x_4, \qquad y_2 = x_1x_3+x_2x_4,\qquad y_3 = x_1x_4+x_2x_3.$$
By Exercise 2.4.9, we know that
$$\Delta(\theta) = (y_1-y_2)^2(y_1-y_3)^2(y_2-y_3)^2
=[(x_1-x_4)(x_2-x_3)(x_1-x_3)(x_2-x_4)(x_1-x_2)(x_3-x_4)]^2
=\Delta
$$
As the evaluation is a ring homomorphism, if we applied the evaluation defined by $x_1 \mapsto \alpha_1,\ldots,x_4\mapsto \alpha_4$ to this equality in $F[x_1,x_2,x_3,x_4]$, we obtain
that the roots
$$\beta_1 = \alpha_1\alpha_2+\alpha_3\alpha_4, \qquad \beta_2 = \alpha_1\alpha_3+\alpha_2\alpha_4,\qquad \beta_3 = \alpha_1\alpha_4+\alpha_2\alpha_3,$$
are the images of $y_1,y_2,y_3$ and satisfy
\begin{align*}
\Delta(\theta_f) &= (\beta_1-\beta_2)^2(\beta_1-\beta_3)^2(\beta_2-\beta_3)^2\\
&=[(\alpha_1-\alpha_4)(\alpha_2-\alpha_3)(\alpha_1-\alpha_3)(\alpha_2-\alpha_4)(\alpha_1-\alpha_2)(\alpha_3-\alpha_4)]^2\\
&=\Delta(f)
\end{align*}
\end{proof}

\paragraph{Ex. 13.1.4}

{\it Use Example 7.3.4 from Chapter 7 to show that (13.8) gives all subgroups of $\langle (1\,3\,2\,4), (1\,2)\rangle$ of order 4 or 8.
}

\begin{proof}
We obtain all subgroups of $D_8  \simeq \langle \sigma,\tau \rangle$, where $\sigma =  (1\,3\,2\,4), \tau = (1\,2)$, in Exercise 7.3.3

\begin{center}
\begin{tikzpicture}
    \node (n0) at (7,6) {$\{e\}$};
    \node (n1) at (1,4) {$\langle \tau \rangle$};
    \node (n2) at (4,4) {$\langle  \sigma^2 \tau \rangle$};
    \node (n3) at (7,4) {$\langle\sigma^2\rangle$};
    \node (n4) at (10,4) {$\langle  \sigma \tau\rangle$};
    \node (n5) at (13,4) {$\langle \sigma^3 \tau\rangle$};
    \node (n6) at (4,2) {$\langle \sigma^2, \tau \rangle$};
    \node (n7) at (7,2) {$\langle \sigma \rangle$};
    \node (n8) at (10,2) {$\langle \sigma^2, \sigma  \tau  \rangle$};
    \node (n9) at (7,0) {$G = \langle \sigma,\tau\rangle$};
    \draw[->] (n0) edge (n3) edge (n2) edge (n1) edge (n4) edge (n5);
    \draw[<-] (n6) edge (n1) edge (n2) edge (n3);
    \draw[<-] (n8) edge (n3) edge (n4) edge (n5);
    \draw[->] (n3) edge (n7);
    \draw[<-] (n9) edge (n6) edge (n7) edge (n8);
\end{tikzpicture}
\end{center}

If $G$ is a subgroup of order 4 or 8, then $G$ is one of the four groups
$$\langle \sigma^2, \tau \rangle, \quad \langle \sigma \rangle,\quad \langle \sigma^2, \sigma  \tau  \rangle, \quad \langle \sigma,\tau\rangle,$$
Moreover $\sigma^2 = (1\,2)(3\,4)$ and $\sigma \tau = (1\,4)(2\,3)$, so 
$$\langle \sigma^2, \tau \rangle = \langle (1\,2)(3\,4), (1\,2) \rangle =  \langle (3\,4), (1\,2) \rangle,$$
and
$$\langle \sigma^2, \sigma  \tau  \rangle = \langle (1\,2)(3\,4),  (1\,4)(2\,3) \rangle =  \langle (1\,2)(3\,4),  (1\,3)(2\,4) \rangle$$
is the group of double transpositions $\{(), (1\,2)(3\,4), (1\,4)(2\,3), (1\,3)(2\,4)\}$.

Therefore $G$ is one of the four groups given in the text
$$\langle (1\,2),(3\,4) \rangle,\qquad  \langle (1\,2)(3\,4),  (1\,3)(2\,4) \rangle,\qquad  \langle (1\,3\,2\,4) \rangle, \qquad \langle (1\,3\,2\,4), (1\,2)  \rangle.$$
\end{proof}

\paragraph{Ex. 13.1.5}

{\it Let $F$ be a field of characteristic $\ne 2$, and let $g \in F[x]$ be a monic cubic polynomial that has a root in $F$. Prove that $g$ splits completely over $F$ if and only if $\Delta(g) \in F^2$.
}

\begin{proof}
Let $g = (x-\alpha_1)(x-\alpha_2)(x-\alpha_3)$, where $\alpha_1,\alpha_2,\alpha_3$ lie in some splitting field of $F$, and $\alpha_1 \in F$.
\be
\item[$\bullet$] If $g$ splits completely over $F$, then $\alpha_1,\alpha_2,\alpha_3$ lie in $F$, therefore 

${\delta = (\alpha_1 - \alpha_2)(\alpha_1-\alpha_3)(\alpha_2-\alpha_3) \in F}$, so
$\Delta(g)= \delta^2 \in F^2$.
\item[$\bullet$] Conversely, suppose that $\Delta(g) \in F^2$. Then $\Delta (g)= a^2, \ a \in F $, so $\delta =\pm a\in F$.
Since $\alpha_1 \in F$, the Euclidean division of $g(x)$ by $x-\alpha_1 \in F[x]$ gives 
$$g(x) = (x-\alpha_1)(x^2+px+q), \qquad p,q \in F.$$
Then $x^2+px+q = (x-\alpha_2)(x-\alpha_3)$, hence
$\alpha_2+\alpha_3 = -p \in F, \alpha_2\alpha_3 = q \in F$, and
$$(\alpha_1-\alpha_2)(\alpha_1 - \alpha_3) = \alpha_1^2  + p \alpha_1 +q \in F.$$
If $\alpha_1 = \alpha_2$, then $\alpha_3 = -p - \alpha_2 = -p - \alpha_1 \in F$, so $g$ splits completely over $F$, and similarly the same conclusion is true if $\alpha_1 = \alpha_3$. 

In the remaining case, $(\alpha_1-\alpha_2)(\alpha_1 - \alpha_3) \ne 0$, so
$$\alpha_2 - \alpha_3 = \delta [(\alpha_1-\alpha_2)(\alpha_1 - \alpha_3)]^{-1} \in F.$$
Since $\alpha_2 + \alpha_3 \in F$, and $\alpha_2 - \alpha_3 \in F$, and since the characteristic of $F$ is not 2,
$$\alpha_2 = \frac{1}{2}[(\alpha_2 + \alpha_3) +(\alpha_2-\alpha_3)] \in F, \alpha_3 = \frac{1}{2}[(\alpha_2 + \alpha_3) -(\alpha_2-\alpha_3)] \in F.$$
Therefore $g = (x-\alpha_1)(x-\alpha_2)(x-\alpha_3)$ splits completely over $F$.
\ee
\end{proof}

\paragraph{Ex. 13.1.6}

{\it This exercise is concerned with the proof of part (c) of Theorem 13.1.1. Let $f(x) = x^4-c_1x^3+c_2x^2-c_3x+c_4$ as in the theorem.
\be
\item[(a)] Suppose that $f$ has roots $\alpha_1,\alpha_2,\alpha_3,\alpha_4$ such that $\alpha_1+\alpha_2 - \alpha_3-\alpha_4 = \alpha_1\alpha_2 - \alpha_3 \alpha_4 = 0$. Prove that $f$ is not separable.
\item[(b)] Let $\beta$ be a root of the resolvent $\theta_f(y)$. Use part (a) to prove that $4\beta+c_1^2-4c_2$ and $\beta^2 - 4 c_4$ can't both vanish when $f$ is separable.
\item[(c)] Suppose that $4\beta+c_1^2-4c_2=0$ in part (c) of Theorem 13.1.1. Prove carefully that $G$ is conjugate to $\langle (1\,3\,2\,4),(1\,2) \rangle$ if and only if $\Delta(f)(\beta^2 - 4 c_4) \not \in (F^*)^2$.
\ee
}

\begin{proof}
\be
\item[(a)] If  $\alpha_1+\alpha_2 - \alpha_3-\alpha_4 = \alpha_1\alpha_2 - \alpha_3 \alpha_4 = 0$, then 
\begin{align*}
s &:= \alpha_1+\alpha_2 = \alpha_3+\alpha_4\\
p &:= \alpha_1\alpha_2 = \alpha_3\alpha_4
\end{align*}
Thus $x^2-sx+p = (x-\alpha_1)(x - \alpha_2) = (x-\alpha_3)(x-\alpha_4)$, therefore
$$\{\alpha_1,\alpha_2\} = \{\alpha_3,\alpha_4\}.$$
Since $\alpha_3 = \alpha_1$ or $\alpha_3 = \alpha_2$, $f$ is not separable.

\item[(b)] If $\beta$ is a root of the resolvent $\theta_f$, we can relabel the roots of $f$ so that $\beta = \alpha_1\alpha_2 + \alpha_3\alpha_4$ and
$$4 \beta + c_1^2-4c_2 = (\alpha_1+\alpha_2 - \alpha_3 - \alpha_4)^2.$$
Since $\beta^2 - 4c_4 = (\alpha_1\alpha_2 - \alpha_3\alpha_4)^2$, if $4\beta+c_1^2-4c_2$ and $\beta^2 - 4 c_4$ both vanish, then $\alpha_1+\alpha_2 - \alpha_2 - \alpha_4 =0$ and $\alpha_1\alpha_2 - \alpha_3\alpha_4=0$. Then, by part (a), $f$ is not separable.

Therefore $4\beta+c_1^2-4c_2$ and $\beta^2 - 4 c_4$ can't both vanish when $f$ is separable.

\item[(c)] Suppose that $4\beta + c_1^2-4c_2 = 0$ in part (c) of Theorem 13.1.1, where $\theta_f(y)$ has a unique root $\beta$ in $F$. We know that $f$ is separable by Lemme 5.3.5.

Therefore $\Delta(f) \ne 0$, and, by part (b), $\beta^2 - 4 c_4 \ne 0$, so
$$\Delta(f) (\beta^2 - 4 c_4) \ne 0.$$
We know that $G = \langle (1\,3\,2\,4)\rangle$ or $G = \langle (1\,3\,2\,4),(1,2)\rangle$.
\be
\item[$\bullet$] Suppose that $G = \langle (1\,3\,2\,4)\rangle$. Then $\Gal(L/F) = \langle \sigma\rangle$, where $\sigma$ corresponds to $(1\,3\,2\,4)$.
We choose
 $$\sqrt{\Delta(f) (\beta^2 - 4 c_4)} = \sqrt{\Delta(f)} (\alpha_1\alpha_2 - \alpha_3  \alpha_4).$$
Since $(1\,3\,2\,4) = (1\,3)(3\,2)(2\,4) \not \in A_4$, $\sigma ( \sqrt{\Delta(f)} )= - \sqrt{\Delta(f)}$, and
$$\sigma (\alpha_1\alpha_2 - \alpha_3  \alpha_4) = \alpha_3  \alpha_4 - \alpha_2 \alpha_1 = - (\alpha_1\alpha_2 - \alpha_3  \alpha_4).$$
Therefore $\sigma$ fixes $\sqrt{\Delta(f) (\beta^2 - 4 c_4)}$, so $\sqrt{\Delta(f) (\beta^2 - 4 c_4)} \in F^*$, and $$\Delta(f) (\beta^2 - 4 c_4) \in (F^*)^2.$$
\item[$\bullet$] Suppose that  $G = \langle (1\,3\,2\,4),(1,2)\rangle$. Then $\Gal(L/F) = \langle \sigma, \tau \rangle$, where $\tau$ corresponds to $(1\,2)$.
$\tau ( \sqrt{\Delta(f)} )= - \sqrt{\Delta(f)}$ and $\tau (\alpha_1\alpha_2 - \alpha_3  \alpha_4) = \alpha_2\alpha_1 - \alpha_3  \alpha_4 = \alpha_1\alpha_2 - \alpha_3  \alpha_4$, so
$\tau(\sqrt{\Delta(f) (\beta^2 - 4 c_4)}) = -\sqrt{\Delta(f) (\beta^2 - 4 c_4)}$. Since the characteristic is not 2, and $\Delta(f) (\beta^2 - 4 c_4) \ne 0$,$\sqrt{\Delta(f) (\beta^2 - 4 c_4)} \not \in F$, so 
$$\Delta(f) (\beta^2 - 4 c_4) \not \in (F^*)^2.$$
Therefore $G$ is conjugate to $\langle (1\,3\,2\,4),(1\,2) \rangle$ if and only if $\Delta(f)(\beta^2 - 4 c_4) \not \in (F^*)^2$.
\ee
\ee
\end{proof}

\paragraph{Ex. 13.1.7}

{\it In Exercise 18 of section 12.1 you found the roots of $f = x^4+2x^2-4x+2 \in \Q[x]$ using the formula developed in that section. At the end of the exercise, we said that "this quartic is especially simple". Justify this assertion using Theorem 13.1.1
}

\begin{proof}
By Exercise 12.1.18,
$$\theta_f(y) = y^3 - 2y^2-8y = y(y-4)(y+2).$$
Moreover $f$ is irreducible over $\Q$ (from the instruction {\bf f.is\_irreducible()} in Sage).

Since $\theta_f(y)$ splits completely over $F$, by Theorem 13.1.1,
$$G = \langle(1\,2)(3\,4),(1\,3)(2\,4) \rangle \simeq \Z/2\Z \times \Z/2\Z.$$

(This result was already proved in Exercise 12.1.18, since the splitting field of $f$ is $\Q(i,\sqrt{2})$.)
\end{proof}

\paragraph{Ex. 13.1.8}

{\it In Example 10.3.10, we showed that the roots of $f=7m^4 - 16 m^3 -21 m^2 + 8m+4 \in \Q[m]$ can be constructed using origami. Show that the splitting field of $f$ is an extension of $\Q$ of degree 24. By the results of Section 10.1, it follows that the roots of $f$ are not constructible with straightedge and compass, since $24$ is not a power of $2$.
}

\begin{proof}
The discriminant of $g = \frac{1}{7} f$  is 
$$\Delta(g) = \frac{174446784}{117649} = 2^6\cdot 3^6\cdot 3739\cdot 7^{-6},$$
so $\Delta(g)$ is not a square in $\Q$.

The Ferrari resolvent is
$$\theta_f(y) = y^{3} + 3 y^{2} - \frac{240}{49} y - \frac{3824}{343}.$$

and $$7^3 \theta_f(y) = 343 y^{3} + 1029 y^{2} - 1680 y - 3824$$
has no root in $\Q$, so is irreducible over $\Q$.

By theorem 13.1.1, $G = S_4$.
Therefore the splitting field $L$ of $f$ has degree
$$[L:\Q] = |G| = 24.$$

\bigskip

Sage instructions :
\begin{verbatim}
var('m')
R.<m> = QQ[m]
f= 7*m^4-16*m^3-21*m^2+8*m+4
g=f/7
d=g.discriminant()
d.factor()
\end{verbatim}
$$2^{6} \cdot 3^{6} \cdot 7^{-6} \cdot 3739$$
\begin{verbatim}
R.<y> = QQ[]
l = f.coefficients(sparse=False);
c1 = -l[3]/l[4]; c2 = l[2]/l[4];c3 = -l[1]/l[4]; c4 = l[0]/l[4];
theta_f = y^3 -c2*y^2 +(c1*c3-4*c4)*y - c3^2-c1^2*c4 + 4*c2*c4;
\end{verbatim}
$$y^{3} + 3 y^{2} - \frac{240}{49} y - \frac{3824}{343}$$
\begin{verbatim}
theta_f.is_irreducible()
\end{verbatim}
$$\text{True}$$
\end{proof}

\paragraph{Ex. 13.1.9}

{\it As in Example 13.1.3, let $f = x^4+ax^3+bx^2+ax+1 \in F[x]$, and let $\alpha$ be a root of $f$ in some splitting field of $f$ over $F$. Show that $\alpha^{-1}$ is also a root of $f$, and then use (13.5) to conclude that 2 is a root of the resolvent $\theta_f(y)$.
}

\begin{proof}
If $\alpha$ is a root of $f$ in some splitting field $L$ of $F$, then $ \alpha^4+a\alpha^3+b\alpha^2+a\alpha+1 = 0$. If we divide by $\alpha^4$, we obtain
$1 + a \alpha^{-1} + b \alpha^{-2} + a\alpha^{-3} + \alpha^{-4}$, so $f(\alpha^{-1})=0$.
Note that
\begin{align*}
x^4+ax^3+bx^2+ax+1 &= x^2\left[ \left(x^2+\frac{1}{x^2} \right) + a \left( x + \frac{1}{x} \right) + b \right]\\
&=x^2\left[ \left(x+\frac{1}{x} \right)^2 + a \left( x + \frac{1}{x} \right) + b -2 \right]\\
\end{align*}
As $0$ is not a root of $f$, the roots of $f$ are the roots of  $z = x+\frac{1}{x}$, where $z$ is a root of $z^2+az+b-2$, so the roots of $f$ are the roots of the two polynomials
$$x^2-z_1x+1,\qquad x^2 -z_2x+1,$$
where $z_1,z_2$ are the roots in $L$ of
$$z^2+az+b-2.$$
If we relabel the roots so that $\alpha_1,\alpha_2$ are the roots of $x^2-z_1x+1$, and $\alpha_3,\alpha_4$ the roots of $x^2 -z_2x+1$, then $\alpha_1\alpha_2 = 1, \alpha_3\alpha_4 = 1$,
therefore $\beta_1 = \alpha_1\alpha_2+ \alpha_3\alpha_4 = 2$ is a root of the Ferrari resolvent $\theta_f(y)$.
\end{proof}

\paragraph{Ex. 13.1.10}

{\it As in Example 13.1.4, let $f=x^4+bx^2+d \in F[x]$, where $d \not \in F^2$. Compute $\Delta(f)$ and $\theta_f(y)$.
}

\begin{proof}
The discriminant of $f$ is
$$\Delta(f) =  16 b^{4} d - 128 b^{2} d^{2} + 256 d^{3} = 16\  d\,  ( b^{2} - 4 d)^{2}.$$
The Ferrari resolvent is
$$\theta_f(y) = y^3-by^2-4dy+4bd = (y-b)(y^2-4d).$$

Sage instructions:
\begin{verbatim}
R.<x,b,d> = QQ[]
f=x^4+b*x^2+d
c1 = 0; c2 = b; c3 = 0; c4 = d;
theta_f = x^3 - c2*x^2 + (c1*c3-4*c4)*x - c3^2-c1^2*c4 + 4*c2*c4;
factor(theta_f)
\end{verbatim}
$$(- x + b) \cdot (- x^{2} + 4 d)$$
\begin{verbatim}
Delta = theta_f.discriminant(x)
factor(Delta)
\end{verbatim}
$$	
\left(16\right) \cdot d \cdot (- b^{2} + 4 d)^{2}
$$
Thus $\theta_f(y) = (y-b)(y - 2\sqrt{d})(y+2\sqrt{d})$ has a unique root in $F$ if $d \not \in F^2$, and the discriminant is not a square in $F^2$.
\end{proof}

\paragraph{Ex. 13.1.11}

{\it In Example 13.1.7 we showed that if $f=x^4+ax^3+bx^2+ax+1 \in \Z[x]$ is irreducible over $\Q$, then its Galois group is $\Z/2\Z \times \Z/2\Z$ if and only if there is $c \in \Q$ such that $4a^2+c^2 = (b+2)^2$.
\be
\item[(a)] Show that $c\in \Z$, and use the irreducibility of $f$ to prove that $c\ne 0$. Hence we may assume that $c>0$, so that $(2a,c,b+2)$ is a Pythagorean triple.
\item[(b)] Show that $3^2+4^2 = 5^2, 5^2+12^2 = 13^2, 7^2 + 24^2 = 25^2$, and $8^2 + 15^2 = 17^2$ give two examples of polynomials with $\Z/2\Z \times \Z/2\Z$ as Galois group (two of the triples give reducible polynomials).
\ee
}

\begin{proof}
\be
\item[(a)]  $c \in \Q$ is such that $c^2 = n \in \Z$. Write $c =a/b, b>0, a\wedge b = 1$. Then $a^2 = n b^2$. If $b\ne 1$, there is a prime $p$ such that $p\mid b$. But then $p\mid a^2$, thus $p\mid a$, in contradiction with $a\wedge b = 1$. So $c \in \Z$.

If $c = 0$, then $(b+2)^2 = 4a^2$, so $b+2 =   2\varepsilon a$, $ b = -2+ 2 \varepsilon a$ , where $\varepsilon = \pm 1$.

In Exercise 9, we saw that
$$f=  x^4+ax^3+bx^2+ax+1 = (x^2-z_1x+1)(x^2 - z_2x+ 1),$$
where $z_1,z_2$  are the roots of $ z^2+az+b-2.$
Here $b = -2+2\varepsilon a$, so $z_1,z_2$ are the roots of $$z^2 +az -4+2\varepsilon a = (z+a-2\varepsilon)(z+2\varepsilon),$$
so
$$z_1 = -a+2\varepsilon \in \Z,\qquad  z_2 = -2 \varepsilon \in \Z,$$
so $f$ is not irreducible over $\Q$, in contradiction with the hypothesis.
We have proved that $c\ne 0$ if $f$ is irreducible, and so $(2a,c,b+2)$ is a Pythagorean triple.

\item[(b)] 
$3^2+4^2 = 5^2$ gives $a=2, b =3$, and $f = x^4+2x^3+3x^2+2x+1 = (x^2+x+1)^2$ is not irreducible.

$5^2+12^2 = 13^2$ gives $a=6, b = 11$, and $f =  x^4+6x^3+11x^2+6x+1 = (x^2+3x+1)^2$ is not irreducible.

$7^2 + 24^2 = 25^2$ gives $a=12,b=23$, and $f= x^4 + 12x^3+23x^2+12x+1$ which is irreducible. So the Galois group of 
$$f= x^4 + 12x^3+23x^2+12x+1$$
is isomorphic to $\Z/2\Z \times \Z/2\Z$.

Verification with Sage:
\begin{verbatim}
R.<x> = QQ[]
f= x^4 + 12*x^3 + 23*x^2 + 12*x + 1
f.is_irreducible()
\end{verbatim}
\begin{center}
True
\end{center}
\begin{verbatim}
G = f.galois_group()
G.gens()
\end{verbatim}
$$ [(1,2)(3,4), (1,4)(2,3)]$$
\begin{verbatim}
G.structure_description()
\end{verbatim}
$$C2 \times C2$$
\ee
\end{proof}

$8^2 + 15^2 = 17^2$ gives $a=4, b = 15$, and $f = x^4 + 4 x^3 + 15 x^2 + 4x+1$, which is irreducible.
The Galois group of 
$$f = x^4 + 4 x^3 + 15 x^2 + 4x+1$$
is isomorphic to $\Z/2\Z \times \Z/2\Z$.

Note: the polynomial associate to $7^2 + 24^2 = 25^2$ is 
\begin{align*}
f&= x^4 + 12x^3+23x^2+12x+1\\
&= (x^2+6x+1)^2 - 15x^2\\
&= (x^2+(6+\sqrt{15}) x +1) (x^2 + (6-\sqrt{15}) x +1)
\end{align*}
The discriminant of the first factor is $\Delta_1 = 47 + 12 \sqrt{15}$ and the discriminant of the second is $\Delta_2 = 47 - 12 \sqrt{15}$.
Since
$$\left(\sqrt{47 + 12 \sqrt{15}}\right)\left(\sqrt{47 -  12 \sqrt{15}}\right) = \sqrt{47^2 - 144 \times 15} = \sqrt{49} = 7 \in \Q^*),$$
the splitting field of $f$ over $\Q$ is $\Q\left (\sqrt{47 + 12 \sqrt{15}}\right)$, which is a quadratic extension of a quadratic extension. The minimal polynomial of $a = \sqrt{47 + 12 \sqrt{15}}$ is $x^4-94x^2+49$, whose Galois group is also $\Z/2\Z \times \Z/2\Z$ (here $d=49$ is a square).

\paragraph{Ex. 13.1.12}

{\it This exercise is concerned with the proof of Proposition 13.1.5.
\be
\item[(a)] Prove (13.12).
\item[(b)] Prove that the two polynomials $h_1$ and $h_2$ defined in the proof of the proposition factor as $h_1 = (y-(\alpha_1+\alpha_2))(y-(\alpha_3+\alpha_4))$ and $h_2 = (y - \alpha_1\alpha_2)(y-\alpha_3\alpha_4)$.
\ee
}

\begin{proof}
\be
\item[(a)] Let $g = y^2+Ay+B \in F[y]$ and let $F \subset F(\sqrt{a}),\ a \in F$, be a quadratic extension.

If $\Delta(g) = 0$ then $a\Delta(g) = 0 \in F^2$. Suppose now that $g$ is irreducible over $F$.
\be
\item[$\bullet$] Suppose that $g$ splits completely over $F(\sqrt{a})$, so
$$g = (y-y_1)(y-y_2),\qquad y_1,y_2\in F(\sqrt{a}).$$
Then $\Delta(g) = (y_1-y_2)^2 = A^2 - 4B \in F$. We choose $\sqrt{\Delta(g)} = y_2-y_1 \in F(\sqrt{a})$.
Here $\deg(g) =2$, and $g$ is irreducible over $F$, therefore the roots of $g$
\begin{align*}
y_1 &= \frac{1}{2}((y_1+y_2) + (y_1-y_2)) = \frac{1}{2} \left(-A - \sqrt{\Delta(g)}\right),\\
 y_2 &= \frac{1}{2}((y_1+y_2) - (y_1-y_2 ))= \frac{1}{2} \left (-A + \sqrt{\Delta(g)}\right),
 \end{align*}
are not in $F$, and this is equivalent to
$$\sqrt{\Delta(g)} \not \in F.$$
Since $ \sqrt{\Delta(g)} \in F(\sqrt{a})$, and $\sqrt{\Delta(g)} \not \in F$,
$$\sqrt{\Delta(g)} = u + v\sqrt{a},\qquad u,v \in F,\qquad v\ne 0.$$
Therefore 
\begin{align*}
u^2 &= \left(\sqrt{\Delta(g)}  - v\sqrt{a}\right)^2\\
&=\Delta(g) + a v^2 - 2v\sqrt{a}\sqrt{\Delta(g)} 
\end{align*}
Since $v\ne 0$, and $\mathrm{char}(F) \ne 2$,
$$\sqrt{a} \sqrt{\Delta(g)}  = \frac{\Delta(g) + a v^2-u^2}{2v} \in F,$$
so 
$$a\Delta(g) \in F^2.$$
\item[$\bullet$] Conversely, suppose that $a\Delta(g) \in F^2$. Here $a\ne 0$ since $F(\sqrt{a})$ is a quadratic extension of $F$.
There exists $w \in F$ such that $a\Delta(g) =w^2$. 

We choose $\sqrt{\Delta(g)}$ such that
  $$\sqrt{\Delta(g)} =  \frac{w}{\sqrt{a}}  = \frac{w}{a} \sqrt{a} \in F(\sqrt{a}).$$
  Then 
  \begin{align*}
y_1 &= \frac{1}{2}((y_1+y_2) + (y_1-y_2)) = \frac{1}{2} \left(-A - \sqrt{\Delta(g)}\right),\\
 y_2 &= \frac{1}{2}((y_1+y_2) - (y_1-y_2 ))= \frac{1}{2} \left (-A + \sqrt{\Delta(g)}\right),
 \end{align*}
 are in $F(\sqrt{a})$, so $g = (y-y_1)(y-y_2)$ splits completely over $F(\sqrt{a})$.
 
 Finally, if $\Delta(g) = 0$, $g = (y-y_0)^2$, where $y_0 = -A/2 \in F$, splits completely over $F$, a fortiori over $F(\sqrt{a})$.
\ee
Conclusion: 

Let $g = y^2 + Ay+B$ and $F(\sqrt{a})$ a quadratic extension of $F$, with $\mathrm{char}(F) \ne 2$. 
If $\Delta(g)=0$, or if $g$ is irreducible over $F$, then
$$ g \text{ splits completely over } F(\sqrt{a}) \iff a\Delta(g) \in F^2.$$
\item[(b)]
\begin{align*}
&(y-(\alpha_1+\alpha_2))(y-(\alpha_3+\alpha_4))\\
&= y^2 -(\alpha_1+\alpha_2+\alpha_3+\alpha_4)y + (\alpha_1\alpha_3+\alpha_1\alpha_4+\alpha_2\alpha_3+\alpha_2\alpha_4)\\
&= y^2 - c_1y + (\alpha_1\alpha_2 + \alpha_1\alpha_3 + \alpha_1 \alpha_4 + \alpha_2 \alpha_3+\alpha_2\alpha_4+\alpha_3\alpha_4) - (\alpha_1\alpha_2+\alpha_3\alpha_4)\\
&= y^2 -c_1 y +c_2 - \beta,
\end{align*}
so
$$h_1 =  y^2 -c_1 y +c_2 - \beta = (y-(\alpha_1+\alpha_2))(y-(\alpha_3+\alpha_4)).$$
Similarly
\begin{align*}
&(y-\alpha_1\alpha_2)(y-\alpha_3\alpha_4)\\
&=y^2 - (\alpha_1\alpha_2+\alpha_3\alpha_4) y +\alpha_1\alpha_2\alpha_3\alpha_4\\
&=y^2 - \beta y +c_4
\end{align*}
so
$$h_2 = y^2 - \beta y +c_4 = (y-\alpha_1\alpha_2)(y-\alpha_3\alpha_4).$$
\ee
We have proved that $h_1,h_2$ split completely over $L$. Since $\deg(h_1) = 2$, $h_1$ splits over a quadratic extension $F\subset M$, with  $M \subset L$. But the unique such quadratic extension is $F(\sqrt{\Delta(f)})$ (since $\Gal(L/F) \simeq \Z/4\Z$ has a unique subgroup of index 2). Therefore $M =  F(\sqrt{\Delta(f)})$, and $h_1$ splits completely over $F(\sqrt{\Delta(f)})$, and also $h_2$.
\end{proof}

\paragraph{Ex. 13.1.13}

{\it Suppose that $f \in F[x]$ satisfies the hypothesis of part (c) of Theorem 13.1.1, and let $\alpha$ be a root of $f$. Prove that $G \simeq \Z/4\Z$ if $f$ splits completely over $F(\alpha)$, and $G\simeq D_8$ otherwise. This gives a version of part (c) that doesn't use resolvents. Since we can factor over extension fields by Section 4.2, this method is useful in practice.
}

\begin{proof}
With the hypothesis of part (c), $\Delta(f) \not \in F^2$, so $\Delta(f) \ne 0$ and $f$ is separable.

\be
 \item[$\bullet$] If $G \simeq \Z/4\Z$, then 
$G = \langle \sigma \rangle \subset S_4$,  where $\sigma$ corresponds to $\tilde{\sigma} \in \Gal(L/F)$. Write $G_\alpha = \mathrm{Stab}_G(\alpha)$. Since $f$ is irreducible, ${\cal O}_\alpha = \{\alpha_1,\alpha_2,\alpha_3,\alpha_4\}$ is the set of the four roots of $f$, therefore $4 = |{\cal O}_\alpha| = (G: G_\alpha)$, so $G_{\alpha} = \{e\}$. Hence $\tilde{\sigma}^i(\alpha) \ne\tilde{\sigma}^j(\alpha)$ if $1\leq i < j \leq 4$.   We choose the numbering of the roots such that $\alpha_1 = \alpha$, and $\tilde{\sigma}(\alpha_1) = \alpha_3,\tilde{\sigma}(\alpha_3) = \alpha_2,\tilde{\sigma}(\alpha_2) = \alpha_4$ are the four distinct roots of $f$, so $\sigma = (1\,3\,2\,4)$.
$$f = (x-\alpha_1)(x-\alpha_3)(x-\alpha_2)(x-\alpha_4) = (x-\alpha)(x-\tilde{\sigma}(\alpha))(x-\tilde{\sigma}^2(\alpha))(x-\tilde{\sigma}^3(\alpha)).$$

As  $\Delta(f) \not \in F^2$,  $F(\sqrt{\Delta(f)})$ is a quadratic extension of $F$.

Since the only subgroup of $G$ are $\{e\} \subset H =\langle \sigma^2 \rangle \subset G = \langle \sigma \rangle$, by the Galois correspondence, the only intermediate fields of $F\subset L$ are $F \subset F(\sqrt{\Delta(f)})\subset L$, and the fixed field of $H = \langle \sigma^2 \rangle$ is $L_H =  F(\sqrt{\Delta(f)})$.

If $F(\alpha) \subset F(\sqrt{\Delta(f)})$, then $\alpha \in F(\sqrt{\Delta(f)}) = L_H$, therefore $\sigma^2(\alpha) = \alpha$, and so $\alpha_2 = \alpha_1$, in contradiction with the separability of $f$. Hence $F(\alpha) \not \subset F(\sqrt{\Delta(f)})$, so $$F(\alpha) = L = F(\alpha_1,\alpha_2,\alpha_3,\alpha_4).$$

Then $f$ splits completely over $F(\alpha)$.


 \item[$\bullet$] If $G \not \simeq \Z/4\Z$, then by Theorem 13.1.1, $G \simeq D_8$. Therefore $[L : F] = |G| = 8$, and $[F(\alpha) : F] = \deg(f) = 4$, which implies $F(\alpha) \ne L = F(\alpha_1,\alpha_2,\alpha_3,\alpha_4)$.
 Therefore one of the roots $\alpha_i$ is not in $F(\alpha)$, and so $f =(x-\alpha_1)(x-\alpha_2)(x-\alpha_3)(x-\alpha_4)$ doesn't splits completely over $F(\alpha)$.
\ee



Conclusion. Let $f$ be a quadratic polynomial, and let $\alpha$ be a root of $f$.

 If $\Delta(f) \not \in F^2$ and $\theta_f(y)$ is reducible over $F$, then
\begin{align*}
f \text { splits completely over } F(\alpha) &\iff \Gal_F(f) \simeq \Z/4\Z,\\
f \text { doesn't split completely over } F(\alpha) &\iff \Gal_F(f) \simeq D_8.
\end{align*}
\end{proof}

Example 1: $f = x^4-12x^2+18$ over $\Q$.
\begin{verbatim}
R.<x> = QQ[]
f = x^4-12*x^2 + 18
print(f.is_irreducible())
factor(f.discriminant()), f.discriminant().is_square()
\end{verbatim}
$$\text{True}$$
$$(2^{11} \cdot 3^6, \text{False}).$$
\begin{verbatim}
l = f.coefficients(sparse=False);
c1 = -l[3]/l[4]; c2 = l[2]/l[4];c3 = -l[1]/l[4]; c4 = l[0]/l[4];
S.<y> = QQ[]
theta_f = y^3 -c2*y^2 +(c1*c3-4*c4)*y - c3^2-c1^2*c4 + 4*c2*c4;
factor(theta_f)
\end{verbatim}
$$(y + 12) \cdot (y^{2} - 72)$$
\begin{verbatim}
K.<a>= NumberField(f)
S.<x> = K[]
f = x^4-12*x^2 + 18
factor(f)
\end{verbatim}
$$(x - a) \cdot (x + a) \cdot (x - \frac{1}{3} a^{3} + 3 a) \cdot (x + \frac{1}{3} a^{3} - 3 a)$$

These results prove that the Galois group of  $f = x^4-12x^2+18$ over $\Q$ is isomorphic to $\Z/4\Z$.
Verification with Sage:
\begin{verbatim}
R.<x> = QQ[]
f = x^4-12*x^2 + 18
f.galois_group().gens()
\end{verbatim}
$$ [(1,2,3,4)]$$
\begin{verbatim}
f.galois_group().structure_description()
\end{verbatim}
$$C4$$
\bigskip

Example 2: $f = x^4 - 2$ over $\Q$.
\begin{verbatim}
R.<x> = QQ[]
f = x^4-2
print(f.is_irreducible())
factor(f.discriminant()), f.discriminant().is_square()
\end{verbatim}
$$\text{True}$$
$$(-1\cdot 2^{11}, \text{False})$$
\begin{verbatim}
l = f.coefficients(sparse=False);
c1 = -l[3]/l[4]; c2 = l[2]/l[4];c3 = -l[1]/l[4]; c4 = l[0]/l[4];
S.<y> = QQ[]
theta_f = y^3 -c2*y^2 +(c1*c3-4*c4)*y - c3^2-c1^2*c4 + 4*c2*c4;
factor(theta_f)
\end{verbatim}
$$y \cdot (y^{2} + 8)$$
\begin{verbatim}
K.<a>= NumberField(f)
S.<x> = K[]
f = x^4-2
factor(f)
\end{verbatim}
$$(x - a) \cdot (x + a) \cdot (x^{2} + a^{2})$$
Thus the Galois group of $x^4 - 2$ over $\Q$ is $D_8$.
Verification with Sage:
\begin{verbatim}
R.<x> = QQ[]
f = x^4-2
f.galois_group().gens()
\end{verbatim}
$$ [(1,2,3,4), (1,3)]$$
\begin{verbatim}
f.galois_group().structure_description()
\end{verbatim}
$$D4$$
\bigskip

Example 3: $f = x^4-18x^2+9$ over $\Q$.
\begin{verbatim}
R.<x> = QQ[]
f = x^4-18*x^2 + 9
print(f.is_irreducible())
factor(f.discriminant()), f.discriminant().is_square()
\end{verbatim}
$$\text{True}$$
$$(2^{14}\cdot 3^6, \text{True})$$
\begin{verbatim}
l = f.coefficients(sparse=False);
c1 = -l[3]/l[4]; c2 = l[2]/l[4];c3 = -l[1]/l[4]; c4 = l[0]/l[4];
S.<y> = QQ[]
theta_f = y^3 -c2*y^2 +(c1*c3-4*c4)*y - c3^2-c1^2*c4 + 4*c2*c4;
factor(theta_f)
\end{verbatim}
$$	
(y - 6) \cdot (y + 6) \cdot (y + 18)
$$
The Galois group of $f = x^4-18x^2+9$ over $\Q$ is isomorphic to $\Z/2\Z \times \Z/2\Z$.
Verification with Sage:
\begin{verbatim}
R.<x> = QQ[]
f = x^4-18*x^2 + 9
f.galois_group().gens()
\end{verbatim}
$$ [(1,2)(3,4), (1,4)(2,3)]$$
\begin{verbatim}
f.galois_group().structure_description()
\end{verbatim}
$$C2 \times C2$$
\paragraph{Ex. 13.1.14}

{\it Use Theorem 13.1.1 to compute the Galois groups of the following polynomials in $\Q[x]$:
\be
\item[(a)] $x^4+4x+2$.
\item[(b)] $x^4 + 8x+12$.
\item[(c)] $x^4+1$.
\item[(d)] $x^4+x^3+x^2 + x+1$.
\item[(e)] $ x^4-2$.
\ee
}

\begin{proof}
\be
\item[(a)] $f = x^4+4x+2$.

$\Delta(f) = -2^8\cdot 19$ is  not a square in $\Q$, and $\theta_f(y) = y^3 -8y - 16$ is irreducible over $\Q$, so $\Gal_\Q(f) \simeq S_4$ (part (a) of Theorem 13.1.11).


\item[(b)] $f = x^4 + 8x+12$.

$\Delta(f) = 2^{12}\cdot 3^4$ is  a square in $\Q$, and $\theta_f(y) = y^3 -48y - 64$ is irreducible over $\Q$, so $\Gal_\Q(f) \simeq A_4$ (part (a) of Theorem 13.1.11).

\item[(c)] $f = x^4+1$.

$\Delta(f) = 2^8$ is a square in $\Q$ and $\theta_f(y) = y(y-2)(y+2)$ splits completely over $\Q$, so $\Gal_\Q(f) \simeq \Z/2\Z \times \Z/2\Z$  (part (b) of Theorem 13.1.11).

\item[(d)] $f = x^4 + x^3+x^2+x+1$.

$\Delta(f) = 5^3$ is not a square, and $\theta_f(y) = (y-2)(y^2+y+1)$ has a unique root in $\Q$, so part (c) of Theorem 13.1.1 applies.
Let $\zeta$ a root of $f$. Then
$$f = (x-\zeta)(x-\zeta^2)(x-\zeta^3)(x-\zeta^4)$$
splits completely over $\Q(\zeta)$. By Exercise 13,
$$G \simeq \Z/4\Z.$$
(we know already this result, since $f = \Phi_5$.)

\item[(e)] $f = x^4-2$.

By Exercise 13, Example 2, $\Delta(f) = -2^{11}$ is not a square, and $\theta_f(y) = y(y^2+8)$ has a unique root in $\Q$. Moreover if $a = \sqrt[4]{2}$,
$$f = (x-a)(x+a)(x^2+a^2)$$ doesn't splits completely over $\Q$, so
$$G \simeq D_8.$$
\ee
\end{proof}

\paragraph{Ex. 13.1.15}

{\it In the situation of Theorem 13.1.1, assume that $\theta_f(y)$ has a root in $F$. In the proof of the theorem, we used (13.5) and (13.7) to show that $G$ is conjugate to a subgroup of $D_8$. Show that the weaker assertion that $|G| = 4$ or $8$ can be proved directly from (12.17).
}

\begin{proof}
By (12.17), the roots of the quartic $f =x^4 -c_1x^3 + c_2 x^2 - c_3x + c_4$ are
$$\alpha = \frac{1}{4}\left ( c_1 + \varepsilon_1 \sqrt{ 4y_1 + c_1^2 - 4 c_2} + \varepsilon_2 \sqrt{ 4y_2 + c_1^2 - 4 c_2} + \varepsilon_3 \sqrt{ 4y_3 + c_1^2 - 4 c_2}\right ),$$
where $y_1,y_2,y_3$ are the roots of the Ferrari resolvent 
$$\theta_f(y) = y^3 - c_2y^2+(c_1c_3-4c_4) y - c_3^2 -c_1^2c_4 + 4 c_2c_4,$$
and the $\varepsilon_i = \pm 1$ are chosen so that the product of the radicals $t_i = + \varepsilon_i \sqrt{ 4y_i + c_1^2 - 4 c_2}$ is
$$t_1t_2t_3 = c_1^3 - 4 c_1 c_2 + 8c_3.$$
Let $L = F(\alpha_1,\alpha_2,\alpha_3,\alpha_4)$ be the splitting field of $F$.

Here $\theta_f(y)$ has a root in $F$, say $y_1$. Thus
$$\theta_f(y) =(y-y_1)g(y),$$
where $g(y) = y^2 + a y +b \in F[y].$
Therefore the roots $y_2,y_3$ of $g$ are in $F(\sqrt{\delta})$, where $\delta = a^2 - 4b \in F$ is the discriminant of $g$.
Moreover $t_1 = \alpha_1+\alpha_2-\alpha_3-\alpha_4  = \sqrt{ 4y_1 + c_1^2 - 4 c_2} \in L$, and similarly $t_2,t_3 \in L$, so $F(t_1,t_2,t_3) \subset L$, and by (12.17), $L \subset F(t_1,t_2,t_3)$, therefore
$$L = F(t_1,t_2,t_3) = F\left(\sqrt{ 4y_1 + c_1^2 - 4 c_2}, \sqrt{ 4y_2 + c_1^2 - 4 c_2},\sqrt{ 4y_3 + c_1^2 - 4 c_2}\right).$$
Since $\Delta(\theta_f) = \Delta(f) \ne 0$, there is at most one $t_i$ equal to $0$. So we can choose the numbering such that $t_1t_2 \ne 0$ (perhaps $t_3 = 0$). Since $t_1t_2t_3 = c_1^3 - 4 c_1 c_2 + 8c_3 \in F$, $t_3 \in F(t_1,t_2)$, so
$$L = F(t_1,t_2,t_3) = F(t_1,t_2) =F\left(\sqrt{ 4y_1 + c_1^2 - 4 c_2}, \sqrt{ 4y_2 + c_1^2 - 4 c_2}\right).$$
Note that $t_i^2 = 4y_i + c_1^2 - 4 c_2 \in L$, so $y_i \in L,\  i = 1,2,3$, so  $\sqrt{\delta} = y_2- y_3 \in L$, therefore $L(\sqrt{\delta}) = L$.
Consider the chain of inclusions
\begin{align*}
F \subset F\left(\sqrt{4y_1+c_1^2-4c_2}\right) \subset  F&\left(\sqrt{4y_1+c_1^2-4c_2},\sqrt{\delta}\right)\\
& \subset F\left(\sqrt{4y_1+c_1^2-4c_2}, \sqrt{\delta},\sqrt{4y_2+c_1^2-4c_2} \right) =L.
\end{align*}
 Since $4y_1+c_1^2-4c_2 \in F, \delta \in F$ and $4y_2+c_1^2-4c_2 \in F(\sqrt{\delta}$), the degree of each extension is 1 or 2, so 
$$[L:F] \mid 8.$$
Moreover $L \supset F(\alpha_1)$, and the minimal polynomial of $\alpha_1$ is f, so $$[L:F] \geq [F(\alpha_1):F] = \deg(f) = 4.$$ Since $|G| = [L:F]$,
$$|G| = 4 \text{ or } |G| = 8.$$
\end{proof}

\paragraph{Ex. 13.1.16}

{\it Consider the subgroups $\langle (1\,2),(3\,4) \rangle$ and $\langle (1\,2)(3\,4),(1\,3)(2\,4) \rangle$ of $S_4$.
\be
\item[(a)] Prove that these subgroups are isomorphic but not conjugate. This shows that when classifying subgroups of a given group, it can happen that nonconjugate subgroups can be isomorphic as abstract groups.
\item[(b)] Explain why the subgroup $\langle (1\,2),(3\,4) \rangle$ isn't mentioned in Theorems 13.1.1 and 13.1.6.
\ee
}

\begin{proof}
\be
\item[(a)]
\begin{align*}
H_1 &= \langle (1\,2),(3\,4) \rangle = \{(), (1\,2),(3\,4), (1\,2) (3\,4)\}, \\
 H_2 &= \langle (1\,2)(3\,4),(1\,3)(2\,4) \rangle = \{ (), (1\,2)(3\,4),(1\,3)(2\,4), (1\,4)(2\,3)\}
 \end{align*}
  are both isomorphic to the Klein's group $\Z/2\Z \times \Z/2\Z$.
  
Every conjugate of $(1\,2) \in H_1$ by $\sigma \in S_4$ is $(\sigma(1)\, \sigma(2)) $, which is not in $H_2$. The subgroups $H_1,H_2$ are not conjugate. 
\item[(b)] $H_1 = \langle (1\,2),(3\,4) \rangle$ is not a transitive subgroup of $S_4$ (the orbit of 1 is $\{1,2\}$), so isn't mentioned in Theorems 13.1.1 and 13.1.6.
\ee
\end{proof}

\subsection{QUINTIC POLYNOMIALS}

\paragraph{Ex. 13.2.1}

{\it As explained in the text, we can regard $\mathrm{AGL}(1,\F_5)$ as a subgroup of $S_5$.
\be
\item[(a)] Prove that $\mathrm{AGL}(1,\F_5)$ is generated by $(1\,2\,3\,4\,5)$ and $(1\,2\,4\,3)$.
\item[(b)] Prove that $\mathrm{AGL}(1,\F_5) \cap A_5$ is generated by $(1\,2\,3\,4\,5)$ and $(1\,4)(2\,3)$.
\item[(c)] Prove that the group of part (b) is isomorphic to the dihedral group $D_{10}$ of order $10$.
\item[(d)] Prove that $\langle (1\,2\,3\,4\,5)\rangle, \mathrm{AGL}(1,\F_5) \cap A_5$, and $\mathrm{AGL}(1,\F_5)$ are the only subgroups of $\mathrm{AGL}(1,\F_5)$ containing $\langle (1\,2\,3\,4\,5)\rangle$.
\ee
}

\begin{proof} 
\be
\item[(a)]Let $r = \gamma_{1,1} :\F_5 \to \F_5, x \mapsto x+1$ and $s = \gamma_{2,0} :\F_5 \to \F_5, x \mapsto 2x$, corresponding to the permutations $\rho = (1\,2\,3\,4\,5)$ and $\sigma = (1\,2\,4\,3)$. 

Since 2 is a generator of $\F_5^*$ ($2^2\equiv -1 \mod 5$), every $a \in \F_p^*$ is of the form $a = 2^k, \ k\in \N$, so every $f  \in \mathrm{AGL}(1,\F_5)$, defined by $x \mapsto ax+b,\ a=2^k\in \F_p^*,b\in \F_p$ is equal to $ f= r^b \circ s^k$. Therefore $\mathrm{AGL}(1,\F_5) = \langle r,s \rangle$, and the corresponding subgroup $G$ of $S_5$, isomorphic to $\mathrm{AGL}(1,\F_5)$, is generated by $\rho = (1\,2\,3\,4\,5)$ and $\sigma = (1\,2\,4\,3)$.

\item[(b)] By part (a), every permutation $\chi$ of $\mathrm{AGL}(1,\F_5) $ is of the form $\chi = \rho^b \sigma^k, \ 0\leq b \leq4, 0\leq k \leq 3$. Since $\rho \in A_5$ and $\sigma \in S_5 \setminus A_5$, $\chi \in A_5$ if and only if $k$ is even. Moreover, since $\sigma^4 = e$, for each integer $l$,  $\sigma^{2l} = e$ or $\sigma^{2l} = \sigma^2$, so
\begin{align*}
\mathrm{AGL}(1,\F_5) \cap A_5 &= \{\rho^k\ | \ 0 \leq k \leq 4\} \cup \{\rho^k \sigma^2\ | \ 0 \leq k \leq 4\}\\
&= \{e,\rho,\rho^2,\rho^3,\rho^4, \sigma^2, \rho \sigma^2, \rho^2 \sigma^2, \rho^3 \sigma^2, \rho^4 \sigma^2\}.
\end{align*}
Thus 
$$\mathrm{AGL}(1,\F_5) \cap A_5 =\langle \rho, \sigma^2 \rangle =  \langle (1\,2\,3\,4\,5), (1\,4)(2\,3) \rangle.$$

\item[(c)] For every $x \in \F_p$, $(s^2 \circ r)(x)  = 4(x+1)$, and $(r^{-1} \circ s^2)(x) = 4x - 1 = 4x + 4 = 4(x+1)$, so $s^2 \circ r = r^{-1} \circ s^2$ and $\sigma^2 \rho = \rho^{-1} \sigma^2$.

Write $\sigma' = \sigma^2$. Since $\mathrm{AGL}(1,\F_5) \cap A_5  = \langle \rho, \sigma' \rangle$, the relations 
$$\rho^5 = e, \qquad \sigma'^2 = e, \qquad \sigma' \rho = \rho^{-1} \sigma'$$
characterize the dihedral group $D_{10}$.

\item[(d)] Let $H \supsetneq \langle (1\,2\,3\,4\,5)\rangle$ be a subgroup of  $\mathrm{AGL}(1,\F_5) $. By part (a), $H$ contains an element $\rho^b  \sigma^k$, with $k \in \{1,2,3\}$.

Since $\rho \in H$, $\sigma^k = \rho^{-b} ( \rho^b  \sigma^k) \in H$.

If $k=1$, then $\sigma \in H$, and if $k=3$, then $\sigma^{3} = \sigma^{-1} \in H$. In both cases, $\sigma \in H$. Since $\mathrm{AGL}(1,\F_5)$ is generated by $\rho = (1\,2\,3\,4\,5)$ and $\sigma = (1\,2\,4\,3)$, then $H = \mathrm{AGL}(1,\F_5)$.

It remains the case where  $H$ contains $\sigma^2$ and doesn't contain $\sigma$. Then $H \supset \langle \rho, \sigma^2 \rangle$. No element of the form $\rho^b \sigma^{2k+1}$ is in $H$, otherwise $\sigma \in H$, so
$$H = \langle \rho, \sigma^2 \rangle = \mathrm{AGL}(1,\F_5) \cap A_5.$$
Thus the only subgroups of  $\mathrm{AGL}(1,\F_5)$ containing $\langle (1\,2\,3\,4\,5)\rangle$ are
$$\langle (1\,2\,3\,4\,5)\rangle,\qquad  \mathrm{AGL}(1,\F_5) \cap A_5, \qquad \mathrm{AGL}(1,\F_5).
$$
\ee
\end{proof}

\paragraph{Ex. 13.2.2}

{\it This exercise will consider some simple properties of $S_5$.
\be
\item[(a)] Prove that $\langle (1\,2\,3\,4\,5) \rangle$ is a 5-Sylow subgroup of $S_5$ and more generally is a $5$-Sylow subgroup of any subgroup $G \subset S_5$ containing $\langle (1\,2\,3\,4\,5) \rangle$.
\item[(b)] Prove that $S_5$ has twenty-four $5$-cycles.
\ee
}

\begin{proof}
\be
\item[(a)] As $|S_5| = 5! = 5 \cdot 24$, where $\gcd(5,24) = 1$, any subgroup of $S_5$ with order 5 is a $5$-Sylow of $S_5$, so  $\langle (1\,2\,3\,4\,5) \rangle$ is a 5-Sylow of $S_5$.

 Let $G$ be a subgroup of $S_5$ containing  $\langle (1\,2\,3\,4\,5) \rangle$. Then $5$ divides $ |G|$ and  $|G|$ divides $ 5! = 5 \cdot 24$, so $|G | = 5d$, where $d\mid 24$, thus $\gcd(5,d) = 1$. Therefore  $\langle (1\,2\,3\,4\,5) \rangle$ is a 5-Sylow of $G$.
 
 \item[(b)] There are $5!$ arrangements $(a_1,a_2,a_3, a_4,a_5)$, with distinct $a_i$ in $\{1,2,3,4,5\}$. The 5 arrangements $(a_1,a_2,a_3, a_4,a_5), (a_2,a_3, a_4,a_5,a_1), \ldots$ correspond to the same permutation $(a_1\, a_2 \, a_3\, a_4\,a_5)$, so there are $5!/5 = 24$ 5-cycles in $S_5$.
\ee
\end{proof}

\paragraph{Ex. 13.2.3}

{\it Let $G \subset S_5$ be transitive, and let $N$ be the number of subgroups of $G$ of order 5. In this exercise, you will use an argument from [Postnikov] to prove that $N=1$ or $6$ without using the Sylow Theorems. Let $C = \{\tau \in S_5 \setminus G\ |\, \tau \text{ is a 5-cycle}\}$.
\be
\item[(a)] Prove that $\sigma \cdot \tau = \sigma \tau \sigma^{-1}$ defines an action of $G$ on $C$.
\item[(b)] Let $\tau \in S_5$ be a $5$-cycle. Prove that $\sigma \in S_5$ satisfies $\sigma \tau \sigma^{-1} = \tau$ if and only if $\sigma \in \langle \tau \rangle$.
\item[(c)] Use parts (a) and (b) to prove that $|G|$ divides $|C|$.
\item[(d)] Prove that $4N + |C| = 24$.
\item[(e)] Use parts (c) and (d) to prove that $N=1$ or $6$.
\ee
}

\begin{proof}
\be
\item[(a)] Let $\sigma \in G$ and $\tau \in S_5 \setminus G$. If $\sigma \tau \sigma^{-1} \in G$, then  $\tau \in G$, in contradiction with the hypothesis. So, if $\sigma \in G$,
$$ \tau \in C \Rightarrow \sigma \cdot \tau \in C.$$

Moreover, if $\sigma, \sigma' \in G$, and $\tau \in C$, then $e\cdot \tau = e \tau e^{-1} = \tau$, and
$$\sigma \cdot (\sigma' \cdot \tau) = \sigma \cdot (\sigma' \tau \sigma'^{-1}) = \sigma \sigma' \tau \sigma'^{-1} \sigma^{-1} = (\sigma \sigma') \cdot \tau.$$
Therefore $\sigma \cdot \tau = \sigma \tau \sigma^{-1}$ defines an action of $G$ on $C$.

\item[(b)] Let $\tau = (a_1\,a_2\,a_3\,a_4\,a_5)\in S_5$ be a $5$-cycle. 
\be
\item[$\bullet$] Suppose that $\sigma \in S_5$ satisfies $\sigma \tau \sigma^{-1} = \tau$.
Then $(\sigma(a_1)\,\sigma(a_2)\,\sigma(a_3)\,\sigma(a_4)\,\sigma(a_5)) = (a_1\,a_2\,a_3\,a_4\,a_5)$.

Therefore $\sigma(a_1) \in \{a_1,a_2,a_3,a_4,a_5\}$, so $\sigma(a_1) =a_i$ for some $i \in \gcro 1,5 \dcro$.

Then, for all $j \in \gcro 1,5 \dcro$, since $\sigma \tau = \tau \sigma$,
\begin{align*}
\sigma(a_j) &= (\sigma \tau^{j-1})(a_1)\\
&= (\tau^{j-1} \sigma)(a_1)\\
&=\tau^{j-1}(a_i)\\
&=\tau^{j-1}(\tau^{i-1}(a_1))\\
&= \tau^{i-1+j-1}(a_1)\\
&= \tau^{i-1}(a_j),
\end{align*}
Since $ \{a_1,a_2,a_3,a_4,a_5\} = \{1,2,3,4,5\}$, $\sigma = \tau^{i-1} \in \langle \tau \rangle$.

\item[$\bullet$] Conversely, suppose that $\sigma \in \langle \tau \rangle$. Since $\langle \tau \rangle$ is cyclic, it is an Abelian subgroup, therefore $\sigma \tau = \tau \sigma$, so $\sigma \tau \sigma^{-1} = \tau$.
\ee
Conclusion: If $\tau \in S_5$ is a 5-cycle,
$$\forall \sigma \in S_5, \quad \sigma \tau \sigma^{-1} = \tau \iff \sigma \in \langle \tau \rangle.$$

\item[(c)] By part (b), the stabilizer of $\tau \in C$ in $G$ is 
$$\mathrm{Stab}_G(\tau) = \langle \tau \rangle \cap G.$$
Since $\tau \in C$, $\tau \not \in G$. If $\tau^k \in G$ for some $k \in \{2,3,4\}$, since $k\wedge 5 = 1$, $uk +5v = 1$ for some integers $u,v$, so $\tau = \tau^{uk} \tau ^{5v} = (\tau^k)^u \in G$, which is a contradiction, so $\tau,\tau^2,\tau^3,\tau^4$ are not in $G$, so  $\langle \tau \rangle \cap G =\{e\}$. Therefore
$$G_{\tau} = \mathrm{Stab}_G(\tau) =\{e\}.$$
If ${\cal{O}_\tau}$ is the orbit of $\tau$ for the action defined in part (a), 
$$ | {\cal{O}_\tau} | = (G:G_\tau) = |G|.$$
As $C = \coprod_{\tau \in S}  {\cal{O}_\tau}$, where $S$ is a complete system of the representatives of the orbits, if $m = |S|$ is the number of orbits, $|C| = m |G| $, so
$$|G| \text{ divides } |C|.$$

\item[(d)] By Exercise 2,  $S_5$ has $24$ 5-cycles. 
\begin{align*}
\{\tau \in S_5 \ | \ \tau \text{ is a 5-cycle} \} &= \{\tau \in G \ | \ \tau \text{ is a 5-cycle} \} \cup \{\tau \in  S_5 \setminus G \ | \ \tau \text{ is a 5-cycle} \} \\
&= \{\tau \in G \ | \ \tau \text{ is a 5-cycle} \} \cup C,
\end{align*}
where the union is a disjoint union.

Moreover, G has $N$ subgroups of order 5, and the intersection of two such subgroups is $\{e\}$,  so $G$ has $N\times 4$ 5-cycles. Therefore
$$24 = 4N + |C|.$$

\item[(e)] Since $G \subset S_5$ is a transitive subgroup, by Lemma 13.2.1,  $5 \mid |G|$, and by part (c), $|G| \mid |C|$, so part (d) implies
$$5 \mid 24 - 4N.$$
Therefore $4N \equiv 24 \equiv 4 \pmod 5$, so $N \equiv 1 \pmod 5$, and since $4N \leq 24$, $N \leq 6$, so
$$N = 1 \text{ or } N = 6.$$
\ee
\end{proof}


\paragraph{Ex. 13.2.4}

{\it Prove that (13.19) gives coset representatives of $\mathrm{AGL}(1,\F_5)$ in $S_5$.
}

\begin{proof}
As the index $(S_5:\mathrm{AGL}(1,\F_5)) =120/20 = 6$, it is sufficient to verify that the 6 permutations 
$$S = \{e, (1\,2\,3), (2\,3\,4), (3\,4\,5), (1\,4\,5),(1\,2\,5)\}$$
are in distinct coset, by verifying that the 15 permutations $u v^{-1} \not \in \mathrm{AGL}(1,\F_5)$, where $$u,v \in S,\qquad u \ne v.$$

\begin{align*}
\mathrm{AGL}(1,\F_5) &= \{e, (1,2,4,3), (1,2,3,4,5), (1,3,5,2,4), (1,4,5,2), (1,3,2,5),\\
&(1,4)(2,3), (1,4,2,5,3), (2,5)(3,4), (1,5,3,4), (2,3,5,4), (1,3)(4,5),\\
&(1,3,4,2), (1,5)(2,4), (1,2)(3,5), (1,5,4,3,2), (2,4,5,3), (1,4,3,5),\\
&(1,2,5,4), (1,5,2,3) \}
\end{align*}

\begin{align*}
&\{u v^{-1} \ | \ u \in S, v \in S, u\ne v\} =\\
&\{ (1,3,2), (2,4,3), (3,5,4), (1,5,4), (1,5,2), (1,2,3,5,4), (2,3,5),\\
&(1,3,4), (1,5,4,2,3), (1,5,2,3,4), (1,3,4,5,2), (2,4,5), (1,5,3),\\
&(1,5,3,4,2), (1,2,4)\}\\
\end{align*}

Sage instructions
\begin{verbatim}
S5 = SymmetricGroup(5)
a = S5([(1,2,3,4,5)])
b = S5([(1,2,4,3)])
G = PermutationGroup([a,b])
l =  [S5([]),S5([(1,2,3)]),S5([(2,3,4)]),S5([(3,4,5)]),S5([(1,4,5)]),S5([(1,2,5)])]
[u*v^(-1) in G for u in l for v in l if u< v]
\end{verbatim}
\begin{center}
[False, False, \ldots , False]
\end{center}

So $S$ is a set of coset representatives of $\mathrm{AGL}(1,\F_5)$ in $S_5$.
\end{proof}

\paragraph{Ex. 13.2.5}

{\it Complete the proof of part (b) of Theorem 13.2.6. Then prove part (c).
}

\begin{proof}
\be
\item[$\bullet$]
In the context of the proof of part (b) of Theorem 13.2.6, $A_5 \subset G$.
Let $$\tau_1 = e,\quad \tau_2 =  (1\,2\,3),\quad  \tau_3 = (2\,3\,4),\quad  \tau_4 = (3\,4\,5),\quad \tau_5=  (1\,4\,5),\quad \tau_6 = (1\,2\,5),$$
and $h_i = \tau_i \cdot h, \ i=1,\ldots,6$, where $h = u^2$ and
\begin{align*}
u = &\  x_1x_2+x_2x_3 +x_3x_4+x_4x_5+x_5x_1\\
&-x_1x_3-x_3x_5-x_5x_2-x_2x_4-x_4x_1.
\end{align*}
By definition,
$$\beta_i = h_i(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5).$$
Since $ A_5 \subset G$ and $\tau_i \in A_5$, there exists $\sigma_i \in \Gal(L/F)$ such that $\sigma_i$ maps to $\tau_i$ for every $i \in \gcro 1,6\dcro$, so 
$$\sigma_i(\alpha_j) = \alpha_{\tau_i(j)},\qquad i \in \gcro 1,6\dcro,\qquad j\in \gcro 1,5\dcro.$$
Then, for all $i \in \gcro 1,6\dcro$,
\begin{align*}
\sigma_i(\beta_1)&= \sigma_i(h(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5))\\
&= h(\sigma_i(\alpha_1),\sigma_i(\alpha_2),\sigma_i(\alpha_3),\sigma_i(\alpha_4),\sigma_i(\alpha_5))\\
&= h (\alpha_{\tau_i(1)}, \alpha_{\tau_i(2)},\alpha_{\tau_i(3)},\alpha_{\tau_i(4)},\alpha_{\tau_i(5)})\\
&=(\tau_i \cdot h)(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5)\\
&= h_i(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5)\\
&= \beta_i
\end{align*}
So 
$$\sigma_i(\beta_1) = \beta_i, \qquad i=1,\ldots,6.$$
By assumption, some $\beta_j$ is in $F$, therefore $\beta_1 = \sigma_j^{-1}(\beta_j) = \beta_j \in F$, and $\beta_i = \sigma_i(\beta_1) = \beta_1$ for all $i \in \gcro 1,6\dcro$.
We obtain the identity
$$(y-\beta_1)^6 = (y^3+b_2y^2+b_4y+b_6)^2 - 2^{10} \Delta(f) y.$$
Multiplying this out, we obtain
\begin{align*}
&y^6 - 6 \beta_1 y^5 +15 \beta_1^2 y^4 - 20\beta_1^3 y^3 + 15 \beta_1^4 y^2 -6 \beta_1^5 y + \beta_1^6 =\\
&y^6 + 2 b_2 y^5 +(b_2^2 + 2b_4) y^4 +(2b_6 +2b_2b_4) y^3 + (b_4^2 + 2 b_2b_6) y^2 +(2 b_4b_6 - 2^{10} \Delta(f))y +b_6^2,
\end{align*}
so
\begin{align*}
-6\beta_1 &= 2 b_2,\\
15 \beta_1^2 &= b_2^2+2b_4,\\
-20 \beta_1^3 &= 2 b_2b_4 + 2 b_6.
\end{align*}
Therefore, since $F$ has characteristic $\ne 2$,
\begin{align*}
b_2 &= -3\beta_1,\\
b_4 &= \frac{1}{2} ( 15 \beta_1^2 - 9 \beta_1^2)\\
&=3\beta_1^2,\\
b_6 &= \frac{1}{2} (-20 \beta_1^3 +  18 \beta_1^3)\\
&= -\beta_1^3,
\end{align*}
so
$$b_2 = -3\beta_1,\qquad b_4 = 3\beta_1^2, \qquad b_6 = -\beta_1^3.$$
The precedent identity becomes
\begin{align*}
(y-\beta_1)^6 &= (y^3+b_2y^2+b_4y+b_6)^2 - 2^{10} \Delta(f) y\\
&= (y^3 - 3\beta_1y^2 + 3 \beta_1^2 y - \beta_1^3)^2 - 2^{10} \Delta(f) y\\
&=(y-\beta_1)^6 -2^{10} \Delta(f) y.
\end{align*}
Hence $2^{10} \Delta(f) = 0$. Yet $F$ has characteristic $\ne 2$, and $\Delta(f) \ne 0$, since $f$ is separable.
This contradiction completes the proof of the theorem.

\item[$\bullet$] We prove part (c) of Theorem 13.2.6.

Suppose that $G$ is conjugate to $\langle (1\,2\,3\,4\,5) \rangle$. Let $L =F(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5)$ be the splitting field of $f$. We choose the numbering of the roots such that $\Gal(L/F) = \langle \sigma \rangle$, where $\sigma$ corresponds to $(1\,2\,3\,4\,5)$. 

 $[L:F] = |\Gal(L/F)| =5$, so the Tower Theorem implies that $[F(\alpha) : F]$ divides 5. 
 
 Since $f$ is irreducible, $\alpha \not \in F$, so $[F(\alpha) : F] \ne 1$, $[F(\alpha) : F] = 5$ and 
$L = F(\alpha)$. Therefore $\alpha_i \in F(\alpha), \ i=1,\ldots,5$, and so $f = (x-\alpha_1)(x-\alpha_2)(x-\alpha_3)(x-\alpha_4)(x-\alpha_5)$ splits completely over $F(\alpha)$.

\medskip

Conversely suppose that $f$ splits completely over $F(\alpha)$. Then $\alpha_i \in F(\alpha),\ i=1,\ldots,5$, so the splitting field of $f$ is $L = F(\alpha)$.
Therefore $| \Gal(L/F)| = [L:F] = 5$ is prime, so $\Gal(L/F)$ is cyclic. $G \simeq \Gal(L/F)$ is cyclic of order 5, so $G = \langle \tau \rangle$, where $\tau \in S_5$ is a permutation of order 5. $\tau$ is a product of disjoint cycles whose order is the least common multiple of the length of the cycles, so $\tau$ is a $5$-cycle.

$G = \langle (a_1 \, a_2 a_3 a_4 a_5) \rangle = \sigma \langle (1\,2\,3\,4\,5)\rangle\sigma^{-1} $, where $\sigma$ is defined by $\sigma(i ) = a_i, \ i=1,\ldots,5$. $G$ is conjugate to $\langle (1\,2\,3\,4\,5) \rangle$. 
\ee
\end{proof}

\paragraph{Ex. 13.2.6}

{\it In this exercise, you will use Maple or Mathematica (or Sage!), to prove (13.23) and (13.24).
\be
\item[(a)] The first step is to enter (13.17) and call it, for example $u1$. Then use substitution commands and (13.19) to create $u2,\ldots u6$. For example, $u2$ is obtained by applying $(1\,2\,3)$ to $u1$. In Maple, this is done via the command

\begin{verbatim}
           u2 := subs({x1=x2,x2=x3,x3=x1},u1);
\end{verbatim}
whereas in Mathematica one uses
\begin{verbatim}
           u2 := u1 /. {x1->x2,x2->x3,x3->x1}
\end{verbatim}
\item[(b)] Now multiply out $\Theta(y) = (y-u1)\cdots(y-u6)$ and use the methods of section 2.3 to express the coefficients of $\Theta(y)$ in terms of the elementary symmetric polynomials.
\item[(c)] Show that your results imply (13.23) and (13.24).
\ee
}

\begin{proof}
Sage instructions :
\begin{verbatim}
R.<y,x,x1,x2,x3,x4,x5,y1,y2,y3,y4,y5> = PolynomialRing(QQ, order = 'degrevlex')
elt = SymmetricFunctions(QQ).e()
e = [elt([i]).expand(5).subs(x0=x1, x1=x2, x2=x3, x3 = x4, x4 = x5) 
               for i in range(6)]
J = R.ideal(e[1]-y1, e[2]-y2, e[3]-y3,e[4]-y4,e[5]-y5)
G = J.groebner_basis()
u1 =x1*x2 + x2*x3 + x3*x4 + x4*x5 + x5*x1 - x1*x3 - x3*x5 -x5*x2 - x2*x4 -x4*x1
u2 = u1.subs(x1 = x2, x2 = x3, x3 = x1)
u3 = u1.subs(x2 = x3, x3 = x4, x4 = x2)
u4 = u1.subs(x3 = x4, x4 = x5, x5 = x3)
u5 = u1.subs(x1 = x4, x4 = x5, x5 = x1)
u6 = u1.subs(x1 = x2, x2 = x5, x5 = x1)
f1 = (y-u1) * (y-u2) * (y-u3) * (y-u4) * (y-u5) * (y-u6) 
var('sigma_1,sigma_2,sigma_3,sigma_4,sigma_5')
g = f1.reduce(G).subs(y1=sigma_1, y2=sigma_2, y3=sigma_3, y4=sigma_4, y5= sigma_5)
h = g.collect(y);
\end{verbatim}

\bigskip

Now we can verify (13.23) and (13.24):

\begin{verbatim}
h.coefficient(y^5),h.coefficient(y^3)
\end{verbatim}
$$(0,0)$$
\begin{verbatim}
B2 = h.coefficient(y^4); B2
\end{verbatim}
$$	
-3 \, \sigma_{2}^{2} + 8 \, \sigma_{1} \sigma_{3} - 20 \, \sigma_{4}
$$

\begin{verbatim}
B4 = h.coefficient(y^2); B4
\end{verbatim}
\begin{align*}
&3 \, \sigma_{2}^{4} - 16 \, \sigma_{1} \sigma_{2}^{2} \sigma_{3} + 16 \, \sigma_{1}^{2} \sigma_{3}^{2} + 16 \, \sigma_{1}^{2} \sigma_{2} \sigma_{4} - 64 \, \sigma_{1}^{3} \sigma_{5} + 16 \, \sigma_{2} \sigma_{3}^{2} - 8 \, \sigma_{2}^{2} \sigma_{4} \\
&- 112 \, \sigma_{1} \sigma_{3} \sigma_{4} + 240 \, \sigma_{1} \sigma_{2} \sigma_{5} + 240 \, \sigma_{4}^{2} - 400 \, \sigma_{3} \sigma_{5}
\end{align*}
\begin{verbatim}
B6 = h.subs(y = 0);B6
\end{verbatim}
\begin{align*}
&-\sigma_{2}^{6} + 8 \, \sigma_{1} \sigma_{2}^{4} \sigma_{3} - 16 \,
\sigma_{1}^{2} \sigma_{2}^{2} \sigma_{3}^{2} - 16 \, \sigma_{1}^{2}
\sigma_{2}^{3} \sigma_{4} + 64 \, \sigma_{1}^{3} \sigma_{2} \sigma_{3}
\sigma_{4}\\
 &- 64 \, \sigma_{1}^{4} \sigma_{4}^{2} - 16 \, \sigma_{2}^{3}
\sigma_{3}^{2} + 64 \, \sigma_{1} \sigma_{2} \sigma_{3}^{3} + 28 \,
\sigma_{2}^{4} \sigma_{4} - 112 \, \sigma_{1} \sigma_{2}^{2} \sigma_{3}
\sigma_{4} - 128 \, \sigma_{1}^{2} \sigma_{3}^{2} \sigma_{4} + 224 \,
\sigma_{1}^{2} \sigma_{2} \sigma_{4}^{2} \\
&+ 48 \, \sigma_{1}
\sigma_{2}^{3} \sigma_{5} - 192 \, \sigma_{1}^{2} \sigma_{2} \sigma_{3}
\sigma_{5} + 384 \, \sigma_{1}^{3} \sigma_{4} \sigma_{5} - 64 \, 
\sigma_{3}^{4} + 224 \, \sigma_{2} \sigma_{3}^{2} \sigma_{4} - 176 \,
\sigma_{2}^{2} \sigma_{4}^{2} - 64 \, \sigma_{1} \sigma_{3} \sigma_{4}^{2} \\
&- 80 \, \sigma_{2}^{2} \sigma_{3} \sigma_{5} + 640 \,
\sigma_{1} \sigma_{3}^{2} \sigma_{5} - 640 \, \sigma_{1} \sigma_{2} 
\sigma_{4} \sigma_{5} - 1600 \, \sigma_{1}^{2} \sigma_{5}^{2} + 320 \,
\sigma_{4}^{3} - 1600 \, \sigma_{3} \sigma_{4} \sigma_{5} + 4000 \,
\sigma_{2} \sigma_{5}^{2}
\end{align*}

The coefficient $c_1$ of $y$ in $h = \Theta(y)$ is not symmetric in $x_1,\ldots,x_5$, but we verify that $c_1 = 2^5\sqrt{\Delta}\, y$, computing first $\sqrt{\Delta}$:
\begin{verbatim}
c1  = f1.coefficient(y)
x = [1,x1,x2,x3,x4,x5]
sqrtDelta = 1
for i in range(1,6):
    for j in range(i+1,6):
        sqrtDelta *= (x[i] -x[j])
sqrtDelta
c1 + 2^5 * sqrtDelta
\end{verbatim}
$$0$$

So (13.23) and (13.24) are verified.
\end{proof}

\paragraph{Ex. 13.2.7}

{\it Consider $\mathrm{AGL}(1,\F_5) \cap A_5 \subset S_5$, and let $u$ be defined as in (13.17).
\be
\item[(a)] Prove that the symmetry group of $u$ is $\mathrm{AGL}(1,\F_5) \cap A_5 $.
\item[(b)] Prove that (13.19) gives coset representatives of $\mathrm{AGL}(1,\F_5) \cap A_5 $ in $A_5$.
\ee
}

\begin{proof}
\be
\item[(a)]
 Let $G$ be the symmetry group of $u$.
	\be
	\item[$\bullet$] If $\sigma \in G$, then $\sigma \cdot u = u$, therefore $\sigma \cdot h = \sigma \cdot u^2= u^2 = h$. By Lemma 13.2.4, $\sigma \in \mathrm{AGL}(1,\F_5)$, so $G \subset \mathrm{AGL}(1,\F_5)$.
	$G \ne \mathrm{AGL}(1,\F_5)$, otherwise $ (1\,2\,4\,3) \in G$, but $(1\,2\,4\,3) \cdot u = -u \ne u$ (see (13.2.B)). Therefore $G \subsetneq \mathrm{AGL}(1,\F_5)$. 
	
	Moreover $(1\,2\,3\,4\,5) \cdot u = u$, so $\langle  (1\,2\,3\,4\,5) \rangle \subset G$ and $G$ is transitive. By Theorem 13.2.2, 
	$$G \subset \mathrm{AGL}(1,\F_5) \cap A_5 .$$
	
	\item[$\bullet$] If $\chi \in \mathrm{AGL}(1,\F_5) \cap A_5$, by Exercise 1 part (b), 
	$$\chi =  (1\,2\,3\,4\,5)^k [(1\,4)(2\, 3)]^l, \qquad k,l \in \N.$$
	$(1\,2\,3\,4\,5)\cdot u = u$ and $ (1\,2\,4\,3) \cdot u = -u$, therefore $(1\,4)(2\, 3)\cdot u = (1\,2\,4\,3)^2\cdot u = u$. Thus $\chi \in G$.
	$$G = \mathrm{AGL}(1,\F_5) \cap A_5 .$$

	\ee
	
\item[(b)] In Exercise 4, we verified that for $u,v \in S, u\ne v$, with
$$S = \{e, (1\,2\,3), (2\,3\,4), (3\,4\,5), (1\,4\,5),(1\,2\,5)\} \subset  A_5,$$
then $u v^{-1} \not \in \mathrm{AGL}(1,\F_5)$, a fortiori $u v^{-1} \not \in \mathrm{AGL}(1,\F_5) \cap A_5$.

Moreover the index $(A_5 : \mathrm{AGL}(1,\F_5) \cap A_5) = 60 / 10 = 6 $, so $S$ is a complete system of coset representatives of $\mathrm{AGL}(1,\F_5) \cap A_5 $ in $A_5$.
\ee
\end{proof}

\paragraph{Ex. 13.2.8}

{\it Let $u_1,\ldots,u_6$ be as in the proof of Proposition 13.2.5, and let $\tau \in S_5$ be a transposition.
\be
\item[(a)] For each $i$, prove that $\tau \cdot u_i = -u_j$ for some $j$.
\item[(b)] Let $\Theta(y) = \prod_{i=1}^6 (y-u_i)$ and write this polynomial as
$$\Theta(y) = y^6 + B_1 y^5 +B_2 y^4 + B_3y^3 + B_4y^2 +B_5 y + B_6.$$
Use part (a) to show that $\tau \cdot B_i = (-1)^i B_i$ for $i=1,\ldots,6$.
\item[(c)] Explain how part (b) and the results of Chapter 2 imply that the coefficients $B_2,B_4,B_6$ are polynomials in $\sigma_1,\sigma_2,\sigma_3,\sigma_4,\sigma_5$. This explains why the formulas (13.24) exist.
\item[(d)] Use Exercise 3 of Section 7.4 to show that the coefficients $B_1,B_3,B_5$ must be of the form $B \sqrt{\Delta}$, where $B$ is a polynomial in $\sigma_1,\sigma_2,\sigma_3,\sigma_4,\sigma_5$.
\item[(e)] Note that $\sqrt{\Delta}$ has degree 10 as a polynomial in $x_1,x_2,x_3,x_4,x_5$. By considering the degrees of $B_1,B_3,B_5$ as polynomials in $x_1,x_2,x_4,x_4,x_5$, show that part (d) implies that $B_1 = B_3 = 0$ and that $B_5$ is a constant multiple of $\sqrt{\Delta}$. This explains (13.23).
\ee
}

\begin{proof}
\be
\item[(a)] Let $\tau \in S_5\setminus A_5$ be a transposition, and write $\sigma = (1\,2\,4\,3) \in S_5 \setminus A_5$. We know that $\sigma \cdot u = -u$.

Since $\sigma \in S_5 \setminus A_5$, $S_5$ is the disjoint union $S_5 = A_5 \cup A_5 \sigma$, so $S_5 \setminus A_5 = A_5 \sigma$. Since $\tau \tau_i \in S_5 \setminus  A_5 $, then  $\tau \tau_i \in A_5 \sigma$, so
$$\tau \tau_i = \psi \sigma,\qquad \psi \in A_5.$$
By Exercise 7, $\{\tau_1 ,\tau_2, \cdots,\tau_6\} =  \{e, (1\,2\,3), (2\,3\,4), (3\,4\,5), (1\,4\,5),(1\,2\,5)\} $  is a complete system of coset representatives of $\mathrm{AGL}(1,\F_5) \cap A_5$ in $A_5$.  Therefore
$$\psi = \tau_j \varphi,\qquad j \in\gcro 1,6 \dcro,\qquad  \varphi \in \mathrm{AGL}(1,\F_5) \cap A_5.$$
Since $\varphi \in \mathrm{AGL}(1,\F_5) \cap A_5$, by Exercise 7 part (a), $\varphi \cdot u = u$. Therefore
\begin{align*}
\tau \cdot u_i &= (\tau \tau_i) \cdot u\\
&= (\tau_j \varphi \sigma)\cdot u\\
&= -(\tau_j \varphi)\cdot u= -\tau_j u = -u_j
\end{align*}
For each $i \in \gcro 1,6\dcro$, there exists $j \in \gcro 1,6\dcro$ such that $\tau\cdot u_i = -u_j$.


\item[(b)] Let
$$\Theta(y) = \prod_{i=1}^6 (y-u_i) =  y^6 + B_1 y^5 +B_2 y^4 + B_3y^3 + B_4y^2 +B_5 y + B_6.$$
Note that if $\tau\cdot u_i = \tau \cdot u_j$, $i,j \in \gcro 1,6\dcro $, then $\tau^2 \cdot u_i = \tau^2 \cdot u_j$, so $u_i = u_j$ and $i=j$. Therefore $\tau$ maps the set $\{u_1,\ldots,u_6\}$ on $\{-u_1,\ldots,-u_6\}$. Consequently
\begin{align*}
\tau \cdot \Theta(y) &= \prod_{i=1}^6 (y-\tau \cdot u_i)\\
&= \prod_{j=1}^6 (y+ u_j)\\
&=  y^6 - B_1 y^5 +B_2 y^4 - B_3y^3 + B_4y^2 -B_5 y + B_6
\end{align*}
Since
$$\tau \cdot \Theta(y) =  y^6 + \tau \cdot B_1 y^5 + \tau \cdot B_2 y^4 + \tau \cdot B_3y^3 + \tau \cdot B_4y^2 +\tau \cdot B_5 y +\tau \cdot  B_6,$$
we conclude
$$\tau \cdot B_i = (-1)^i B_i, \qquad i=1,\ldots,6.$$

\item[(c)] For $i = 2,4,6$, $\tau \cdot B_i = B_i$ for every transposition $\tau$. Since every $\sigma \in S_5$ is a product of transpositions, for all $\sigma \in S_5$, $\sigma \cdot B_i = B_i$, where $B_i \in F[x_1,\ldots,x_5]$, therefore $B_i \in F[\sigma_1,\ldots,\sigma_5]$.

$B_2,B_4,B_6$ are polynomials in $\sigma_1,\sigma_2,\sigma_3,\sigma_4,\sigma_5$.

\item[(d)] For $i=1,3,5$, $\tau \cdot B_i = - B_i$, thus $B_i$ is invariant under $A_5$. Since the characteristic of $F$ is not 2, by Exercise 7.4.3, $B_i = C_i+D_i \sqrt{\Delta}$, where $C_i,D_i$ are polynomials in the $\sigma_i$. Then  $-C_i - D_i \sqrt{\Delta} = -B_i = \tau \cdot B_i  = C_i - D_i \sqrt{\Delta}$, so $C_i = 0$.
$$B_i = D_i \sqrt{\Delta},\qquad D_i \in F[\sigma_1,\ldots,\sigma_5] \qquad \text{ for } i =1,3,5.$$


\item[(e)] Since $\sqrt{\Delta} = \prod_{1\leq i < j \leq 5} (x_i - x_j)$, $\sqrt{\Delta}$ has degree $1+2+3+4 = 10$ as a polynomial in $x_1,x_2,x_3,x_4,x_5$.
$B_1 = u_1+u_2+u_3+u_4+u_5$, with $\deg(u_i) = 2$, thus $\deg(D_1 \sqrt{\Delta}) \leq 2$. Therefore $D_1 = 0$.

$B_3 = u_1u_2u_3+\cdots$, so $\deg(B_3) = \deg(D_3\sqrt{\Delta}) \leq 6$. Therefore $D_3 = 0$, and $B_3 = 0$.

$B_5 = u_1u_2u_3u_4u_5+\cdots$, so $\deg(B_5)  \leq 10$. Therefore $\deg(D_5) \leq 0$, so $D_5 = c \in F$ is a constant.
$$\Theta(y) = y^6 + B_2 y^4 + B_4 y^2 + B_6 +c \sqrt{\Delta} y,\qquad B_2,B_4,B_6 \in F[\sigma_1,\ldots,\sigma_5], \qquad c \in F.$$

By Exercise 7, $c = -2^5$.
\ee
\end{proof}

\paragraph{Ex. 13.2.9}

{\it This exercise will prove the first equivalence of Proposition 13.2.7.
\be
\item[(a)] First suppose that $\theta_f(y)$ is irreducible. Prove that $|G|$ is divisible by 6, and explain why this implies that $A_5 \subset G$.

\item[(b)] Now suppose that $A_5 \subset G$. Prove that $\Gal(L/F)$ acts transitively on $\beta_1,\ldots,\beta_6$. However, we don't know that $\beta_1,\ldots,\beta_6$ are distinct.

\item[(c)] Let $p(y)$ be the minimal polynomial of $\beta_1$ over $F$. By part (b), it is also the minimal polynomial of $\beta_2,\ldots,\beta_6$. Prove that $\theta_f(y) = p(y)^m$, where $m=1,2,3$, or $6$. The proof of Theorem 13.2.6 shows that $m=6$ cannot occur, and $m=1$ implies that $\theta_f(y)$ is irreducible over $F$. It remains to consider what happens when $m=2$ or $3$. 

\item[(d)] Show that $(y^3+ay^2+by+c)^2 = \theta_f(y)$ implies that $\Delta(f) = 0$. Hence this case can't occur.

\item[(e)] Show that $(y^2 +ay +b)^3 = \theta_f(y)$ implies that $4b = a^2$, and then use this to show that $\Delta(f) = 0$.

\ee
}

\begin{proof}

\be
\item[(a)] Suppose that $\theta_f(y) = \prod_{i=1}^6 (y-\beta_i)$ is irreducible over $F$. Then $\theta_f(y)$ is the minimal polynomial of $\beta_1 = h(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5)$ over $F$. Therefore
$$[F(\beta_1) : F] = \deg \theta_f(y) = 6.$$
Since $\beta_1 = h(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5) \in F(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5) = L$,
$$F \subset F(\beta_1) \subset F(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5) = L.$$
By the Tower Theorem,
$$[F(\beta_1) : F] \mid [L:F],$$
therefore
$$6 \mid  [L:F] = |\Gal(L/F)| = |G|.$$
Since $6 \nmid |\mathrm{AGL}(1,\F_5)| = 20$, $G$ is not a subgroup of $\mathrm{AGL}(1,\F_5)$. By Theorem 13.2.2, since $G$ is a transitive subgroup of $S_5$, $G =A_5$ or $G = S_5$:
$$A_5 \subset G.$$

\item[(b)] Now suppose that $A_5 \subset G$. Then $$G \supset\{\tau_1,\ldots,\tau_6\} = \{e,(1\,2\,3), (2\,3\,4),(3\,4\,5),(1\,4\,5),(1\,2\,5)\},$$ so $\tau_i \in G$ and the corresponding $\sigma_i$ are in $\Gal(L/F)$. 
By Exercise 13.2.5, $\sigma_i(\beta_1) = \beta_i$, thus the orbit of $\beta_1$ under the action of $\Gal(L/F)$ is ${\cal O}_{\beta_1} = \{\beta_1,\ldots, \beta_6\}$. This is sufficient to prove that $\Gal(L/F)$ acts transitively on $\beta_1,\ldots,\beta_6$.

\item[(c)] Let $p(y)$ be the minimal polynomial of $\beta_1$ over $F$. There exists $\sigma_i \in \Gal(L/F)$ such that $\sigma_i(\beta_1) = \beta_i$, and since $p(y) \in F[y]$, $0 = \sigma_i(p(\beta_1)) = p(\sigma_i(\beta_1)) = p(\beta_i)$, so $\beta_i$ is a root of $p$, where $p$ is irreducible. Therefore $p$ is the minimal polynomial over $F$ of $\beta_1,\ldots,\beta_6$.

Under the hypothesis of Theorem 13.2.7 (and 13.2.6), $F \subset L$ is a separable extension, so $\beta_1$ is separable, therefore
$$p(x) = (x-\gamma_1)\cdots(x-\gamma_r),$$
where $\gamma_1,\ldots,\gamma_r$ are distinct. Since $p$ is the minimal polynomial over $F$ of $\beta_1,\ldots,\beta_6$, each $\beta_j$ is a $\gamma_i$ for some  $i, 1\leq i \leq r$, and since $p(y)$ divides $\theta_f(y)$, each $\gamma_i$ is a $\beta_j$, so $\{\gamma_1,\ldots,\gamma_r\} = \{\beta_1,\ldots,\beta_6\}$, and $\gamma_1,\ldots,\gamma_r$ are the distinct roots of $\theta_f(y)$.

Let $k_i$ the order of multiplicity of $\beta_i$ in $\theta_f(y)$, so $\theta_f(y) = (y-\beta_i)^{k_i} q_i(y), \ q_i(y) \in L[y]$. Let $\sigma \in \Gal(L/F)$ such that $\sigma(\beta_i) = \beta_j$. Applying $\sigma$ to $\theta_f(y)$, we obtain $\theta_f(y) = (y-\beta_j)^{k_i} (\sigma \cdot q_i)(y)$, so $k_j \geq k_i$, and similarly $k_i \geq k_j$, so the distinct $\gamma_i$ have the same order of multiplicity $m$ in $\theta_f(y)$. Therefore
$$\theta_f(y) = (x-\gamma_1)^m \cdots (x-\gamma_r)^m = p(y)^m.$$
Since $6 = \deg(\theta_f(y)) = m \deg(p(y))$, $m \mid 6$, so $ m = 1,2,3$ or $6$.

$m=6$ gives $\theta_f(y) = (x-\beta_1)^6$. Since the characteristic of $f$ is not 2, this is impossible by the proof of Theorem 13.2.6. It remains to prove the impossibility of $m=2$ or $m=3$.


\item[(d)] If $m=2$,
$$\theta_f(y) = (y^3+ay^2+by+c)^2,\qquad a,b,c \in F.$$
By Proposition 13.2.5, this gives
$$(y^3+b_2y^2+b_4y+b_6)^2-2^{10} \Delta(f) y=(y^3+ay^2+by+c)^2,$$
so
\begin{align*}
2^{10} \Delta(f) y &= (y^3+b_2y^2+b_4y+b_6)^2 - (y^3+ay^2+by+c)^2\\
&=[(b_2-a)y^2 + (b_4 -b)y + (b_6-c)] [2y^3 + (b_2+a)y^2 + (b_4+b)y + (b_6+c)]
\end{align*}
Therefore the coefficient in $y^5$ is $2(b_2-a) = 0$. Since the characteristic is not 2,
$$b_2 = a.$$
Using $b_2 = a$, the coefficient in $y^4$ is $2(b_4-b) = 0$, so
$$b_4 = b,$$
and then the coefficient in $y^3$ is $2(b_6-c)$, so
$$b_6 = c.$$
Therefore $2^{10} \Delta(f) y = 0$. Since the characteristic is not 2, $\Delta(f) = 0$, in contradiction with the assumed separability of $f$.

\item[(e)] If $m=3$, there exist coefficients $a,b \in F$ such that
$$\theta_f(y) = (y^2+ay+b)^3 = (y^3 +b_2y^2+b_4y+b_6)^2 - 2^{10} \Delta(f) y. $$ 


\begin{align*}
0 = \theta_f(y) - (y^2+ax+b)^3 &= -{\left(3 \, a - 2 \, b_{2}\right)} y^{5} - {\left(3 \, a^{2} -
b_{2}^{2} + 3 \, b - 2 \, b_{4}\right)} y^{4}\\
&\phantom{ = } - {\left(a^{3} + 6 \, a b
- 2 \, b_{2} b_{4} - 2 \, b_{6}\right)} y^{3}  - {\left(3 \,
a^{2} b + 3 \, b^{2} - b_{4}^{2} - 2 \, b_{2} b_{6}\right)} y^{2}\\
&\phantom{ = }  - {\left(3 \, a b^{2} - 2 \, b_{4} b_{6} + 1024 \,
\Delta(f)\right)} y - b^{3} +b_{6}^{2}.
\end{align*}

We obtain $b_2,b_4,b_6$ with the equations corresponding to the coefficients of $y^5,y^4,y^3$:
$$
\left\{
\begin{array}{lll}
0 &= -3 \, a + 2 \, b_{2},\\
 0&=-3 \, a^{2} +b_{2}^{2} - 3 \, b + 2 \, b_{4},\\
0&= -a^{3} - 6 \, a b + 2 \, b_{2} b_{4} + 2 \, b_{6},
\end{array}
\right.
$$
which gives
$$b_{2} = \frac{3}{2} \, a, \qquad b_{4} = \frac{3}{8} \, a^{2} +
\frac{3}{2} \, b, \qquad b_{6} = -\frac{1}{16} \, a^{3} + \frac{3}{4} \, ab.$$

If we substitute these values in the coefficient of $y^3$, we obtain
\begin{align*}
a^{3} + 6 \, a b - 2 \, b_{2} b_{4} - 2 \, b_{6} &= a^{3} + 6 \, a b - 2 \left( \frac{3}{2} \, a\right) \left( \frac{3}{8} \, a^{2} +\frac{3}{2} \, b\right) +  2 \left (\frac{1}{16} \, a^{3} + \frac{3}{4} \, ab\right)\\
&=0.
\end{align*}
The coefficient of $y^2$ gives
$-\frac{3}{64} 	 \left( a^{4} - 8 \, a^{2} b + 16 \, b^{2}\right) = -\frac{3}{64} (a^2 - 4b)^2= 0$.

If we suppose that the characteristic is not $3$, then
$$a^2 = 4b.$$
The coefficient of $y$ gives
\begin{align*}
0&=-\frac{3}{64} \, a^{5} + \frac{3}{8} \, a^{3} b - \frac{3}{4} \, a b^{2}- 2^{10} \, \Delta(f)\\
&=-\frac{3}{64}\,  a\left( a^{2} - 4 b\right)^2 - 2^{10} \, \Delta(f)\\
&= - 2^{10} \, \Delta(f)
\end{align*}
Therefore $$\Delta(f) = 0.$$
Since $f$ is separable, this is a contradiction, so $\theta_f(y)$ is irreducible.

It remains the case where the characteristic is 3. Then the equation 
$$\theta_f(y) = (y^2+ay+b)^3 = (y^3 +b_2y^2+b_4y+b_6)^2 - 2^{10} \Delta(f) y$$
gives the system
$$
\left\{
\begin{array}{lll}
0 &= 2 \, b_{2},\\
 0&=b_{2}^{2} + 2 \, b_{4},\\
0&= -a^{3} + 2 \, b_{2} b_{4} + 2 \, b_{6},
\end{array}
\right.
$$
Therefore $b_2 = b_4 = 0$, so the initial equation gives
$$y^6 + a^3 y^3 + b^3 = y^6 + 2b_6 y^3 -2^{10} \Delta(f) y +b_6^2,$$
and we have the same contradiction $\Delta(f) = 0$, and the same conclusion:
\begin{center}
$\theta_f(y)$ is irreducible over $F$.
\end{center}

\bigskip

We give here the corresponding Sage instructions:
\begin{verbatim}
y,b2,b4,b6,Delta,a,b,c = var('y,b2,b4,b6,Delta,a,b,c')
u = (y^3+b2*y^2+b4*y+b6)^2 - 2^10*Delta*y - (y^2+a*y+b)^3
u = u.expand().collect(y); u
\end{verbatim}
\medskip
$$-{\left(3 \, a - 2 \, b_{2}\right)} y^{5} - {\left(3 \, a^{2} -
b_{2}^{2} + 3 \, b - 2 \, b_{4}\right)} y^{4} - {\left(a^{3} + 6 \, a b
- 2 \, b_{2} b_{4} - 2 \, b_{6}\right)} y^{3} - b^{3}$$
$$ - {\left(3 \,
a^{2} b + 3 \, b^{2} - b_{4}^{2} - 2 \, b_{2} b_{6}\right)} y^{2} +
b_{6}^{2} - {\left(3 \, a b^{2} - 2 \, b_{4} b_{6} + 1024 \,
\Delta\right)} y$$

\begin{verbatim}
eq = [u.coefficient(y^i) for i in range(3,6)]
solve(eq,b2,b4,b6)
\end{verbatim}

$$\left[\left[b_{2} = \frac{3}{2} \, a, b_{4} = \frac{3}{8} \, a^{2} +
\frac{3}{2} \, b, b_{6} = -\frac{1}{16} \, a^{3} + \frac{3}{4} \, a
b\right]\right]$$

\begin{verbatim}
v = u.coefficient(y^3)
w = v.subs(b2 == 3/2*a, b4 == 3/8*a^2 + 3/2*b, b6 == -1/16*a^3 + 3/4*a*b)
w.expand()
\end{verbatim}
$$0$$
\begin{verbatim}
s = u.coefficient(y^2)
t = s.subs(b2 == 3/2*a, b4 == 3/8*a^2 + 3/2*b, b6 == -1/16*a^3 + 3/4*a*b)
t.expand().factor()
\end{verbatim}
$$-\frac{3}{64} \, {\left(a^{2} - 4 \, b\right)}^{2}$$

\begin{verbatim}
p = u.coefficient(y)
q = p.subs(b2 == 3/2*a, b4 == 3/8*a^2 + 3/2*b, b6 == -1/16*a^3 + 3/4*a*b)
q.expand()
\end{verbatim}
$$-\frac{3}{64} \, a^{5} + \frac{3}{8} \, a^{3} b - \frac{3}{4} \, a b^{2}
- 1024 \, \Delta$$
\begin{verbatim}
q.expand().subs(b = a^2/4)
\end{verbatim}
$$-1024 \Delta$$

We obtained $\Delta(f) = 0$.
\ee
\end{proof}

\paragraph{Ex. 13.2.10}

{\it This exercise will prove the second equivalence of Proposition 13.2.7. Note that one direction follows trivially from Theorem 13.2.6. So we can assume that $G \subset \mathrm{AGL}(1,\F_5)$ and that $\theta_f(y) = (y-\beta_1) g(y)$ where $\beta_1 \in F$.
\be
\item[(a)] Use $(1\,2\,3\,4\,5) \in G$ to prove that $\Gal(L/F)$ acts transitively on $\beta_2,\ldots,\beta_6$. As in the previous exercise, we don't know if $\beta_2,\ldots,\beta_6$ are distinct.

\item[(b)] Let $p(y)$ be the minimal polynomial of $\beta_2$ over $F$. By part (a), it is also the minimal polynomial of $\beta_2,\ldots,\beta_6$. Prove that $\theta_f(y) = (y-\beta_1)p(y)^m$, where $m=1$ or $5$. If $m=1$, then we are done. So we need to rule out $m=5$.

\item[(c)] Show that $(y-\beta_1)(y-\beta_2)^5 = \theta_f(y)$ implies that $\beta_1 = \beta_2$, and then use this to show that $\Delta(f) = 0$.
\ee
}

\begin{proof}
If $\theta_f(y)$ has a root $\beta \in F$, then by Theorem 13.2.6(b), $G$ is conjugate to a subgroup of $\mathrm{AGL}(1,\F_5)$.

Conversely, assume that $G$ is conjugate to a subgroup of $\mathrm{AGL}(1,\F_5)$. Relabeling the roots, we may assume that $\langle (1\,2\,3\,4\,5) \rangle \subset G \subset \mathrm{AGL}(1,\F_5)$, and by Theorem 13.2.6(b), $\theta_f(y)$ has a root $\beta_1 \in F$, so $\theta_f(y) = (y-\beta_1) g(y)$.
\be
\item[(a)]
Write $\rho = (1\,2\,3\,4\,5) $ and $\tilde{\rho} \in \Gal(L/F)$ the corresponding automorphism. Then 
$$\tilde{\rho}(\alpha_1) = \alpha_2, \ \ldots,\quad \tilde{\rho}(\alpha_4) = \alpha_5,\quad  \tilde{\rho}(\alpha_5) = \alpha_1,$$
and $\sigma_i \in \Gal(L/F)$ corresponds to $\tau_i$.

We name the left coset representatives of $\mathrm{AGL}(1,\F_5)$ given in $S_5$:
$$\tau_1 =e,\ \tau_2 = (1\,2\,3),\ \tau_3 = (2\,3\,4),\  \tau_4 = (3\,4\,5),\  \tau_5 = (1\,4\,5),\  \tau_6 = (1\,2\,5).$$
Note that these cosets representatives verify $\rho \tau_1 \rho^{-1} = \tau_1 =e$, and
$$\rho \tau_2 \rho^{-1} = \tau_3,\quad \cdots, \quad \rho \tau_5 \rho^{-1} = \tau_6,\quad \rho \tau_6 \rho^{-1} = \tau_2.$$
By definition, $h_i = \tau_i \cdot h,\ i=1,\ldots,6$, where $h=u^2$ and $u$ is given in (13.17), and 
$$\sigma_i(\beta_1) =(\tau_i \cdot h)(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5)= \beta_i$$ (see Exercise 13.2.5).
Since $\rho \in \mathrm{AGL}(1,5)$, $\rho\cdot h = h$, therefore, for $2\leq i \leq 5$
$$(\rho \tau_i)\cdot h = (\rho \tau_i \rho^{-1})\cdot (\rho \cdot h) = \tau_{i+1} \cdot h,$$
and $(\rho \tau_6) \cdot h = \tau_2 \cdot h$.

If $\tilde{\varphi} \in \Gal(L/F)$ corresponds to some $\varphi \in S_5$, then $\tilde{\varphi}(\alpha_i) = \alpha_{\varphi(i)},\ i= 1,\ldots,5$, so
$$\tilde{\varphi}(h(\alpha_1,\ldots,\alpha_5)) = h(\alpha_{\varphi(1)},\ldots,\alpha_{\varphi(5)})= (\varphi \cdot h)(\alpha_1,\ldots,\alpha_5).$$
Since $\tilde{\rho} \circ \sigma_i \in \Gal(L/F)$ corresponds to $\rho \tau_i$,
\begin{align*}
\tilde{\rho}(\beta_i) &= \tilde{\rho}(\sigma_i(\beta_1))\\
&= (\tilde{\rho} \circ \sigma_i)(h(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5))\\
&= [(\rho\, \tau_i)\cdot h](\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5)\\
&= [(\rho \tau_i \rho^{-1})\cdot (\rho \cdot h)](\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5)\\
&= (\tau_{i+1} h)(\alpha_1,\alpha_2,\alpha_3,\alpha_4,\alpha_5)\\
&= \beta_{i+1}, \qquad i = 2,3,4,5,
\end{align*}
and similarly $\tilde{\rho}(\beta_6) = \beta_2$. So the images of $\beta_i$ by the automorphism $\tilde{\rho}$ corresponding to $\rho = (1\,2\,3\,4\,5) $ are given by
$$\beta_2 \mapsto \beta_3 \mapsto \beta_4 \mapsto \beta_5 \mapsto \beta_6 \mapsto \beta_2, \qquad \beta_1 \mapsto \beta_1,$$
therefore $\Gal(L/F)$ acts transitively on $\beta_2,\ldots,\beta_6$.

\item[(b)] Let $p(y) \in F[y]$ be the minimal polynomial of $\beta_2$ over $F$. Since $\tilde{\rho} \in \Gal(L,F)$, $p(\beta_3) = p(\tilde{\rho}(\beta_2)) =\tilde{\rho}(p(\beta_2)) = 0$, so $\beta_3$, and similarly $\beta_4,\beta_5,\beta_6$ are roots of $p$, so $p$ is the minimal polynomial of $\beta_2,\ldots,\beta_6$.

$\theta_f(y) = (y-\beta_1) g(y)$, therefore $g(y) \in F[y]$.

 $F \subset L$ is a separable extension, so $\beta_2$ is separable, therefore
$$p(y) = (y-\gamma_1)\cdots(y-\gamma_r),$$
where $\gamma_1,\ldots,\gamma_r$ are distinct. As $p$ is the minimal polynomial of $\beta_2$ over $F$, and $g(\beta_2) = 0$, with $g \in F[y]$, $p(y)$ divides $\theta_f(y)$, so each $\gamma_i$ is a $\beta_j$, and each $\beta_j,\ 2 \leq j \leq j$, is a root of $p$ so is a $\gamma_i$. Therefore $\{\gamma_1,\ldots,\gamma_r\} = \{\beta_2,\ldots,\beta_6\}$, and $\gamma_1,\ldots,\gamma_r$ are the distinct roots of $g$.

Since $\Gal(L/F)$ acts transitively on $\beta_2,\ldots,\beta_6$, then the distinct roots $\gamma_1,\cdots,\gamma_r$ have the same order of multiplicity $m$ (as in Exercise 9). Therefore $g(y) = p(y)^m$, so
$$\theta_f(y) = (y-\beta_1)p(y)^m.$$
Since $5 = \deg(g) = m \deg(p)$, $5 \mid m$, so $m=1$ or $m=5$. We need to rule out $m=5$.

\item[(c)] If $m=5$,
$$\theta_f(y) = (y-\beta_1)(y-\beta_2)^5.$$
Then, with some formal computations,
\begin{align*}
0 &= (y^3 + b_2y^2+b_4y +b_6)^2 - 2^{10} \Delta(f) y - (y-\beta_1)(y-\beta_2)^5\\
&=   {\left(2 \, b_{2} + \beta_{1} + 5 \,
\beta_{2}\right)} y^{5} + {\left(b_{2}^{2} - 5 \, \beta_{1} \beta_{2} -
10 \, \beta_{2}^{2} + 2 \, b_{4}\right)} y^{4} + 2 \, {\left(5 \,
\beta_{1} \beta_{2}^{2} + 5 \, \beta_{2}^{3} + b_{2} b_{4} +
b_{6}\right)} y^{3} \\
&- {\left(10 \, \beta_{1} \beta_{2}^{3} + 5 \,
\beta_{2}^{4} - b_{4}^{2} - 2 \, b_{2} b_{6}\right)} y^{2}  +
{\left(5 \, \beta_{1} \beta_{2}^{4} + \beta_{2}^{5} + 2 \, b_{4} b_{6} -
1024 \, \Delta(f) \right)} y -\beta_{1} \beta_{2}^{5} + b_{6}^{2}.
\end{align*}

The coefficients of $y^5,y^4,y^3$ give
\begin{align*}
0 &=2 \, b_{2} + \beta_{1} + 5 \, \beta_{2},\\
0 &= b_{2}^{2} - 5 \,\beta_{1} \beta_{2} - 10 \, \beta_{2}^{2} + 2 \, b_{4},\\
0&=  10 \, \beta_{1}\beta_{2}^{2} + 10 \, \beta_{2}^{3} + 2 \, b_{2} b_{4} + 2 \,b_{6},
\end{align*}
so
\begin{align*}
b_{2} &= -\frac{1}{2} \, \beta_{1} - \frac{5}{2} \,
\beta_{2},\\
 b_{4} &= -\frac{1}{8} \, \beta_{1}^{2} + \frac{5}{4} \,
\beta_{1} \beta_{2} + \frac{15}{8} \, \beta_{2}^{2},\\
 b_{6} &=
-\frac{1}{16} \, \beta_{1}^{3} + \frac{5}{16} \, \beta_{1}^{2} \beta_{2}
- \frac{15}{16} \, \beta_{1} \beta_{2}^{2} - \frac{5}{16} \,
\beta_{2}^{3}.
\end{align*}

Substituting these values in  the equation, we obtain
\begin{align*}
0 &= a y^2 + by +c,
\end{align*}
where
\begin{align*}
a &= \frac{5}{64}(\beta_{1}^{4} - 4 \, \beta_{1}^{3} \beta_{2} + 6 \, \beta_{1}^{2} \beta_{2}^{2} - 4 \, \beta_{1} \beta_{2}^{3} + \beta_{2}^{4})
 =  \frac{5}{64} (\beta_1 - \beta_2)^4,\\
b &= \frac{1}{64} \, \beta_{1}^{5} - \frac{15}{64} \, \beta_{1}^{4} \beta_{2}
+ \frac{25}{32} \, \beta_{1}^{3} \beta_{2}^{2} - \frac{35}{32} \,
\beta_{1}^{2} \beta_{2}^{3} + \frac{45}{64} \, \beta_{1} \beta_{2}^{4} -
\frac{11}{64} \, \beta_{2}^{5} - 1024 \, \Delta(f),\\
c&= \frac{1}{256} \, \beta_{1}^{6} - \frac{5}{128} \, \beta_{1}^{5}
\beta_{2} + \frac{55}{256} \, \beta_{1}^{4} \beta_{2}^{2} -
\frac{35}{64} \, \beta_{1}^{3} \beta_{2}^{3} + \frac{175}{256} \,
\beta_{1}^{2} \beta_{2}^{4} - \frac{53}{128} \, \beta_{1} \beta_{2}^{5}
+ \frac{25}{256} \, \beta_{2}^{6}.\\
\end{align*}

 Since $a=0$, if the characteristic is not 5, then $\beta_1 = \beta_2$, so $\theta_f(y) = (y-\beta_1)^6$. But the proof of Theorem 13.2.6 shows that this implies that $\Delta(f) = 0$, and this is a contradiction. Thus $m=1$ and $g$ is irreducible over $F$.  This proves Proposition 13.2.7. in characteristic $\ne 5$.
 
 Sage instructions for part (e):
\begin{verbatim}
x,y,beta1,beta2,Delta,b2,b4,b6 = var('x,y,beta1,beta2,Delta,b2,b4,b6')
p = (y^3 + b2*y^2 + b4*y + b6)^2 - 2^10*Delta*y - (y-beta1)*(y-beta2)^5
p = p.expand().collect(y)
R.<y>=QQ[]
l = [p.coefficient(y,i) for i in range(5,-1,-1)]
eq = l[:3]
solve(eq,b2,b4,b6)
q=p.subs(b2 == -1/2*beta1 - 5/2*beta2, 
      b4 == -1/8*beta1^2 + 5/4*beta1*beta2 + 15/8*beta2^2, 
      b6 == -1/16*beta1^3 + 5/16*beta1^2*beta2 -15/16*beta1*beta2^2 - 5/16*beta2^3)
q=q.expand().collect(y)
q.coefficient(y,2).factor()
 \end{verbatim}
 $$\frac{5}{64} \, {\left(\beta_{1} - \beta_{2}\right)}^{4}$$
 It remains the case where the characteristic is 5. Then the equations $b=0, c = 0$ become, 
 \begin{align*}
 0 &= \frac{1}{64}(\beta_1^5 - \beta_2^5) - 2^{10}\Delta(f),\\
 0 &= \frac {1}{256}\beta_1(\beta_1^5 - \beta_2^5).
 \end{align*}
If $\beta_1 \ne 0$, then $\beta_1^5 - \beta_2^5 = 0$, hence $2^{10} \Delta(f) = 0$. Since the characteristic is not 2, we obtain $\Delta(f) = 0$, which is impossible since $f$ is separable by hypothesis.

If $\beta_1 = 0$, it remains a unique equation
$$0 = \beta_2^5 + 2^{16} \Delta(f),$$
 that is
$$0 = \beta_2^5 + \Delta(f).$$
In this case
$$\theta_f(y) = y(y-\beta_2)^5 = y(y^5 - \beta_2^5) = y^6 + \Delta(f) y.$$

Since $$\theta_f(y) = (y^3 + b_2y^2+b_4y+b_6)^2 - 2^{10} \Delta(f) y = (y^3 + b_2y^2+b_4y+b_6)^2 + \Delta(f) y,$$ this condition is equivalent to $b_2 = b_4 = b_6 = 0$.

I don't see an immediate contradiction ...

In fact, with this analysis, we can show a counterexample of Proposition 13.2.7:

Let $f = x^5 - x + 1 \in \F_5[x]$, where $c_1 = c_2 = c_3 = 0, c_4 = -1,c_5 = -1$. Then $f$ is irreducible, separable, and the Sage instructions given in Exercise 6, where we replace the field $\Q$ by $\F_5$ show that $b_2 = b_4 = b_6 = 0$, and
\begin{align*}
\Delta(f) &= -1,\\
\theta_f(y) &= y^6 - y.
\end{align*}
(We verify this directly on the formulas (13.24) : almost all the terms of $B_2,B_4,B_6$ contain $\sigma_1,\sigma_2$ or $\sigma_3$, if not,  the coefficient is a multiple of 5, so $b_2 = b_4 = b_6 = 0$.)


Therefore $\beta = 0$ is a root of $\theta_f$, and $\theta_f(y) = (y -\beta) g(y)$, where $g(y) = y^5- 1 = (y-1)^5$ is {\bf not} irreducible over $\F_5$.

The second equivalence of Proposition 13.2.7 is false if the characteristic of $F$ is 5.

Note : Here we know explicitly the roots of $f$ in $\F_{5^5}[x]$. If $\alpha$ is a root of $f$ in this field, the roots of $f$ are $\alpha, \alpha +1, \alpha+2,\alpha+3,\alpha+4$ (see Ex. 6.2.5).
If we substitute (with the help of Sage) these roots in $h_1,\ldots,h_6$, we obtain $0,1,1,1,1,1$, therefore 
$$\theta_f(y) =\prod_{i=1}^6(y-h_i(\alpha_1,\ldots,\alpha_5)) = y(y-1)^5 = y^6 - y.$$

This is a confirmation of the previous results.


 
 
 \ee
\end{proof}

\paragraph{Ex. 13.2.11}

{\it Show that the table preceding Example 13.2.8 follows from the diagram (13.16) and Theorem 13.2.6.
}

\begin{proof}
\be
\item[$\bullet$]  Suppose that $\theta_f(y)$ has no root in $F$ (lines 1 and 2 of the table). By Theorem 13.2.6 (b), $G$ is not conjugate to a subgroup of $\mathrm{AGL}(1,\F_5)$. Therefore by diagram (13.6) and Theorem 13.2.2, $G = A_5$ or $G = S_5$ (no conjugacy here). By Theorem 13.2.6 (a), $G = A_5$ if $\Delta(f) \in F^2$, and $G = S_5$ otherwise.

\item[$\bullet$]   Suppose now that $\theta_f(y)$ has a root in $F$ (lines 3,4,5 of the table). Then, by Theorem 13.2.6 (b) (and Theorem 13.2.2), $G$ is conjugate to a subgroup of $\mathrm{AGL}(1,\F_5)$ containing $\langle (1\,2\,3\,4\,5) \rangle$. 

So, by diagram (13.16), $G$ is conjugate to $\mathrm{AGL}(1,\F_5), \mathrm{AGL}(1,\F_5) \cap A_5$, or $\langle (1\,2\,3\,4\,5) \rangle$.

If $\Delta(f) \not \in F^2$, $G \not \subset A_5$, therefore $G = \mathrm{AGL}(1,\F_5)$. This is the third line of the table.

If $\Delta(f)  \in F^2$, $G \subset A_5$, therefore $G$ is conjugate to $\mathrm{AGL}(1,\F_5) \cap A_5$, or $\langle (1\,2\,3\,4\,5) \rangle$.

By theorem 13.2.6 (c), $G$ is conjugate to $\langle (1\,2\,3\,4\,5) \rangle$ if and only if $f$ splits completely over $F(\alpha)$, and this gives the two last lines of the table.
\ee
\end{proof}

\paragraph{Ex. 13.2.12}

{\it Let $f = x^5 - 6x+3 \in \Q[x]$. Compute $\Delta(f)$ and $\theta_f(y)$ and show that $\theta_f(y)$ is irreducible over $\Q$.
}

\begin{proof}
By the Sch\"onemann-Eisenstein Criterion for $p=3$, we know that $f$ is irreducible over $\Q$.

The discriminant $f = x^5 +ax+b, a,b\in \Q$ is given (see Ex. 15) by
$$\Delta(f) = 256a^5+3125b^4,$$
so 
$$\Delta(f) = -256 \cdot 6^5 + 3125 \cdot 3^4 = -1737531.$$
If we apply on the resolvent $\theta_f(y)$ the evaluation $\sigma_1\mapsto 0, \sigma_2\mapsto 0, \sigma_3\mapsto 0, \sigma_4 \mapsto a, \sigma_5 \mapsto -b$, we obtain
$$\theta_f(y) =  {\left(y^{3} - 20 \, a y^{2}  + 240 \,a^{2} y + 320 \, a^{3} \right)}^{2} - 2^{10}(256 \, a^{5}  + 3125 \, b^{4}) y $$

With $a = -6, b = 3$, we obtain
\begin{align*}
\theta_f(y) &={\left(y^{3} + 120 \, y^{2} + 8640 \, y - 69120\right)}^{2} + 2^{10}\, 1737531 \, y\\
&= y^{6} + 240 \, y^{5} + 31680 \, y^{4} + 1935360 \, y^{3} + 58060800 \,
y^{2} + 584838144 \, y + 4777574400
\end{align*}
The Sch\"onemann-Eisenstein Criterion doesn't apply.  

With Sage, we obtain
\begin{verbatim}
R.<y> = QQ[]
p=y^6 + 240*y^5 + 31680*y^4 + 1935360*y^3 + 58060800*y^2 + 584838144*y + 4777574400
p.is_irreducible()
\end{verbatim}
\begin{center}
True
\end{center}

$\theta_f(y)$ is irreducible over $\Q$. A fortiori, $\theta_f(y)$ has no root in $\Q$.

Since $\Delta(f)<0$ is not a square in $\Q$, the Galois group of $f$ is $S_5$.
\end{proof}

\paragraph{Ex. 13.2.13}

{\it Let $f = x^5 - 2 \in \Q(\sqrt{5})[x]$ be as in Example 13.2.9.
\be
\item[(a)] Compute $\Delta(f)$ and $\theta_f(y)$.
\item[(b)] In Section 6.4 we showed that the Galois group of $f$ over $\Q$ is isomorphic to $\mathrm{AGL}(1,\F_5)$. Use this and the Galois correspondence to show that the Galois group over $\Q(\sqrt{5})$ is isomorphic to $\mathrm{AGL}(1,\F_5) \cap A_5$.
\ee
}

\begin{proof}
\be
\item[(a)] We use the formulas of Exercise 15 for $f =x^5+ax+b$:
\begin{align*}
\Delta(f) &= 256a^5+3125b^4,\\
\theta_f(y) &=  {\left(y^{3} - 20 \, a y^{2}  + 240 \,a^{2} y + 320 \, a^{3} \right)}^{2} - 2^{10}\Delta(f) y.
\end{align*}
With $a=0, b=-2$, we obtain
\begin{align*}
\Delta(f) &= 50000= 2^4\,  5^5,\\
\theta_f(y) &=  y^6- 2^{14}\, 5^5\, y.
\end{align*}
Let $L$ be the splitting field of $x^5 - 2$ over $\Q$.
 $\Delta(f)$ is not a square in $\mathbb{Q}$, and $\theta_f(y)$ has a root 0 in $\Q$. So, by Theorem 13.2.6 and Exercise 11, $\Gal(L/\Q)$ is isomorphic to $\mathrm{AGL}(1,\F_5)$. This result is  already proved in Section 6.4.
 
 \item[(b)] 
  We know that $\zeta_5 = (\zeta_5 \sqrt[5]{2})/ \sqrt[5]{2} \in L$, and also $\sqrt{5} = \zeta_5 + \zeta_5^{-1} - \zeta_5^2 - \zeta_5^{-2} \in L$ (see the quadratic Gauss sum page 249).
  
 Since $\Q \subset \Q(\sqrt{5})$ is a quadratic extension, by the Galois correspondence, $\Gal(L / \Q(\sqrt{5}))$ is a subgroup of index 2 in $\Gal(L/\Q)$ and the subgroup $H \subset S_5$ corresponding to $\Gal(L/\Q(\sqrt{5}))$ has index 2 in $G \simeq \mathrm{AGL}(1,\F_5)$. Thus $|H| = 10$, and since $5 \mid |H|$, $H$ contains a 5-cycle and is a transitive subgroup of $S_5$.  By Theorem 13.2.2, $H$ is conjugate to $\langle (1\,2\,3\,4\,5) \rangle$ or to $ \mathrm{AGL}(1,\F_5) \cap A_5$. Since $(G:H) = 2$, $H$ is conjugate to  $\mathrm{AGL}(1,\F_5) \cap A_5$, so
 $$\Gal(L/\Q(\sqrt{5})) \simeq H \simeq \mathrm{AGL}(1,\F_5) \cap A_5.$$
 \ee
\end{proof}

\paragraph{Ex. 13.2.14}

{\it Let $f = x^5 + px^3 +\frac{1}{5} p^2x + q \in \Q[x]$ be as in Example 13.2.10, and assume that $f$ is irreducible over $\Q$.
\be
\item[(a)] Compute $\Delta(f)$ and $\theta_f(y)$.
\item[(b)] Factor $\theta_f(y) \in \Q[x]$, and conclude that $5p^2 \in \Q$ is a root of $\theta_f(y)$.
\item[(c)] Show that the substitution $x = z - \frac{p}{5z}$ transforms $f$ into $z^5 - \frac{p^5}{5^5z^5} + q$.
\item[(d)] Use part (c) to give an elementary proof that $f$ is solvable by radicals over $\Q$.
\ee
}

\begin{proof}
\be
\item[(a)] We obtain the discriminant with Sage:
\begin{verbatim}
S.<p,q,x> = QQ[]
f = x^5 + p*x^3 +(1/5)*p^2*x + q
Delta = f.discriminant(x);Delta.factor()
\end{verbatim}
$$\left(\frac{1}{3125}\right) \cdot (4 p^{5} + 3125 q^{2})^{2}
$$
So
$$
\Delta(f) =\frac{1}{5^5} \cdot (4 p^{5} + 3125 q^{2})^{2}.
$$

\bigskip

We use the following procedure to compute a sextic resolvent with the same method as in Exercise 6:
\begin{verbatim}
def resolvent(f):
    l = f.coefficients(sparse = False)
    R.<Delta,x1,x2,x3,x4,x5,y1,y2,y3,y4,y5,y,P,Q,e> = PolynomialRing(QQ, order = 'degrevlex')
    elt = SymmetricFunctions(QQ).e()
    e = [elt([i]).expand(5).subs(x0=x1, x1=x2, x2=x3, x3 = x4, x4 = x5)
                   for i in range(6)]
    J = R.ideal(e[1]-y1, e[2]-y2, e[3]-y3,e[4]-y4,e[5]-y5)
    G = J.groebner_basis()
    u1 =x1*x2 + x2*x3 + x3*x4 + x4*x5 + x5*x1 - x1*x3 - x3*x5 -x5*x2 - x2*x4 -x4*x1
    u2 = u1.subs(x1 = x2, x2 = x3, x3 = x1)
    u3 = u1.subs(x2 = x3, x3 = x4, x4 = x2)
    u4 = u1.subs(x3 = x4, x4 = x5, x5 = x3)
    u5 = u1.subs(x1 = x4, x4 = x5, x5 = x1)
    u6 = u1.subs(x1 = x2, x2 = x5, x5 = x1)
    f1 = (y-u1) * (y-u2) * (y-u3) * (y-u4) * (y-u5) * (y-u6)
    var('sigma_1,sigma_2,sigma_3,sigma_4,sigma_5')
    g = f1.reduce(G).subs(y1=sigma_1, y2=sigma_2, y3=sigma_3, y4=sigma_4, y5= sigma_5)
    h = g.collect(y);
    B2 = h.coefficient(y,4)
    B4 = h.coefficient(y,2)
    B6 = h.coefficient(y,0)
    b2 = B2.subs(sigma_1 = -l[4], sigma_2= l[3],sigma_3 = -l[2], sigma_4 = l[1], sigma_5 = -l[0])
    b4 = B4.subs(sigma_1 = -l[4], sigma_2= l[3],sigma_3 = -l[2], sigma_4 = l[1], sigma_5 = -l[0])
    b6 = B6.subs(sigma_1 = -l[4], sigma_2= l[3],sigma_3 = -l[2],
                sigma_4 = l[1], sigma_5 = -l[0])
    theta_f = [(y^3+b2*y^2+b4*y+b6)^2 - 2^10*Delta*y,b2,b4,b6]
    return theta_f
\end{verbatim}

Then we obtain $b_2,b_4,b_6$ and $\theta_f(y)$:
\begin{verbatim}
K.<p,q> = QQ[]
S.<x> =PolynomialRing(K, order = 'degrevlex')
f = x^5 + p*x^3 +(1/5)*p^2*x + q
resolvent(f)[1:4]
\end{verbatim}
$$\left(-7 \, p^{2}, 11 \, p^{4}, \frac{3}{25} \, p^{6} + 4000 \, p q^{2}\right)$$

\begin{verbatim}
theta_f=resolvent(f)[0];theta_f
\end{verbatim}
\begin{align*}
&\theta_f(y) = \frac{1}{625} \left(3 p^{6} +275 p^{4}y-175 p^{2}y^2+ 100000 p q^{2}+25y^3\right)^2 - 1024\Delta(f) y\\
& = \left(y^3-7 \, p^{2}y^2+11 p^{4}y+\frac{3}{25} \, p^{6} + 4000 \, p q^{2}\right)^2 - 2^{10}\Delta(f) y
\end{align*}
We obtained the results given in the text.

\item[(b)]
To find the rational root of $f$ we write
\begin{verbatim}
theta_f.subs(Delta = (1/5)^5*(4*p^5+3125*q^2)^2)).factor()
\end{verbatim} 
\begin{align*}
&\frac{1}{3125} \, (5 \, p^{2} - y)\, (9 \, p^{10} - 1625 \, p^{8} y + 74250 \, p^{6} y^{2} + 600000 \, p^{5} q^{2} - 81250 \, p^{4} y^{3}\\
& + 50000000 \, p^{3} q^{2} y + 28125 \, p^{2} y^{4} - 25000000 \, p q^{2} y^{2} - 3125 \, y^{5} + 10000000000 \, q^{4})
\end{align*}
Thus $$\theta_f(5p^2) = 0.$$

By Corollary 13.2.11, $f$ is solvable by radicals over $\Q$.

\item[(c)] The substitution $x = z - \frac{p}{5z}$ is obtained by
\begin{verbatim}
z = var('z')
g = f.subs(x = z - p/(5*z))
g.expand()
\end{verbatim}
$$z^{5} + q - \frac{p^{5}}{3125 \, z^{5}}$$
Thus
$$g(z) = f\left( z - \frac{p}{5z}\right) = z^5 - \frac{p^{5}}{5^5 \, z^{5}} +q.$$

\item[(d)] Let $\beta \in \C$.
\begin{align*}
g(\beta) = 0 &\iff \beta^{10} +q\,\beta^5 -\left(\frac{p}{5}\right)^5 = 0\\
&\iff\left(\beta^5 +\frac{q}{2} \right)^2 - \left[ \left(\frac{q}{2}\right)^2 + \left(\frac{p}{5}\right)^5\right] = 0\\
&\iff \left[ \beta^5 + \frac{q}{2} - \sqrt{ \left(\frac{q}{2}\right)^2 + \left(\frac{p}{5}\right)^5 } \right]\left[ \beta^5 + \frac{q}{2} - \sqrt{ \left(\frac{q}{2}\right)^2 + \left(\frac{p}{5}\right)^5 } \right] = 0.
\end{align*}
So the $10$ roots of $g$ are
$$\beta_{k,\varepsilon} = \zeta^k \sqrt[5]{- \frac{q}{2} + \varepsilon \sqrt{ \left(\frac{q}{2}\right)^2 + \left(\frac{p}{5}\right)^5 }},\qquad\varepsilon = \pm 1,\  k=0,1,2,3,4.$$
where $\zeta = \zeta_5 = e^{2i\pi/5}$.

Let $\alpha$ be a root of $f$ in $\C$. There exists $\beta \in \C$ such that $\alpha = \beta - \frac{p}{5\beta}$, so
$$0 = f(\alpha) = f\left( \beta - \frac{p}{5\beta} \right) = g(\beta).$$
Since $g(\beta) = 0$, $\beta  = \beta_{k,\varepsilon}$ for some $k \in \{0,\ldots,4\}, \varepsilon \in \{-1,1\}$. If $L$ is the splitting field of $f$ in $\C$, then
$$L \subset \Q(\beta_{0,1}, \ldots,\beta_{4,1},\beta_{0,-1},\ldots, \beta_{4,-1}).$$
Write $\delta = \left(\frac{q}{2}\right)^2 + \left(\frac{p}{5}\right)^5 \in \Q$.
Since $\beta_{k,\varepsilon} \in \Q\left(\sqrt{\delta}, \zeta, \sqrt[5]{-\frac{q}{2} + \varepsilon \sqrt{\delta}}\right)$, 
$$L \subset \Q\left(\zeta_5, \sqrt{\delta}, \sqrt[5]{-\frac{q}{2} + \sqrt{\delta}},\sqrt[5]{-\frac{q}{2} - \sqrt{\delta}}\,\right),$$
where $\delta, q \in \Q$, so $L$ is included in some radical extension of $\Q$.

Therefore $f$ is solvable by radicals over $\Q$.

Note: We can choose  $\sqrt[5]{-\frac{q}{2} - \sqrt{\delta}}$ so that $ \sqrt[5]{-\frac{q}{2} + \sqrt{\delta}}\, \sqrt[5]{-\frac{q}{2} - \sqrt{\delta}}  = -\frac{p}{5} \in \Q$. Therefore
 
$$L \subset \Q\left(\zeta_{5}, \sqrt{\delta},\sqrt[5]{-\frac{q}{2} + \sqrt{\delta}} \right),$$
where the chain of inclusions
$$\Q \subset \Q(\zeta_{5}) \subset \Q\left(\zeta_{5}, \sqrt{\delta}\right) \subset \Q\left(\zeta_{5}, \sqrt{\delta},\sqrt[5]{-\frac{q}{2} + \sqrt{\delta}} \right)$$
proves that this last field is a radical extension.

\ee
\end{proof}

\paragraph{Ex. 13.2.15}

{\it As in Theorem 13.2.12, let $f = x^5 + ax+b $. Compute $\Delta(f)$ and $\theta_f(y)$.
}

\begin{proof}
With the same Sage procedure as in Exercise 14, we obtain:

\begin{verbatim}
S.<a,b,x> = QQ[]
f = x^5 + a*x + b
Delta = f.discriminant(x);Delta.factor()
\end{verbatim}
$$\Delta(f) = 256a^5+3125b^4,$$

\begin{verbatim}
K.<a,b> = QQ[]
S.<x> =PolynomialRing(K, order = 'degrevlex')
f = x^5 + a*x + b
theta_f=resolvent(f)[0];theta_f.subs(Delta = f.discriminant())
\end{verbatim}
$$\theta_f(y) =  {\left(y^{3} - 20 \, a y^{2}  + 240 \,a^{2} y + 320 \, a^{3} \right)}^{2} - 2^{10}(256 \, a^{5}  + 3125 \, b^{4}) y. $$
\end{proof}

\paragraph{Ex. 13.2.16}

{\it Let $f = x^5+ax+b \in F[x]$, where $f$ is separable and irreducible and $F$ has characteristic 5. The goal of this exercise is to prove the observation of [28] that the Galois group of $f$ over $F$ is solvable.
\be
\item[(a)] Prove that $a \ne 0$.
\item[(b)] Use Exercise 5 from Section 6.2 to show that the Galois group of $f$ over $F$ is cyclic when $a=-1$.
\item[(c)] Show that there is a Galois extension $F \subset L$ with solvable Galois group such that $f$ is equivalent (as defined in the Mathematical Notes) to a polynomial of the form $x^5 -x +b'$ for some $b' \in L$.
\item[(d)] Conclude that the Galois group of $f$ over $F$ is solvable.
\item[(e)] Show that there is a field $F$ of characteristic 5 and a monic, separable, irreducible quintic $g\in F[x]$ that cannot be transformed to one in Bring-Jerrard form defined over any Galois extension $F \subset L$ with solvable Galois group.
\ee
In [28] Ruppert explores the geometric reasons why things go wrong in characteristic 5.
}

\begin{proof}
\be
\item[(a)] If $a = 0$, then $f = x^5 +b$, so $f = x^5 - \alpha^5$, where $\alpha$ is a root of $f$ in some extension of $F$. Since the characteristic of $F$ is 5,
$f = x^5 - \alpha^5 = (x-\alpha)^5$ is not separable, in contradiction with the hypothesis, so $a \ne 0$.

\item[(b)] If $a=-1$, by Exercise 5.3.16 and 6.2.5, we know that
$$x^5 -x +b = (x-\alpha)(x- \alpha - 1)(x-\alpha-2)(x-\alpha-3)(x-\alpha-4),$$
where $\alpha$  is a root of $f$ in some extension. Then $K = F(\alpha)$ is the splitting field of $f$ over $F$.
By part (c) of exercise 6.2.5, we know also that
$$
\varphi
\left\{
\begin{array}{ccc}
  \Gal(L/F)&\to    &  \Z/5\Z \\
  \sigma& \mapsto   &   \sigma(\alpha) - \alpha    
\end{array}
\right.
$$
is a group isomorphism, so $\Gal(L/F)$ is cyclic of order 5.

\item[(c)] We search $\lambda$ such that
$$x^5 - x +b' = \lambda^{-5}((\lambda x)^5 + a (\lambda x) + b)$$
for some $b'$.

This is equivalent to
$$\lambda^5x^5 - \lambda^5x + \lambda^5 b' = \lambda^5 x^5 + a\lambda x +b,
$$
so $a \lambda = -\lambda^5 , \lambda^4 = -a$.
Let $L$ a splitting field of $x^4+a$, and choose
$$\lambda = \sqrt[4]{-a}$$
 a fixed root of $x^4 +a$ in $L$.

The characteristic is 5, so $2^2 = -1$, and
$$x^4 + a = x^4 - \lambda^4 = (x^2 + \lambda^2)(x^2-\lambda^2) = (x + 2\lambda)(x-2\lambda)(x-\lambda)(x+\lambda)$$
splits completely over $F$.  Since $\lambda \ne 0$, and since the characteristic is 5, the roots of $x^4+a$ are distinct. Therefore $L = F(\lambda)$ is the splitting field of the separable polynomial $x^4 +a$ over $F$. Hence $F \subset L = F(\lambda)$ is a Galois extension.

So there exists $\lambda$ in some solvable Galois extension $L$ of $F$ such that $x^5 - x +b' = \lambda^{-5}((\lambda x)^5 + a (\lambda x) + b)$ with $b' = (\sqrt[4]{-a})^{-5} b$, where $\lambda,b' \in L$.

\item[(d)]  If $\beta$ is in some extension of $F$, $\beta $ is a root of $f$  if and only if $ \lambda^{-1} \beta$ is a root of $x^5 - x +b'$. If $\alpha$ is a fixed root of $x^5-x+b'$, then by part (b) the roots of $x^5 -x+b'$ are $\alpha, \alpha+1,\alpha+2,\alpha+3,\alpha+4$, so the roots of $f$ are
$$\beta_0 = \lambda \alpha, \beta_1 = \lambda(\alpha+1),\beta_2 =  \lambda(\alpha +2),\beta_3= \lambda(\alpha +3), \beta_4 = \lambda (\alpha +4).$$
A splitting field of $f$ over $F$ is 
$$K = F(\beta_0,\ldots,\beta_4) = F(\lambda \alpha,\lambda(\alpha+1),\ldots,\lambda (\alpha +4)).$$
Since $\lambda = \lambda(\alpha +1) - \lambda \alpha = \beta_1 - \beta_0 \in K$, and $\alpha = (\lambda \alpha) / \lambda = \beta_0/(\beta_1 - \beta_0) \in K$, $F(\lambda,\alpha) \subset K$, and $\lambda \alpha,\ldots, \lambda(\alpha +4) \in F(\lambda,\alpha)$, so $K \subset F(\lambda,\alpha)$:
$$K = F(\lambda, \alpha)$$
is the splitting field of $f =x^5 +ax +b$ over $F$.

Since $F(\lambda) = L \subset K$, $K = L(\alpha)$.

Since $f$ is irreducible over $F$, $5 = \deg(f) = [F(\beta_0):F] \mid [K:F]$.

$\Gal(L/F)$ is isomorphic to a subgroup of $S_4$, so $5 \nmid [L:F] = |\Gal(L/F)|$.

Since $[K:F] = [K:L][L:F]$, $5 \mid [K:L] = [L[\alpha] : L]$, where $\alpha^5 -\alpha +b'= 0$. Therefore $x^5-x+b'$ is irreducible over $L$ and by part (b),
$$\Gal(K/L) \simeq \Z/5\Z \text { is cyclic}.$$

Since $F \subset L$ is a Galois extension,
$$\Gal(K/F)/\Gal(K/L) \simeq \Gal(L/F).$$
$\Gal(L/F)$ is isomorphic to a subgroup of $S_4$, so is solvable, and $\Gal(K/L)$ is cyclic, a fortiori solvable. Therefore $\Gal(K/F)$ is solvable:
\begin{center}
The Galois group of $f$ over $F$ is solvable.
\end{center}

\item[(e)] Let $F = \F_5(\sigma_1,\ldots,\sigma_5) \subset \F_5(x_1,\ldots,x_5)$.
The Galois group of $f = x^5 - \sigma_1 x^4 +\sigma_2 x^3 - \sigma_3 x^2 + \sigma_4x - \sigma_5$ is $S_5$, and $S_5$ is not solvable. Therefore $f$ cannot be equivalent to  a polynomial $x^5+ax+b$ whose Galois group over $F$ is solvable.
\ee
\end{proof}

\paragraph{Ex. 13.2.17}

{\it Following Example 13.2.14, consider the equations $x^3+3x+1 = 0$, and $y =a+bx+x^2$.
\be
\item[(a)] Use Maple or Mathematica and Section 2.3 to eliminate $x$ and obtain (13.26).
\item[(b)] Show that coefficients of $y^2$ and $y$ in (13.26) both vanish if and only if $a=2$ and $b^2+b-1 = 0$.
\item[(c)] The equation for $y$ becomes trivial to solve when $a = 2$ and $b = (\sqrt{5} - 1)/2$. We could then solve for $x$ using $y = a+b x+x^2$, but there is a better way to proceed. Note that
$$x^3 = -bx^2 -ax + yx$$
follows from $y = a+bx+x^2$. Furthermore, we can use $y =a +bx+x^2$ to eliminate the $x^2$ in the above equation. Then use $x^3+3x+1 = 0$ to obtain an equation in which $x$ appears only to the first power. Solving this gives a formula for $x$ in terms of $y$. The general version of this argument can be found in [Lagrange, p.223].
\ee
}

\begin{proof}
\be
\item[(a)] 
We eliminate $x$ between the two polynomials
\begin{align*}
f&=x^3+3x+1,\\
g&=x^2+bx+(a-y),
\end{align*}
with the resultant $\mathrm{Res}_x(f,g) = \det(S)$, where
$$
S = 
\begin{pmatrix}
1 & 0 & 1 & 0 & 0\\
0 & 1 & b & 1 & 0\\
3 & 0 & a-y & b & 1\\
1 & 3 & 0 & a-y & b\\
0 & 1 & 0 & 0 & a-y
\end{pmatrix}
$$
We can obtain this determinant with Sage:
\begin{verbatim}
R.<a,b,x,y> = QQ[]
f = x^3 + 3*x + 1
g = x^2 + b*x + (a-y)
S = matrix(R,[[1, 0, 1,   0,   0  ],
              [0, 1, b,   1,   0  ],
              [3, 0, a-y, b,   1  ],
              [1, 3, 0,   a-y, b  ],
              [0, 1, 0,   0,   a-y]])
R = S.det(); R
\end{verbatim}
$$a^{3} + 3 a b^{2} -  b^{3} - 3 a^{2} y - 3 b^{2} y + 3 a y^{2} -  y^{3}
- 6 a^{2} + 3 a b + 12 a y - 3 b y - 6 y^{2} + 9 a - 3 b - 9 y + 1$$

But it is more easy to call the method "resultant" to obtain the same result:
\begin{verbatim}
res = f.resultant(g,x);res
\end{verbatim}

The list of coefficients of $- \mathrm{Res}_x(f,g)$ is given by
\begin{verbatim}
l =[-res.subs(y=0)] +  [-res.coefficient(y^k) for k in range(1,4)]
l
\end{verbatim}
$$\left[- a^{3} - 3 a b^{2} + b^{3} + 6 a^{2} - 3 a b - 9 a + 3 b - 1,\quad 3
a^{2} + 3 b^{2} - 12 a + 3 b + 9,\quad -3 a + 6, \quad1\right]$$
We find the equation(13.26):
$$y^3 + (6-3a)y^2 + (9+3b+3b^2 - 12 a +3a^2)y + P(a,b) = 0,$$
where $P(a,b) = - a^{3} - 3 a b^{2} + b^{3} + 6 a^{2} - 3 a b - 9 a + 3 b - 1$.
\item[(b)]The coefficient of $y^2$ vanishes if $a= 2$, and then the coefficient of $y$ vanishes if
$0 = 9+3b+3b^2 - 12 a +3a^2 = 3 b + 3 b^2 -3$:
$$b^2 + b -1 = 0$$
so $b = \frac{\sqrt{5} - 1}{2}$ is a solution.

If we pick $b = (\sqrt{5}-1)/2$, then the above cubic equation becomes
$$y^3 +\frac{5}{2}\sqrt{5} - \frac{25}{2} = 0,$$
so
\begin{align*}
y^3 &= \frac{25 - 5 \sqrt{5}}{2}\\
&= \sqrt{5}^3 \, \frac{\sqrt{5} - 1}{2}.
\end{align*}
By the property of the resultant, if $y$ is evaluated to $y_0 = \omega^k\, \sqrt{5}\, \sqrt[3]{\frac{\sqrt{5} - 1}{2}}, \ {k=0,1,2}, \ {\omega = e^{2 i \pi /3}}$, then there exists a common root of $f$ and $g$ in $\C$, where
\begin{align*}
f &= x^3 + 3x +1\\
g &= x^2 + \frac{\sqrt{5} - 1}{2} x + 2 - y_0.
\end{align*}

\item[(c)] The Euclidean division of $f$ by $g$ gives
$$x^3+3x +1 = (x^2 +b x +a-y)(x -b) + (y + b^2 + 3-a) x + 1 + ab -by.$$
If $x_0$ is a common root of $f,g$, then the remainder is 0, so 
$$x_0 = \frac{by_0 - ab - 1}{y_0 + b^2 + 3 -a},$$
and this gives a formula for the roots $x_0$ of $f$  in terms of the roots $y_0$ of the resultant.

Since $y_0$ is an algebraic number of degree 3 over $\Q$, and $x_0 \in \Q(\sqrt{5},y_0)$, there exists some polynomial $p$ of degree 2 such that $x_0 = p(y_0)$. 

To find this more simple formula for $x_0$, we search the gcd of $f,g$ in the field $\Q\left (\sqrt{5},\sqrt[3]{\frac{\sqrt{5} - 1}{2}}\right)$ by the extended Euclid's algorithm.

This is obtained with the following Sage instructions:
\begin{verbatim}
K.<u>= QQ[sqrt(5)]
R.<z> = K[]
res = z^3 - (u-1)/2
L.<w> = K.extension(res)
A.<x> = L[]
f = x^3 + 3*x + 1
g = x^2 + (u - 1)/2 * x + (2 - u*w)
gcd(f,g)
\end{verbatim}
$$x + \left(\frac{1}{2} \sqrt{5} + \frac{1}{2}\right) w^{2} - w
$$
We have obtained that
$$\gcd(f,g) = x +\frac{\sqrt{5} + 1}{2} \, w^{2} - w, \text{ where } w^3 =\frac{\sqrt{5} - 1}{2}.$$
Since $w^3 =\frac{\sqrt{5} - 1}{2}$, so  $w^2 = \frac{\sqrt{5} - 1}{2} w^{-1}$, $\frac{\sqrt{5} + 1}{2} w^2 = w^{-1}$.

 Therefore the roots of $f$ are
\begin{align*}
x_0 &= w - \frac{\sqrt{5} + 1}{2} w^2\\
&= w - w^{-1}
\end{align*}
We can write $w = \omega^k \sqrt[3]{\frac{\sqrt{5}-1}{2}}, k = 0,1,2$, then  $w^{-1} = \omega^{2k} \sqrt[3]{\frac{\sqrt{5}+1}{2}}$, where the cubic roots are chosen so that their product is real, equal to 1. Then
$$ \omega^k \,\sqrt[3]{\frac{\sqrt{5}-1}{2}} - \omega^{2k}\, \sqrt[3]{\frac{\sqrt{5}+1}{2}},\qquad k=0,1,2$$
are the roots of $f$. This is identical to the formulas obtained with Cardano's formulas, with more sweat.
\ee
\end{proof}

\paragraph{Ex. 13.2.18}
{\it This exercise is concerned with the polynomials (13.28). As in the Historical Notes, we will assume that they lie in $\Q[x]$ and are irreducible.
\be
\item[(a)] Show that $\sqrt[5]{Q^2/P} + (P/Q)\sqrt[5]{Q^2/P}^2$ is a root of $x^5 - 5Px^2 - 5Qx - Q^2/P -P^3/Q$.
\item[(b)] Prove that the Galois group of $x^5 - 5Px^2 - 5Qx - Q^2/P - P^3/Q$ over $\Q$ is isomorphic to $AGL(1,\F_5)$.
\item[(c)] Prove that over $\Q(\sqrt{5})$, the first two polynomials of (13.28) have cyclic Galois group while the third has Galois group isomorphic to $\mathrm{AGL}(1,\F_5) \cap A_5$.
\ee
}

\begin{proof}
\be
\item[(a)] As in Cardan's method, we substitute $u+v$ to $x$ in $$f(x)= x^5 - 5Px^2 - 5Qx - \frac{Q^{2}}{P} -\frac{P^{3}}{Q}.$$ We obtain
\begin{align*}
f(u+v) &= u^{5} + 5 \, u^{4} v + 10 \, u^{3} v^{2} + 10 \, u^{2} v^{3} + 5 \, uv^{4} + v^{5} \\
&\phantom{= }- 5 \, P u^{2} - 10 \, P u v - 5 \, P v^{2}  - 5 \, Q u - 5 \, Q v  - \frac{Q^{2}}{P} -\frac{P^{3}}{Q}\\
&= \left(u^5 + v^5 - \frac{Q^{2}}{P} -\frac{P^{3}}{Q}\right)+ 5 \, {\left(u^{3} v + u^{2} v^{2} + u v^{3} - P u - P v - Q\right)} {\left(u + v\right)}.\\
\end{align*}
Then we verify that $u = \sqrt[5]{Q^2/P} = P^{-\frac{1}{5}} Q^{\frac{2}{5}}, v = (P/Q)\sqrt[5]{Q^2/P}^2 = P^{\frac{3}{5}} Q^{-\frac{1}{5}}$ is a solution of the system
\begin{align*}
0 &= u^5 + v^5 - \frac{Q^{2}}{P} -\frac{P^{3}}{Q},\\
0 &= u^{3} v + u^{2} v^{2} + u v^{3} - P u - P v - Q.
\end{align*}
Indeed
$$u^5 +v^5 -\frac{Q^{2}}{P} -\frac{P^{3}}{Q} = \frac{Q^2}{P} + \frac{P^3}{Q}-  \frac{Q^{2}}{P} -\frac{P^{3}}{Q} = 0,$$
and, since $P = uv^2, Q = u^3v$,
\begin{align*}
u^{3} v + u^{2} v^{2} + u v^{3} - P u - P v - Q=u^3 v +u^2v^2+uv^3 - u^2v^2 - uv^3 - u^3v = 0.
\end{align*}
Therefore $$u + v = \sqrt[5]{Q^2/P} + (P/Q)\sqrt[5]{Q^2/P}^2$$ is a root of $x^5 - 5Px^2 - 5Qx - Q^2/P -P^3/Q$.
If we replace $\sqrt[5]{Q}$ by another fifth root $\zeta^k \sqrt[5]{Q},\ k=1,2,3,4,$ (where $\zeta = e^{2i\pi/5}$), in the equation
$$0 = u^{3} v + u^{2} v^{2} + u v^{3} - P u - P v - Q, \qquad \text{where } u= \sqrt[5]{P}^{-1}\sqrt[5]{Q}^2, v = \sqrt[5]{P}^3 \sqrt[5]{Q}^{-1},$$
then $u$ is replaced by $\zeta^{2k}u$, and $v$ is replace by $\zeta^{4k} v$, therefore $\zeta^{2k}  u , \zeta^{4k} v$ is a solution of the preceding system, so $\zeta^{2k}  u + \zeta^{4k} v$ is also a root of $f$.
So $$u+v,\quad \zeta^2 u + \zeta^4 v, \quad\zeta^4 u + \zeta^3 v,\quad \zeta u + \zeta^2 v,\quad \zeta^3 u + \zeta v,$$
are roots of $f$, where 
$$u = \sqrt[5]{Q^2/P} ,\qquad  v = (P/Q)\sqrt[5]{Q^2/P}^2 .$$ 
These roots are the five roots of $f$, as proved in the following expansion:
\begin{align*}
& (x - (u+v))(x- (\zeta^2 u + \zeta^4 v))(x- (\zeta^4 u + \zeta^3 v))(x-(\zeta u + \zeta^2 v))(x- (\zeta^3 u + \zeta v))\\
 &= x^5 -5 uv^2 x^2 -5 u^3v x -u^5-v^5.
\end{align*}
Since 
$$P = uv^2, \qquad Q = u^3 v,$$
we obtain 
$$u^5 = \frac{Q^2}{P},\qquad v^5 = \frac{P^3}{Q},$$
so
\begin{align*}
f &= x^5 - 5Px^2 - 5Qx - \frac{Q^{2}}{P} -\frac{P^{3}}{Q}\\
&=(x - (u+v))(x- (\zeta^2 u + \zeta^4 v))(x- (\zeta^4 u + \zeta^3 v))(x-(\zeta u + \zeta^2 v))(x- (\zeta^3 u + \zeta v))
\end{align*}

Therefore the roots of $f$ are $\zeta^{2k} u + \zeta^{4k} v,\ k=0,1,2,3,4$.

This was perhaps the Euler's starting point.

\item[(b)] We obtain the discriminant of $f$ with
\begin{verbatim}
R.<P,Q,u,v,e,x> = QQ[]
f = x^5 - 5*P*x^2 - 5*Q*x -e;
Delta = f.discriminant(x).subs(e = Q^2/P + P^3/Q).factor()
Delta
\end{verbatim}
$$\left(3125\right) \cdot Q^{-4} \cdot P^{-4} \cdot (- P^{8} - 11 P^{4}
Q^{3} + Q^{6})^{2}
$$
so
$$\Delta = 5^5 \frac{(P^8 +11 P^4 Q^3 -Q^6)^2}{P^4Q^4}.$$
Thus $\Delta$ is not a square in $\Q$.

Using the resolvent() function of Exercise 14, we obtain the sextic resolvent:
\begin{verbatim}
K.<P,Q,e> = QQ[]
S.<x> =PolynomialRing(K, order = 'degrevlex')
f = x^5 - 5*P*x^2 - 5*Q*x -e
theta = resolvent(f)[0]; theta.subs(e = Q^2/P + P^3/Q)
\end{verbatim}
\begin{align*}
\theta_f(y) &=  {   \left( 100 \, Q y^{2} + y^{3} + 2000 \, {\left( 3 \,Q^{2}-\left(P^4+Q^3\right)/Q \right)} y\right)}^{2} - 1024 \, \Delta(f) y\\
&=  {   \left( y^{3} +100 \, Q y^{2}  - 2000 \, {\left(\frac{P^{4}}{Q} - 2 \,Q^{2}\right)} y\right)}^{2} - 1024 \, \Delta(f) y,
\end{align*}
which has root $0 \in \Q$ ($b_6 = 0$).
By Section 13.2, the Galois group of $f$ is $\mathrm{AGL}(1,\F_5)$ up to conjugacy.

\item[(c)]  By Exercise 13, we know that the Galois group of $x^5 - 2$ over $\Q(\sqrt{5})$ is $\mathrm{AGL}(1,\F_5)\cap A_5$ which is not cyclic, so there is a misprint in the sentence. 

   \be 
\item[$\bullet$] The polynomial $f = x^5 - D \in \Q(\sqrt{5})[x], D \in \Q$, is irreducible over $\Q$ by hypothesis. Let $\alpha$ be a root of $f$. Since $[\Q(\alpha) : \Q] = 5$ and $[\Q(\sqrt{5}) : \Q] = 2$, we obtain that $10 = 2 \times 5$ divides $[\Q(\sqrt{5},\alpha) : \Q]$, where $[\Q(\sqrt{5},\alpha) : \Q] \leq 10$. Therefore 
$$10 = [\Q(\sqrt{5},\alpha) : \Q] = [\Q(\sqrt{5},\alpha) : \Q(\sqrt{5})] [\Q(\sqrt{5}):\Q],$$
 so $[\Q(\sqrt{5},\alpha) : \Q(\sqrt{5})] = 5$. If $p$ is the minimal polynomial of $\alpha$ over $\Q(\sqrt{5})$, then $\deg(p) = [\Q(\sqrt{5},\alpha) : \Q(\sqrt{5})] = 5$, and $p$ divides $f$, therefore $p = f$, and we have proved that $f$ is irreducible over $\Q(\sqrt{5})$.
 
Moreover
$$\Delta(f) = 5^5 D^4  = (5^2 D^2 \sqrt{5})^2$$
 is a square in $\Q(\sqrt{5})$, and $0 \in \Q(\sqrt{5})$ is a root of the resolvent
$$\Theta_f(y) = y^6 - \Delta(f) y.$$
If $\alpha = \sqrt[5]{D} \in \R$, and $\zeta = \zeta_5$, then 
$$x^5 - D = (x - \alpha)(x-\zeta \alpha)(x-\zeta^2 \alpha)(x-\zeta^3 \alpha)(x-\zeta^4 \alpha).$$
But $\zeta \alpha \not \in \R$, so $\zeta \alpha \not \in \Q(\sqrt{5})(\alpha) \subset \R$. $f$ doesn't split completely over $F(\alpha)$, where $\alpha$ is a root of $f$. By Theorem 13.2.6 and the table 13.2.C, 
$$\Gal(L/\Q(\sqrt{5})) \simeq \mathrm{AGL}(1,\F_5)\cap A_5,$$
where $L$ is the splitting field of $x^5 - D$.
 
 \item[$\bullet$] Now $f= x^5 - 5Px^2-5Qx-\frac{Q^2}{P} - \frac{P^3}{Q}$, and $f$ is assumed irreducible over $\Q$.
 
With the same proof as in the first bullet, $f$ remains irreducible over $\Q(\sqrt{5})$.
 
 By part (b), 
  $$\Delta = 5^5 \frac{(P^8 +11 P^4 Q^3 -Q^6)^2}{P^4Q^4}$$
 is a square in $\Q(\sqrt{5})$, and
 $$\theta_f(y) =  {   \left( y^{3} +100 \, Q y^{2}  - 2000 \, {\left(\frac{P^{4}}{Q} - 2 \,Q^{2}\right)} y\right)}^{2} - 1024 \, \Delta(f) y,$$
 has root $0 \in \Q(\sqrt{5})$.
 By part (a),
\begin{align*}
f &= x^5 - 5Px^2 - 5Qx - \frac{Q^{2}}{P} -\frac{P^{3}}{Q}\\
&=(x - (u+v))(x- (\zeta^2 u + \zeta^4 v))(x- (\zeta^4 u + \zeta^3 v))(x-(\zeta u + \zeta^2 v))(x- (\zeta^3 u + \zeta v))
\end{align*}
We prove that $\alpha_2 = \zeta^2u + \zeta^4v$ is not real. If $\alpha_2 \in \R$, then $\alpha_2 = \overline{\alpha_2}$, so $(\zeta^2 - \zeta^3)u + (\zeta^4 - \zeta) v = 0$. 

Then, using $\sqrt{5} = \zeta - \zeta^2 - \zeta^3 + \zeta^4$ and $\zeta^2 + \zeta^3 = \frac{-1 + \sqrt{5}}{2}$,
\begin{align*}
\frac{v}{u} &= \frac{\zeta^2 - \zeta^3}{\zeta - \zeta^4} = \frac{\zeta - \zeta^2}{1 - \zeta^3}\\
&=\frac{(\zeta - \zeta^2)(1 - \zeta^2)}{(1 - \zeta^3)(1-\zeta^2)}\\
&= \frac{\zeta - \zeta^2 - \zeta^3 + \zeta^4}{1 - (\zeta^2+\zeta^3) + \zeta^5}\\
&= \frac{\sqrt{5}}{2 +\frac{1+\sqrt{5}}{2}}\\
&= \frac{\sqrt{5}-1}{2}
\end{align*}
Since  $\frac{v}{u} = \frac{P}{Q} \sqrt[5]{\frac{Q^2}{P}} $, we would have $\sqrt[5]{\frac{Q^2}{P}} \in \Q(\sqrt{5})$, and then the root $\alpha_1 = u + v\in \Q(\sqrt{5})$, in contradiction with the irreducibility of $f$ over $\Q(\sqrt{5})$.

So $\alpha_2 \not \in \R$ is not in the field $\Q(\sqrt{5})(\alpha_1)$, and $f$ doesn't split completely over $\Q(\sqrt{5})(\alpha_1)$.

By the table 13.2.C, $\Gal(L/\Q(\sqrt{5}) \simeq \mathrm{AGL}(1,\F_5)\cap A_5$.

 \item[$\bullet$] The third Euler's polynomial is $f = x^5 - 5Px^3 + 5P^2 x - D$.
   
   If $p = -5P,q = -D$, we obtain $f = x^5+ p x^3 +\frac{1}{5} p^2x +q$, which is Example 13.2.10. We know from this example and from Exercise 14 that the Galois group of $f$ over $\Q$ is $\mathrm{AGL}(1,\F_5)$.
  
With the same proof as in the first bullet, $f$ remains irreducible over $\Q(\sqrt{5})$.
 
 By Exercise 14,
 $$
\Delta(f) =\frac{1}{5^5} \cdot (4 p^{5} + 3125 q^{2})^{2}
$$
is a square in the field $\Q(\sqrt{5})$, and 
$$\theta_f(y) = \left(y^3-7 \, p^{2}y^2+11 p^{4}y+\frac{3}{25} \, p^{6} + 4000 \, p q^{2}\right)^2 - 2^{10}\Delta(f) y
$$
has the root $5p^2 \in \Q$.

It remains to know if $f$ splits completely over $\Q(\sqrt{5})$.

   Note that
   $$f(u+v) = u^5 + v^5 + q + (u^2 + uv + v^2 +\frac{p}{5})(5 uv +p)(u+v).$$
   Therefore if $uv = -\frac{p}{5}$, $f(u + v) = u^5 +v^5 +q$, so we find (see Exercise 14) that
   $$f\left(z - \frac{p}{5z}\right) = z^5 - \frac{p^5}{5^5 z^5} + q.$$
  
   So $u+v$ is a root of $f$ if 
   $$
\left\{
\begin{array}{rcc}
  u^5 + v^5 &   = & -q  = D \\
  uv &   = &  -\frac{p}{5}  =P 
\end{array}
\right.
   $$
   Therefore $u^5, v^5$ are the roots of $x^2 + qx -(\frac{p}{5})^5$ and satisfy $uv = -p/5 \in \Q$. If $u+v$ is a root, so is $\zeta^k u + \zeta^{-k} v, \ k \in \Z$ (where $\zeta = \zeta_5 = e^{2i\pi/5}$).
  
   
   Conversely
  \begin{align*}
  &(x - u-v) (x - \zeta u - \zeta^{-1}v)(x - \zeta^2 u - \zeta^{-2}v)(x - \zeta^3 u - \zeta^{-3}v)(x - \zeta^4 u - \zeta^{-4}v) \\
  &= x^5 -5 uv x^3 + 5u^2v^2 x - u^5 -v^5\\
  &= x^5 -5 Px^3 + 5 P^2 x - D
  \end{align*}
  
  So the roots of $f =x^5 -5 Px^3 + 5 P^2 x - D = x^5+ p x^3 +\frac{1}{5} p^2x +q$ are
  $$u + v,\quad \zeta u + \zeta^{-1}v,\quad \zeta^2 u + \zeta^{-2}v, \quad \zeta^3 u + \zeta^{-3}v, \quad \zeta^4 u + \zeta^{-4}v,$$
  where $(u,v)$ is a solution of the system
  $$ uv = P = -\frac{p}{5},\qquad u^5 + v^5 = D = -q,$$
  so
  \begin{align*}
  u &= \sqrt[5] {-\frac{q}{2} + \sqrt{\left(\frac{q}{2} \right)^2 + \left(\frac{p}{5} \right)^5}},\\
  v &= \sqrt[5] {-\frac{ q}{2} - \sqrt{\left(\frac{q}{2} \right)^2 + \left(\frac{p}{5} \right)^5}},\\
  \end{align*}
  (where we choose the real roots, so $u,v \in \R$). 
  
  We obtained the factorization  of $f$:
\begin{align*}
f &= x^5 -5 Px^3 + 5 P^2 x - D\\
&= (x - u-v) (x - \zeta u - \zeta^{-1}v)(x - \zeta^2 u - \zeta^{-2}v)(x - \zeta^3 u - \zeta^{-3}v)(x - \zeta^4 u - \zeta^{-4}v)
\end{align*}
 If the root $\alpha_2 = \zeta u + \zeta^{-1}v$ is real, then $u=v$, so $\left(\frac{q}{2} \right)^2 + \left(\frac{p}{5} \right)^5 = 0$, and this imply $\Delta(f) = 0$, in contradiction with the assumed separability of $f$.
 
 Therefore $\alpha_2 \not \in \Q(\sqrt{5})(\alpha_1) \subset \R$, where $\alpha_1= u + v \in \R$ is a root of $f$, so $f$ doesn't split completely over $\Q(\sqrt{5})(\alpha_1)$.
 
$\Gal(L/\Q(\sqrt{5}))$ is isomorphic to $\mathrm{AGL}(1,\F_5)\cap A_5$.
  
  \ee 
We obtained the same Galois group for the 3 Euler's polynomials of (13.28).
\ee
\end{proof}

\paragraph{Ex. 13.2.19}

{\it Use the methods of this section to compute the Galois group over $\Q$ of each of the following polynomials. Be sure to check that they are irreducible. Remember that in Section 4.2 we learned how to factor polynomials over a finite extension of $\Q$.
\be
\item[(a)] $x^5+x+1$.
\item[(b)] $x^5 + 20x + 16$.
\item[(c)] $x^5 + 2$.
\item[(d)] $x^5 - 5x + 12$.
\item[(e)] $x^5 + x^4 - 4x^3 - 3x^2 + 3x + 1$.
\ee
}

\begin{proof}
We use the Exercise 14 resolvent() procedure to compute a sextic resolvent, and the additional procedure to verify that this resolvent has a rational root
(the polynomials are supposed, as in this exercise, monic with integer coefficients, i.e., $f\in \Z[x]$, hence resolvent rational root is an integer):
\begin{verbatim}
def rational_root(theta):
    n = Integer(theta.subs(y=0)) 
    if n == 0:
        return True, 0
    for d in n.divisors():    
        if theta.subs(y = d) == 0:
            return True, d
        if theta.subs(y = -d)== 0:
            return True, -d
    return False, None
\end{verbatim}
\be
\item[(a)]
\begin{verbatim}
R.<x> = QQ[]
f = x^5 + x + 1;f
\end{verbatim}
$$x^{5} + x + 1$$
\begin{verbatim}
f.is_irreducible()
\end{verbatim}
$$\text{False}$$
\begin{verbatim}
f.factor()
\end{verbatim}
$$f = (x^{2} + x + 1) \cdot (x^{3} - x^{2} + 1)$$
The roots of $x^2+x+1$ are $\omega, \omega^2$. Write $x_1,x_2,x_3$ the roots of $x^3 - x^2 + 1$. Then $L = \Q(\omega, x_1,x_2,x_3)$ is the splitting field of $f$ over $\Q$. As $L = \Q(\omega)(x_1,x_2,x_3)$, $L$ is also the splitting field of $g = x^3 - x^2 +1$ over $\Q(\omega)$. The discriminant of $g$ is $\Delta(g) = -23$. We show that $-23 \not \in \Q(\omega)^2$.

If $-23 = (a+b\omega)^2,\ a,b \in \Q$, then $-23  = a^2 - b^2 - \omega b(b - 2a)$. Therefore
$$
\left\{
\begin{array}{rcl}
 -23  &   =  &  a^2 - b^2, \\
  0   &  =   &      b(b- 2a).
\end{array}
\right.
$$
Thus $b = 0$ or $b = 2a$. If $b = 0$, then $-23 = a^2$, which is impossible since $a \in \Q$, and $b = 2a$ gives $a^2 = 23/3$, which is also impossible. Therefore $\Delta(g)$ is not a square in $\Q(\omega)$, so the Galois group $G_1$ of $g$ over $\Q(\omega)$ is $S_3$. This implies that $[L : \Q(\omega)] = |G_1| = 6$. Since $[\Q(\omega):\Q]=2$, $[L:\Q] = 12$, so the Galois group $G$ of $f = x^5 + x +1$ has order $12$:
$$|G| = 12.$$

Since $-23$ is not a square of $\Q$, $\Gal(\Q(x_1,x_2,x_3)/\Q) \simeq S_3$.

Let
$$
\varphi
\left\{
\begin{array}{ccc}
 \Gal(L/\Q) & \to   &\Gal(\Q(x_1,x_2,x_3)/\Q)  \times  \Gal(\Q(\omega)/\Q)  \\
 \sigma & \mapsto  &    \left (\ \sigma|_{\Q(x_1,x_2,x_3)},\ \sigma |_{\Q(\omega)}\right).
\end{array}
\right.
$$

Then $\varphi$ is a group homomorphism, and the kernel of $\varphi$ is $\{\mathrm{id}\}$, since every $\Q$-automorphism of $L$ which fixes $\omega,x_1,x_2,x_3$ is the identity of $L$.
So $\varphi$ is injective, and $|\Gal(L/\Q)| = |\Gal(\Q(\omega)/\Q) \times \Gal(\Q(x_1,x_2,x_3)/\Q)| = 12$, thefore $\varphi$ is a group isomorphism.
$$\Gal(L/\Q) \simeq \mathrm{C}_2 \times S_3.$$

If we choose the numbering $x_1,x_2,x_3,x_4 = \omega, x_5 = \omega^2$ of the roots of $f$, then the Galois group $G$ of $f$ is
$$G = \Gal_{\Q}(f) = \langle (1\, 2), (1\,2\,3), (4 \, 5) \rangle \simeq S_3 \times C_2.$$

\item[(b)] 
\begin{verbatim}
R.<x> = QQ[]
f = x^5 + 20 *x + 16;f
\end{verbatim}
$$	
x^{5} + 20 x + 16
$$
\begin{verbatim}
f.is_irreducible()
\end{verbatim}
$$\text{True}$$
\begin{verbatim}
theta = resolvent(f)[0]; theta.subs(Delta = f.discriminant()).expand()
\end{verbatim}
$$y^{6} - 800 \, y^{5} + 352000 \, y^{4} - 71680000 \, y^{3} + 7168000000
\, y^{2} - 557056000000 \, y + 6553600000000
$$
\begin{verbatim}
res = rational_root(theta); res
\end{verbatim}
$$\text{(False, None)}$$
\begin{verbatim}
f.discriminant().factor(),f.discriminant().is_square()
\end{verbatim}

$$(2^{16} \cdot 5^{6}, \text{True})$$

Thus the Galois group of $f = x^5+20x+16$ over $\Q$ is $A_5$.

Verification:
\begin{verbatim}
f.galois_group().gens()
\end{verbatim}
$$\langle(3,4,5),(1,2,3,4,5)\rangle$$

\item[(c)]
\begin{verbatim}
R.<x> = QQ[]
f = x^5 + 2;f
\end{verbatim}
$$	
x^{5} + 2
$$
\begin{verbatim}
f.is_irreducible()
\end{verbatim}
$$\text{True}$$
\begin{verbatim}
theta = resolvent(f)[0]; theta.subs(Delta = f.discriminant()).expand()
\end{verbatim}
$$y^{6} - 51200000 \, y
$$
\begin{verbatim}
res = rational_root(theta); res
\end{verbatim}
$$\text{(True, 0)}$$
\begin{verbatim}
f.discriminant().factor(),f.discriminant().is_square()
\end{verbatim}
$$(2^{4} \cdot 5^{5}, \text{False})
$$

Thus the Galois group of $f = x^5+2$ over $\Q$ is $\mathrm{AGL}(1,\F_5)$, up to conjugacy.

Verification:
\begin{verbatim}
f.galois_group().gens()
\end{verbatim}
$$	
\langle (1,2,3,4,5), (1,2,4,3) \rangle
$$

\item[(d)]
\begin{verbatim}
R.<x> = QQ[]
f = x^5 -5*x + 12;f
\end{verbatim}
$$	
x^{5} - 5x + 12
$$
\begin{verbatim}
f.is_irreducible()
\end{verbatim}
$$\text{True}$$
\begin{verbatim}
theta = resolvent(f)[0]; theta.subs(Delta = f.discriminant()).expand()
\end{verbatim}
$$y^{6} + 200 \, y^{5} + 22000 \, y^{4} + 1120000 \, y^{3} + 28000000 \,
y^{2} - 66016000000 \, y + 1600000000
$$
\begin{verbatim}
res = rational_root(theta); res
\end{verbatim}
$$\text{(True, 100)}$$
\begin{verbatim}
f.discriminant().factor(),f.discriminant().is_square()
\end{verbatim}

$$(2^{12} \cdot 5^{6}, \text{True})$$
\begin{verbatim}
K.<alpha> = NumberField(f)
S.<X> = K[]
g = f.change_ring(S)
g.factor()
\end{verbatim}
\begin{align*}
&(x - \alpha)
 \cdot \left(x^{2} + \left(\frac{1}{4} \alpha^{4} + \frac{1}{4}
\alpha^{3} + \frac{1}{4} \alpha^{2} + \frac{1}{4} \alpha - 1\right) x -
\frac{1}{2} \alpha^{3} - \frac{1}{2} \alpha - 1\right)\\
& \cdot \left(x^{2} +\left(-\frac{1}{4} \alpha^{4} - \frac{1}{4} \alpha^{3} - \frac{1}{4}
\alpha^{2} + \frac{3}{4} \alpha + 1\right) x - \frac{1}{4} \alpha^{4} -
\frac{1}{4} \alpha^{3} - \frac{1}{4} \alpha^{2} - \frac{5}{4} \alpha +
2\right)
\end{align*}

Thus the Galois group of $f = x^5+20x+16$ over $\Q$ is $\mathrm{AGL}(1,\F_5) \cap A_5$, up to conjugacy.

Verification:
\begin{verbatim}
f.galois_group().gens()
\end{verbatim}
$$	
\langle (1,2,3,4,5), (1,4)(2,3) \rangle
$$

\item[(e)]
\begin{verbatim}
R.<x> = QQ[]
f = x^5 + x^4 - 4*x^3 - 3*x^2 + 3*x + 1
f
\end{verbatim}
$$	
x^{5} + x^{4} - 4 x^{3} - 3 x^{2} + 3 x + 1
$$
\begin{verbatim}
f.is_irreducible()
\end{verbatim}
$$\text{True}$$
\begin{verbatim}
theta = resolvent(f)[0]; theta.subs(Delta = f.discriminant()).expand()
\end{verbatim}
$$y^{6} - 264 \, y^{5} + 25168 \, y^{4} - 1022208 \, y^{3} + 14992384 \,
y^{2} - 14992384 \, y
$$
\begin{verbatim}
res = rational_root(theta); res
\end{verbatim}
$$\text{(True, 0)}$$
\begin{verbatim}
f.discriminant().factor(),f.discriminant().is_square()
\end{verbatim}

$$(11^4, \text{True})$$
\begin{verbatim}
K.<alpha> = NumberField(f)
S.<X> = K[]
g = f.change_ring(S)
g.factor()
\end{verbatim}
\begin{align*}
(x - \alpha) \cdot (x - \alpha^{2} + 2) \cdot (x + \alpha^{4} +
\alpha^{3} - 3 \alpha^{2} - 2 \alpha + 1) \cdot (x - \alpha^{3} + 3
\alpha) \cdot (x - \alpha^{4} + 4 \alpha^{2} - 2)
\end{align*}

Thus the Galois group of $f = x^5+20x+16$ over $\Q$ is $\langle (1\,2\,3\,4\,5) \rangle$, up to conjugacy.

Verification:
\begin{verbatim}
f.galois_group().gens()
\end{verbatim}
$$	
\langle (1,2,3,4,5) \rangle
$$
\ee
\end{proof}

\paragraph{Ex. 13.2.20}

{\it In the Mathematical Notes to Section 10.3, we noted that the roots of the polynomial $x^5 - 4x^4 + 2x^3 + 4x^2 + 2x - 6 \in \Q[x]$ can be constructed using a marked ruler and compass. Show that this polynomial is not solvable by radicals over $\Q$.
}

\begin{proof}
With the same procedures as in Exercise 19, we obtain
\begin{verbatim}
R.<x> = QQ[]
f = x^5 - 4*x^4 + 2*x^3 + 4 *x^2 + 2*x -6;f
\end{verbatim}
$$x^{5} - 4 x^{4} + 2 x^{3} + 4 x^{2} + 2 x - 6$$

\begin{verbatim}
f.is_irreducible()
\end{verbatim}
$$\text{True}$$

\begin{verbatim}
theta = resolvent(f)[0]; theta.subs(Delta = f.discriminant()).expand()
\end{verbatim}
$$y^{6} - 360 \, y^{5} + 47856 \, y^{4} - 3025152 \, y^{3} + 103474944 \,
y^{2} - 1812875264 \, y + 14770999296
$$
\begin{verbatim}
res = rational_root(theta); res
\end{verbatim}
$$\text{(False, None)}$$
\begin{verbatim}
f.discriminant().factor(),f.discriminant().is_square()
\end{verbatim}
$$(-1 \cdot 2^{4} \cdot 4003, \text{False})$$
So the Galois group of $f$ is $S_5$, and $f$ is not solvable by radicals over $\Q$.

Verification:
\begin{verbatim}
f.galois_group().gens()
\end{verbatim}
$$\langle (1,2), (1,2,3,4,5) \rangle
$$
\end{proof}

\subsection{Resolvents}

\paragraph{Ex. 13.3.1}

{\it Let $f(x) \in \Q[x]$.
\be
\item[(a)] Prove that there are $\lambda, \mu \in \Q^*$ such that $g(x)=\lambda f(\mu x)\in\Z[x]$ is monic.
\item[(b)] Prove that f and g have isomorphic Galois groups over $\Q$.
\ee
\begin{proof}
\item[(a)] Let $f(x)=\frac {a_0}{b_0}x^n+\frac {a_1}{b_1}x^{n-1}+...+\frac {a_n}{b_n}=\sum_{i=0}^n \frac {a_i}{b_i}x^{n-i}$, where $a_i,b_i \in \Z$, and $\nu=\mathrm{lcm}(b_0,b_1,...,b_n)$, then $\nu f(x)=\sum_{i=0}^n \frac {a_i}{b_i}\nu x^{n-i}=\sum_{i=0}^n c_i x^{n-i}$, where $c_i=\frac {a_i}{b_i}\nu \in \Z$.

After multiplication by $c_0^{n-1}$ we have $$c_0^{n-1}f(x)=\sum_{i=0}^n c_i c_0^{n-1} x^{n-i}=(c_0 x)^n+\sum_{i=1}^n c_i c_0^{i-1} (c_0 x)^{n-i}=g(c_0 x), ~ c_i c_0^{i-1} \in \Z.$$ Hence $g(x)$ is monic   and $g(x)=\lambda f(\mu x)\in\Z[x]$, where $\lambda=c_0^{n-1}\nu,\mu=1/c_0, c_0=\frac{a_0}{b_0} \nu$, i.e. $\lambda,\mu \in \Q^*$.

 \item[(b)] If $\alpha_1,\ldots,\alpha_n$ are the roots of $f$ in a splitting field $L = \Q(\alpha_1,\ldots,\alpha_n)$ of $f$ over $\Q$, then $\beta_1 = \alpha_1/\mu,\ldots,\beta_n = \alpha_n/\mu$ are the roots of $g$ in $L$, which splits completely over $L$, so $L$ is also a splitting field of $g$.
 Then 
 $$G_f \simeq \Gal(L/F) \simeq G_g.$$
 Thus the Galois groups $G_f, G_g$ of $f,g$ over $\Q$ are isomorphic.
 
Note: If $\tau \in G_f \subset S_n$ corresponds to $\sigma$ for a given numbering of the roots $\alpha_1,\ldots,\alpha_n$ of $f$, for the corresponding numbering $\beta_1,\ldots,\beta_n$,  $\tau \in G_g$, so $G_f = G_g$ for these chosen numbering.

\end{proof}
}

\paragraph{Ex. 13.3.2}

{\it Let $f(x)=x^n-c_1x^{n-1}+...+(-1)^n c_n \in \Z[x]$, and let $\Theta_f(y)$ be the resolvent built from $\varphi \in \Z [x_1,...,x_n]$. Prove that $\Theta_f(y) \in \Z[y]$.

\begin{proof}
Let $G$ be the symmetry group of $\varphi$ and $\tau_1,...,\tau_l$ be representatives for the left cosets of $G$ in $S_n$. The universal resolvent is $\Theta(y)=\prod_{i=1}^l ( y - (\tau_i \cdot\varphi)(x_1,...,x_n))$. Since $\varphi \in \Z [x_1,...,x_n]$, for each $i, 1\leq i \leq l$, $(\tau_i\cdot\varphi)(x_1,...,x_n)\in \Z [x_1,...,x_n]  $, hence the coefficients of $\Theta(y)$ are in $\Z [x_1,...,x_n]  $, i.e., $\Theta(y)\in \Z [x_1,...,x_n][y]  $.

Suppose that $\sigma \in S_n$, then $(\sigma\cdot \Theta)(y)=\prod_{i=1}^l ( y - (\sigma\tau_i)\cdot \varphi(x_1,...,x_n))$. But the set $\sigma\tau_1,...,\sigma\tau_l$ is also a set of left coset representatives of $G$ in $S_n$. Thus the application of $\sigma$ has merely permuted the roots of $\Theta(y)$ leaving the coefficients fixed. It means that coefficients of $\Theta(y)$ are symmetric and are polynomials in $\sigma_1,...,\sigma_n$ with integers coefficients (cf. Ex.9.1.6), i.e., $\Theta(y)\in \Z [\sigma_1,...,\sigma_n][y]  $.
The application of evaluation map $x_i \mapsto \alpha_i$ to $\Theta(y)$,  so that $\sigma_i \mapsto c_i$, gives $\Theta_f(y) \in \Z [c_1,...,c_n][y] = \Z[y]$.
\end{proof}
}

\paragraph{Ex. 13.3.3}

{\it In the proof of proposition 13.3.2, we asserted that $$\varphi (\alpha_1,...,\alpha_n)=\varphi (\alpha_{\tau(1)},...,\alpha_{\tau(n)})$$ follows from $\beta=\varphi (\alpha_1,...,\alpha_n) \in F$ and $\tau \in G_f$. Prove this.

\begin{proof}
Let $\sigma \in \Gal(L/F)$ corresponding to $\tau \in G_f$, so that  $\sigma(\alpha_i) = \alpha_{\tau(i)}, \ i= 1,\ldots,n$. 

Since F is fixed for $\sigma$, and $\beta = \varphi (\alpha_1,...,\alpha_n)  \in F$, $\beta = \sigma(\beta)$, so that
$$\varphi (\alpha_1,...,\alpha_n) = \sigma(\varphi (\alpha_1,...,\alpha_n)).$$ 
Moreover
\begin{align*}
\sigma(\varphi (\alpha_1,...,\alpha_n))&= \varphi(\sigma(\alpha_1),\ldots,\sigma(\alpha_n)\\
&=\varphi (\alpha_{\tau(1)},...,\alpha_{\tau(n)}). 
\end{align*}
Therefore, $\varphi (\alpha_1,...,\alpha_n)=\varphi (\alpha_{\tau(1)},...,\alpha_{\tau(n)})$ for $\varphi (\alpha_1,...,\alpha_n) \in F$ and $\tau \in G_f$.
\end{proof}
}

\paragraph{Ex. 13.3.4}

{\it As in Examples 13.3.3 and 13.3.4, let $\varphi=\sqrt{\Delta}(x_1+x_2-x_3-x_4)$.
\be
\item[(a)] Show that the symmetry group of $\varphi$ is $G=\langle(1324)\rangle\subset S_4$ in characteristic $\ne 2$.
\item[(b)] Show that in the universal case, $\varphi$ leads to the resolvent $$\Theta(y)=\prod_{i=1}^3 ( y^2 - \Delta(4y_i+\sigma_1^2-4\sigma_2)) ,$$ where $y_1=x_1x_2+x_3x_4,y_2=x_1x_3+x_2x_4,y_3=x_1x_4+x_2x_3$ are the roots of the universal Ferrari resolvent $\theta(y)$.
\item[(c)] Let $\Theta_f (y)$ be obtained by specializing the resolvent $\Theta (y)$ of part (b) to $f=x^4+bx^2+d$. Show that $$\Theta_f (y)=y^2((y^2+4b\Delta(f))^2-2^6 d\Delta(f)^2). $$
\ee
}
\begin{proof}

\item[(a)] Write $H(\varphi)$ the symmetry group of $\varphi = \sqrt{\Delta}\,(x_1+x_2 - x_3-x_4)$.

Since $(1\,3\,2\,4)$ is an odd permutation, $(1\,3\,2\,4)\cdot \sqrt{\Delta} = -\sqrt{\Delta}$, so
$$(1\,3\,2\,4)\cdot \varphi = -\sqrt{\Delta}\, (x_3 +x_4 - x_2 - x_1) = \varphi.$$
Therefore
 $$\langle (1\,3\,2\,4)\rangle \subset H(\varphi).$$
 
 To prove the converse, we show that the orbit ${\cal O}_\varphi$ of $\varphi$ under the action of $S_n$ contains at least 6 elements.
 
 $$
 \begin{array}{c|c|c|}
 \sigma & \sigma \cdot (x_1+x_2 - x_3 - x_4) & \sigma \cdot \varphi\\
 \hline
()& x_1 + x_2 - x_3 - x_4 & \sqrt{\Delta}(x_1+x_2-x_3-x_4)\\
 (3\, 4) & x_1 + x_2 -x_3 -x_4 & \sqrt{\Delta}(-x_1-x_2+x_3+x_4)\\
 (2\,3) & x_1-x_2+x_3 - x_4 & \sqrt{\Delta} (-x_1+x_2 - x_3 +x_4)\\
 (1\, 4) & -x_1 + x_2 -x_3 + x_4 & \sqrt{\Delta}(x_1 -x_2+x_3-x_4)\\
 (1\, 3) & -x_1 + x_2 + x_3 -x_4 & \sqrt{\Delta} (x_1-x_2 -x_3 + x_4)\\
 (2\, 4) &x_1 -x_2 -x_3 + x_4 & \sqrt{\Delta}(-x_1 + x_2 + x_3 -x_4)\\
 \hline
 \end{array}
 $$
Since the six elements in the right column are distinct (if the characteristic is not 2), we see that $|{\cal O}_\varphi| \geq 6$.

The stabilizer $G_\varphi$ of $\varphi$ in $S_n$ is $H(\varphi)$, which contains $\langle (1\,3\,2\,4)\rangle$, therefore $|G_\varphi| \geq 4$, and  $|{\cal O}_\varphi| =\frac{|S_n|}{|G_\varphi|} \leq \frac{24}{4} = 6$, so $|{\cal O}_\varphi| = 6$ and $|H(\varphi)| = |G_\varphi| = 4$, thus
$$\langle (1\,3\,2\,4)\rangle \subset H(\varphi),$$
and the orbit of $\varphi$ under $S_4$ is given by ${\cal O}_\varphi = \{\varphi_0= \varphi, \varphi_1,\ldots,\varphi_5\}$, where
\begin{align*}
\varphi_0  = \phantom{3\,4}() \cdot \varphi &= \sqrt{\Delta}\, (x_1+x_2 - x_3-x_4),\\
\varphi_1 = (3\,4)\cdot \varphi &= \sqrt{\Delta}\, ( - x_1-x_2 + x_3 +x_4),\\
\varphi_2 = (2\,3)\cdot \varphi &= \sqrt{\Delta}\, ( - x_1+ x_2 -x_3+x_4),\\
\varphi_3 = (1\,4) \cdot \varphi &= \sqrt{\Delta}\, (x_1- x_2 +x_3 -x_4),\\
\varphi_4= (1\,3) \cdot \varphi &= \sqrt{\Delta}\, (x_1 - x_2   -x_3+x_4),\\
\varphi_5= (2\,4) \cdot \varphi &= \sqrt{\Delta}\, ( - x_1+ x_2+x_3 -x_4).\\
\end{align*}

\item[(b)] Since $\varphi_1 = -\varphi_0, \varphi_3 = -\varphi_2, \varphi_5 = - \varphi_4$,
\begin{align*}
\Theta(y) &= \prod_{\psi \in {\cal O}_\varphi} (y - \psi) = \prod_{i=0}^5 (y- \varphi_i)\\
&= (y^2- \varphi_0^2) (y^2- \varphi_2^2) (y^2 - \varphi_4^2).
\end{align*}
Moreover,
\begin{align*}
\varphi_0^2 &= \Delta(x_1+x_2-x_3-x_4)^2,\\
\end{align*}
where
\begin{align*}
(x_1+x_2-x_3-x_4)^2&= (x_1+x_2)^2 + (x_3 + x_4)^2 - 2(x_1+x_2)(x_3+x_4)\\
&=(x_1+x_2+x_3+x_4)^2 - 4(x_1+x_2)(x_3+x_4)\\
&=(x_1+x_2+x_3+x_4)^2 -4(x_1x_3 +x_1x_4 + x_2x_3+x_2x_4)\\
&= 4(x_1x_2 + x_3x_4) + (x_1+x_2+x_3+x_4)^2 \\
&\qquad - 4(x_1x_2+x_1x_3+x_1x_4+x_2x_3+x_2x_4+x_3x_4)\\
&= 4y_1 +\sigma_1^2 - 4 \sigma_2.
\end{align*}
Thus
$$(y-\varphi_0)^2 = y^2  -\Delta(4y_1 +\sigma_1^2 - 4 \sigma_2), $$
where $y_1 = x_1x_2+x_3x_4$.

If we apply the permutation $(2\,3)$ on this equality, we obtain
$$(y - \varphi_2)^2 = y^2 - \Delta (4y_2 + \sigma_1^2 - 4\sigma_2),$$
where $y_2 =  x_2x_4 + x_1x_3$.

If we apply the permutation $(1\,3)$ on the same equality, we obtain
$$(y - \varphi_4)^2 = y^2 - \Delta(4y_3 + \sigma_1^2 - 4 \sigma_2),$$
where $y_3= x_4x_1 + x_3 x_2   $. 

Finally,
$$\Theta(y) = \prod_{i=1}^3 \left(y^2 - \Delta(4y_i+\sigma_1^2 - 4 \sigma_2)\right),$$
where $y_1 = x_1x_2+x_3x_4, y_2 = x_1x_3 +x_2x_4,y_3 = x_1x_4+x_2x_3$ are the roots of the universal Ferrari resolvent $\theta(y)$.

\item[(c)]
Let $\Theta_f(y)$ is obtained by specializing the resolvent $\Theta(y)$ of part (b) to ${f = x^4+bx^2 + d}$. 
Then $x_i$ maps to the root $\alpha_i,\ i= 1,\ldots,4$, $\sigma_1$ maps to $0$, $\sigma_2$ to $b$, $\Delta$ to $\Delta(f)$, and $y_i$ to $\beta_i$,where 
$$\beta_1 = \alpha_1 \alpha_2 + \alpha_3\alpha_4,\qquad  \beta_2 = \alpha_2 \alpha_4 + \alpha_1 \alpha_3,\qquad \beta_3 = \alpha_4 \alpha_1 + \alpha_3\alpha_2$$
are the roots of the Ferrari resolvent of $x^4 + bx^2 +d$.

We obtain
\begin{align*}
\Theta_f(y) &= \prod_{i=1}^3 \left(y^2  - \Delta(f) (4\beta_i - 4b)\right)\\
&=\prod_{i=1}^3 (y^2 + 4b\Delta(f) - 4 \Delta(f) \beta_i)
\end{align*}
If we write for simplicity
$$ u = y^2 + 4b\Delta(f),\qquad v = 4 \Delta(f) \ne 0 ,$$
then
\begin{align*}
\Theta_f(y) &=\prod_{i=1}^3 (u - v \beta_i)\\
&=v^3 \prod_{i=1}^3 \left(\frac{u}{v} - \beta_i\right).
\end{align*}
We know from Exercise 13.1.10 that the Ferrari resolvent of $x^4+bx^2 + d$ is
$$\Theta_f(y) = (y - \beta_1)(y-\beta_2)(y - \beta_3) =  (y-b)(y^2 - 4d).$$

The substitution $y \mapsto \frac{u}{v}$ gives
\begin{align*}
\Theta_f(y) &=v^3\left(\frac{u}{v} - \beta_1\right)\left(\frac{u}{v} - \beta_2\right)\left(\frac{u}{v} - \beta_3\right)\\
&= v^3\left(\frac{u}{v} - b\right) \left( \frac{u^2}{v^2} - 4d \right)\\
&=(u-bv)(u^2 - 4d v^2)\\
&= y^2 \left((y^2 + 4b \Delta(f))^2 -4d(4 \Delta(f))^2\right)\\
&= y^2 \left((y^2 + 4b \Delta(f))^2 - 2^6 d \Delta(f)^2 \right).
\end{align*}


\end{proof}




\paragraph{Ex. 13.3.5}

{\it This problem will state and prove a relative version of Proposition 13.3.2. Fix a subgroup $H\subset S_n$ and suppose that $f\in F[x]$ is separable of degree n and that $G_f \subset H$. Now let $G \subset H$ be a subgroup. We want to know whether or not $G_f$ lies in the smaller subgroup G. Let $\varphi \in F[x_1,...,x_n]$ have G as its symmetry group and let $\varphi_1=\varphi,\varphi_2,...,\varphi_l$ be the orbit of H acting on $\varphi$. Then set $$\Theta^H(y)=\prod_{i=1}^l ( y - \varphi_i) \in F[x_1,...,x_n][y].$$ Finally, if $\alpha_1,...,\alpha_n$ are the roots of f in the splitting field L, let $$\Theta_f^H(y)=\prod_{i=1}^l ( y - \varphi_i(\alpha_1,...,\alpha_n))\in L[y]$$  be the polynomial obtained by $x_i \mapsto \alpha_i$.
\be
\item[(a)] Explain why the degree of $\Theta_f^H(y)$ is the index of G in H.
\item[(b)] Prove that $\Theta_f^H(y) \in F[y]$.
\item[(c)] Assume that $G_f$ is conjugate within H to a subgroup of G (this means that $\tau G_f \tau^{-1} \subset G$ for some $\tau \in H$). Prove that $\Theta_f^H(y)$ has a root in F.
\item[(d)] Assume that $\Theta_f^H(y)$ has a simple root in F. Prove that $G_f$ is conjugate within H to a subgroup of G.
\ee
\begin{proof}
\item[(a)] $G$ is the symmetry group of $\varphi$, therefore $G\subset H$ is the isotropy subgroup of $\varphi$ under the action of $H$ ($\mathrm{Stab}_H(\varphi) = H \cap \mathrm{Stab}_{S_n}(\varphi) = H \cap G = G$), and $[H:G]=|H\cdot \varphi|=l$ (cf. Theorem A.4.9). The degree of $\Theta_f^H(y)$ is equal to $l$, hence $\deg(\Theta_f^H(y))=[H:G]$. 
\item[(b)] Let $\tau_1,...,\tau_l$ be representatives for the left cosets of $G$ in $H$. Then $$\Theta_f^H(y)=\prod_{i=1}^l ( y - (\tau_i\cdot \varphi)(\alpha_1,...,\alpha_n)).$$ Since $\varphi \in F [x_1,...,x_n]$, for each $i, 1\leq i \leq l$, $(\tau_i \cdot\varphi)(\alpha_1,...,\alpha_n) = \varphi(\alpha_{\tau_i(1)}, \ldots, \alpha_{\tau_i(n)}) \in F [\alpha_1,...,\alpha_n]  $, hence the coefficients of $\Theta_f^H(y)$ are in $F [\alpha_1,...,\alpha_n]  $.

Suppose $\sigma \in G_f$, then $\sigma \in H$ and $\sigma\cdot \Theta_f^H(y)=\prod_{i=1}^l ( y - (\sigma\tau_i) \cdot \varphi(\alpha_1,...,\alpha_n))$. But the set $\sigma\tau_1,...,\sigma\tau_l$ is also a set of left coset representatives of $G$ in $H$. Thus the action of $\sigma$ has merely permuted the roots of $\Theta_f^H(y)$ leaving the coefficients fixed. It means that the coefficients of $\Theta_f^H(y)$ are in $F$, i.e., $\Theta_f^H(y) \in F[y]$. 

\item[(c)] Assume that $G_f$ is congugate within $H$ to a subgroup $K$ of $G$, so that $G_f = \tau K \tau^{-1}, \tau \in H$. Then $\tau^{-1} G_f \, \tau\subset G$.

Let $\tilde \sigma \in \Gal(L/F)$ (where $L = F(\alpha_1,\ldots,\alpha_n)$), and  $\sigma\in G_f$  the associated permutation, so that $\tilde{\sigma}(\alpha_i) = \alpha_{\sigma(i)},\ i=1,\ldots,n$. Since $\tau^{-1} \sigma \tau \in G$ fixes $\varphi$,  $(\tau^{-1} \sigma \tau) \cdot \varphi = \varphi$, so that
\begin{align*}
\tilde{\sigma}((\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_n)) & = \tilde{\sigma}(\varphi(\alpha_{\tau(1)},\ldots,\alpha_{\tau(n)})\\
&= \varphi(\tilde{\sigma}(\alpha_{\tau(1)}), \ldots,\tilde{\sigma}(\alpha_{\tau(n)}))\\
&= \varphi(\alpha_{(\sigma \tau)(1)}, \ldots,\alpha_{(\sigma \tau)(n)})\\
&= ((\sigma \tau) \cdot \varphi)(\alpha_1,\ldots, \alpha_n)\\
&= (\tau\cdot ((\tau^{-1} \sigma \tau)\cdot \varphi))(\alpha_1,\ldots,\alpha_n)\\
&= (\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_n).
\end{align*}
Since this is true for any $\tilde{\sigma} \in \Gal(L/F)$, this proves that $(\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_n) \in F$.

Moreover $\tau \in H$, thus $\tau \cdot \varphi$ is in the orbit $H \cdot \varphi$, so $\beta = (\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_n)$ is a root of $\Theta_\varphi^H(y) = \prod\limits_{\psi \in H \cdot \varphi}(y - \psi)$, and $\beta$ is in $F$. 

\item[(d)]  We mimic the proof of Proposition 13.3.2, with an explicitation of the relabeling of the roots, as in part (c).

Let $\beta$ be a simple root of $\Theta_f^H(y)$ in $F$. By definition of $\Theta_f^H(y)$, there is $\tau \in H$ such that  
$$\beta = (\tau\cdot \varphi)(\alpha_1,\ldots, \alpha_n) = \varphi(\alpha_{\tau(1)},\ldots,\alpha_{\tau(n)}).$$

We will prove that $\tau^{-1} G_f \tau \subset G$. If not, there is some $\sigma \in \tau^{-1} G_f \tau$ such that $\sigma \not \in G$.

Then $\sigma' = \tau \sigma \tau^{-1} \in G_f$ corresponds to some $\rho \in \Gal(L/F)$, so that $\rho(\alpha_i) = \alpha_{\sigma'(i)}, \ i=1,\ldots,n$.

Since $\beta \in F$, $\beta = \rho(\beta)$, so that
\begin{align*}
\beta &= \rho(\varphi(\alpha_{\tau(1)},\ldots,\alpha_{\tau(n)})\\
&=\varphi(\rho(\alpha_{\tau(1)}), \ldots,\rho(\alpha_{\tau(n)}))\\
&=\varphi(\alpha_{(\sigma'\tau)(1)},\ldots,\alpha_{(\sigma' \tau)(n)})\\
&=\varphi(\alpha_{(\tau\sigma)(1)},\ldots,\alpha_{(\tau \sigma)(n)})\\
&=((\tau \sigma )\cdot \varphi)(\alpha_1,\cdots, \alpha_n)
\end{align*}
We conclude that
$$(\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_n) = ((\tau \sigma )\cdot \varphi)(\alpha_1,\cdots, \alpha_n) \qquad (= \beta).$$

Since $\beta$ is a root of $\Theta_f^H$, $ y - \beta = y - (\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_n)$ is a factor of $\Theta_f^H(y)$.

But $\sigma \not \in G$, thus $\varphi \ne \sigma \cdot \varphi$, therefore $\tau \cdot \varphi \ne (\tau \sigma )\cdot \varphi$.

From $\tau \in H, G_f \subset H$, and $\sigma \in \tau^{-1} G_f \tau$, we know that $\tau\sigma \in  H$, thus 
$$(y - ((\tau \sigma )\cdot \varphi)(\alpha_1,\cdots, \alpha_n)$$ is another factor of $\Theta_f^H(y)$, therefore the relative resolvent may be written
\begin{align*}
\Theta_f^H(y) &= (y - (\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_n)) (y - ((\tau \sigma) \cdot\varphi(\alpha_1,\ldots,\alpha_n))\cdots\\
&= (y- \beta)^2\cdots
 \end{align*}
 This is a contradiction, since by assumption $\beta$ is a simple root of $\Theta_f^H(y)$.
 This proves that $\tau^{-1} G_f \tau \subset G$. If $K = \tau^{-1} G_f \tau$, $K$ is a subgroup of $G$, and $G_f = \tau K \tau^{-1}, \tau \in H$, is conjugate within $H$ to a subgroup of $G$.
\end{proof}
}

\paragraph{Ex. 13.3.6}

{\it Let $D=\sum_{\sigma \in A_4} \sigma \cdot x_1^3x_2^2x_3 \in F[x_1,x_2,x_3,x_4]$.
\be
\item[(a)] Prove that $D=\frac{1}{2}(\sigma_1\sigma_2\sigma_3 -3 \sigma_1^2 \sigma_4 -3\sigma_3^2 + 4\sigma_2 \sigma_4)+\frac{1}{2}\sqrt{\Delta}$ in characteristic $\ne 2$.
\item[(b)] Prove that $\sqrt{\Delta}=D-(12)\cdot D$ in all characteristics.
\ee
\begin{proof}
\item[(a)] Since $$\sum_{\sigma \in S_4} \sigma =\sum_{\sigma \in A_4} \sigma + \sum_{\sigma \in S_4 \setminus A_4} \sigma =\sum_{\sigma \in A_4} \sigma + (12)\cdot \sum_{\sigma \in  A_4} \sigma $$ and based on results of Ex.2.2.3, we have:
$$\sum_{\sigma \in S_4} \sigma \cdot x_1^3x_2^2x_3 = D+(12)\cdot D =\sigma_1\sigma_2\sigma_3 -3 \sigma_1^2 \sigma_4 -3\sigma_3^2 + 4\sigma_2 \sigma_4 $$
Sage verification:
\begin{verbatim}
    R.<x1,x2,x3,x4,y1,y2,y3,y4> = PolynomialRing(QQ, order = 'degrevlex')
    elt = SymmetricFunctions(QQ).e()
    e = [elt([i]).expand(4).subs(x0=x1, x1=x2, x2=x3, x3 = x4) for i in range(5)]
    J = R.ideal(e[1]-y1, e[2]-y2, e[3]-y3,e[4]-y4)
    G = J.groebner_basis()
    D = x1^3*x2^2*x3;
    D=D+D.subs(x1=x3,x2=x4,x3=x1)+D.subs(x1=x2,x2=x1,x3=x4)+D.subs(x1=x4,x2=x3,x3=x2)
    D=D+D.subs(x1=x2,x2=x3,x3=x1)+D.subs(x1=x2,x2=x3,x3=x1).subs(x1=x2,x2=x3,x3=x1)
    u=D+D.subs(x1=x2,x2=x1)
    var('sigma_1,sigma_2,sigma_3,sigma_4')
    u.reduce(G).subs(y1=sigma_1, y2 = sigma_2,y3=sigma_3,y4=sigma_4)
\end{verbatim}
$$\sigma_1\sigma_2\sigma_3 -3 \sigma_1^2 \sigma_4 -3\sigma_3^2 + 4\sigma_2 \sigma_4 $$

Assuming that $D-(12)\cdot D=\sqrt{\Delta}$ is valid, then $2D \ne 0$ in characteristic $\ne 2$ and
$$2D=2(\frac{1}{2}(\sigma_1\sigma_2\sigma_3 -3 \sigma_1^2 \sigma_4 -3\sigma_3^2 + 4\sigma_2 \sigma_4)+\frac{1}{2}\sqrt{\Delta}).$$
\item[(b)] We use Sage to prove that $D-(12)\cdot D-\sqrt{\Delta}=0$:

\begin{verbatim}
    Delta = (x1-x2)*(x1-x3)*(x1-x4)*(x2-x3)*(x2-x4)*(x3-x4)
    D-D.subs(x1=x2,x2=x1)-Delta==0
\end{verbatim}
\begin{center}
 {\it True}
\end{center}
Hence in all characteristics  $$\sqrt{\Delta}=D-(12)\cdot D.$$
\end{proof}
}

\paragraph{Ex. 13.3.7}

{\it As in Example 13.3.7, let $f=x^4+(u+1)x^2+ux+1 \in F[x]$, where $F=\mathbb{F}_2(u)$.
\be
\item[(a)] Use Gauss's Lemma and the Sch\"onemann-Eisenstein criterion to show that $f$ is irreducible over $F$. (These results apply since $\mathbb{F}_2[u]$ is a PID.) 
\item[(b)] Verify the formulas for $D_f(y)$ and $\theta_f(y)$ given in Example 13.3.7.
\item[(c)] Show that $y^2+uy+1$ is irreducible over the splitting field of $D_f(y)$.
\ee
\begin{proof}
\item[(a)] $u$ is a prime of the PID $\F_2[u]$, but the reduction modulo $u$ is $\overline{f} = x^4 + x^2 + 1$, which is not irreducible, since $x^4+x^2+1 = (x^2+x+1)^2$. Nor the Sch\"onemann-Eisenstein not the reduction modulo $u$ applies here.

We give a direct proof of the irreducibility of $f$, by proving that $f$ has no factor with degree 1 ou 2. By Gauss's Lemma, if $f$ has no factorisation in $\F_2[[u] [x]$, then $f$ is irreducible in $\F_2[u] (x)$.

$\bullet$ If $f$ has a factor with degree 1, then $f$ has a root $\frac{a(u)}{b(u)} \in \F_2(u)$, where $a(u), b(u)$ are relatively prime. Then 
$$a(u)^4 + (u+1)a(u)^2b(u)^2 + u a(u) b(u)^3 + b(u)^4 = 0,$$
therefore $a \mid b^4$, and $a \wedge b = 1$, hence $a \mid 1$, and similarly $b \mid 1$. Thus $a, b \in \F_2$, where $a \ne 0, b \ne 0$, so that $a(u) = b(u) = 1$. But $f(1) = 1 \ne 0$, therefore $f$ has no factor with degree 1 in $F[x]$.

$\bullet$ If $f$ has a factor with degree 2, then
$$f = (a(u) x^2 + b(u) x + c(u))(d(u) x^2 +e(u) x + f(u),$$
where $a,b,c,d,e,f$ are in $\F_2[u]$.
Since $a(u) d(u) = 1$, $a(u)$ and $d(u)$ are units of $\F_2[u]$, so are in $F_2$, therefore $a(u) = d(u) = 1$, and similarly $c(u) = f(u) = 1$, so that
$$f = (x^2 + b(u) x + 1)(x^2 + e(u) x + 1).$$
The comparison of the terms in $x^3$ gives $b(u) + e(u) = 0$, so that
\begin{align*}
f &= (x^2 + b(u) x + 1)(x^2 -b(u) x + 1)\\
&=(x^2+1)^2 - b(u)^2 x^2\\
&= x^4 -b(u)^2 x^2 +1.
\end{align*}
This is a contradiction, since $f$ has a nonzero term $u x, u\ne 0$. Therefore $f$ is irreducible over $F$.

Sage verification:
\begin{verbatim}
F = Frac(GF(2)['u']); u = F.gen()
f = x^4 + (u+1)*x^2 + u*x +1
f.is_irreducible()
\end{verbatim}
\begin{center}
{\it True}
\end{center}
\begin{verbatim}
gcd(f,f.derivative(x))
\end{verbatim}
\begin{center}
1
\end{center}
This is a verification that $f$ is irreducible, separable.
\item[(b)] For the given polynomial $c_1=\sigma_1=0,c_2=\sigma_2=u+1,c_3=\sigma_3=-u,c_4=\sigma_4=1$. For $D_f(y)$ we have (cf. Ex.13.3.6,13.3.4 and (13.3),(13.32)):
\begin{align*}
& A=D(f)+ D'(f) =\sigma_1\sigma_2\sigma_3 -3 \sigma_1^2 \sigma_4 -3\sigma_3^2 + 4\sigma_2 \sigma_4=\sigma_3^2=c_3^2=u^2 \pmod 2\\
& B=D(f) D'(f)=c_2^3c_3^2+c_3^4=(u+1)^3u^2+u^4=u^5+u^3+u^2 \pmod 2\\
& D_f(y)=y^2-Ay+B=y^2+u^2y+u^5+u^3+u^2\\
& \\
& a=\sigma_2=c_2=u+1,~b=\sigma_1\sigma_3-4\sigma_4=c_1c_3-4c_4=0,\\
& c= \sigma_1^2\sigma_4+\sigma_3^2-4\sigma_2\sigma_4=c_1^2c_4+c_3^2-4c_2c_4=u^2\\
& \theta_f(y)=y^3-ay^2+by-c=y^3+(u+1)y^2+u^2=(y+u)(y^2+y+u)
\end{align*}
Sage verification:
\begin{verbatim}
    R.<x1,x2,x3,x4,y1,y2,y3,y4> = PolynomialRing(QQ, order = 'degrevlex')
    elt = SymmetricFunctions(QQ).e()
    e = [elt([i]).expand(4).subs(x0=x1, x1=x2, x2=x3, x3 = x4) for i in range(5)]
    J = R.ideal(e[1]-y1, e[2]-y2, e[3]-y3,e[4]-y4)
    G = J.groebner_basis()
    D = x1^3*x2^2*x3;
    D=D+D.subs(x1=x3,x2=x4,x3=x1)+D.subs(x1=x2,x2=x1,x3=x4)
      +D.subs(x1=x4,x2=x3,x3=x2)
    D=D+D.subs(x1=x2,x2=x3,x3=x1)
      +D.subs(x1=x2,x2=x3,x3=x1).subs(x1=x2,x2=x3,x3=x1)
    d1=x1*x2+x3*x4;d2=d1.subs(x2=x3,x3=x2);d3=d1.subs(x1=x3,x3=x1);
    S1=d1+d2+d3; S2=d1*d2+d1*d3+d2*d3; S3=d1*d2*d3

    S.<c1,c2,c3,c4,u> = PolynomialRing(ZZ, order = 'degrevlex')
    A=(D+D.subs(x1=x2,x2=x1)).reduce(G).subs(y1=c1,y2=c2,y3=c3,y4=c4)
    A=A.subs(c1=0,c2=u+1,c3=-u,c4=1).change_ring(GF(2));
    B=(D*D.subs(x1=x2,x2=x1)).reduce(G).subs(y1=c1,y2=c2,y3=c3,y4=c4)
    B=B.subs(c1=0,c2=u+1,c3=-u,c4=1).change_ring(GF(2));
    a=S1.reduce(G).subs(y1=c1, y2 = c2,y3=c3,y4=c4)
    a=a.subs(c1=0,c2=u+1,c3=-u,c4=1).change_ring(GF(2));
    b=S2.reduce(G).subs(y1=c1, y2 = c2,y3=c3,y4=c4)
    b=b.subs(c1=0,c2=u+1,c3=-u,c4=1).change_ring(GF(2));
    c=S3.reduce(G).subs(y1=c1, y2 = c2,y3=c3,y4=c4)
    c=c.subs(c1=0,c2=u+1,c3=-u,c4=1).change_ring(GF(2));
    show("A= ",A,",  B= ",B)
    show("a=",a,", b=",b,", c=",c)
    show((y^3+a*y^2+b*y+c).factor())
\end{verbatim}
$$A= u^{2},~ B=u^{5} + u^{3} + u^{2}$$
$$a= u + 1,~b= 0,~ c= u^{2}$$
$$(u + y) \cdot (y^{2} + u + y)$$
\item[(c)] As per (b), $D_f(y)=y^2+u^2y+u^5+u^3+u^2=(y+u)^2+u^2(y+u)+u^5=u^4(Y^2+Y+u)$, where $Y=({y+u})/{u^2}$.

Then the splitting field of $D_f(y)$ is $F(D(f))=\mathbb{F}_2(u,\alpha)$, where $\alpha^2+\alpha+u=0$. Since $u=\alpha^2+\alpha$, $\mathbb{F}_2(u,\alpha)=\mathbb{F}_2(\alpha)$ and $g(y)=y^2+uy+1=y^2+(\alpha^2+\alpha)y+1$. Then $g(y+1)=(y+1)^2+(\alpha^2+\alpha)(y+1)+1=y^2+(\alpha^2+\alpha)y+(\alpha^2+\alpha)$ is irreducible in $\mathbb{F}_2[\alpha][y]$  (and in $\F_2(\alpha)[y]$) by the Sch\"onemann-Eisenstein criterion. Therefore $g(y)$ is irreducible over the splitting field $\F_2(\alpha)$ of $D(f)$

This criterion applies here because $[\F_2(\alpha) : \F_2] = [\F_2(u, \alpha) : \F_2] = [\F_2(u,\alpha) : \F_2(u)][\F_2(u):\F_2] = \infty$ ($u$ is a variable), therefore $\alpha$ is transcendental over $\F_2$, so that we may consider $\alpha$ as a variable $x$: $\F_2[\alpha] \simeq \F_2[x]$. Hence $\F_2[\alpha]$ is a PID, and $\alpha$ is a prime in $\F_2[\alpha]$. Gauss's Lemma and the Sch\"onemann-Eisenstein Criterion apply here.

As an alternative proof of the irreducibility of $g(y) = y^2 + uy + 1$ over $F(D(f))$, without this criterion, it is sufficient to prove that $g(y)$ has no root in $F(D(f)) = \F_2(\alpha)$, where $\alpha^2 + \alpha + u = 0$ as above. Such a root is under the form $a(\alpha)/b(\alpha)$, where $a(\alpha)$ and $b(\alpha)$ are relatively prime in the PID $\F_2[\alpha]$. Then
$$a(\alpha) ^2 +  (\alpha^2 + \alpha) a(\alpha) b(\alpha) + b^2(\alpha) = 0,$$
hence $a(\alpha) \mid  b^2(\alpha)$, with $a(\alpha), b(\alpha)$ relatively prime, thus $a(\alpha) \mid 1$, $a(\alpha) = 1$, and similarly $b(\alpha) = 1$. But $g(1) = u \ne 0$, so $g$ has no root in $F(D(f))$.

Thus $y^2+uy+1$ is irreducible over the splitting field of $D_f(y)$, therefore $G_f \simeq D_8$ by Proposition 13.3.6.
\end{proof}
}

\paragraph{Ex. 13.3.8}

{\it Let $f\in F[x]$ be an irreducible quartic, where $F$ has characteristic $\ne 2$. Also let $\Theta_f(y)$ be the sextic resolvent defined in Example 13.3.4. The goal of this exercise is to show that $G_f\subset S_4$ determines the irreducible factorization of $\Theta_f(y)$ over $F$. We will assume that $\Theta_f(y)$ is separable.
\be
\item[(a)] First suppose $G_f=A_4$ or $S_4$. Prove that $\Theta_f(y)$ is irreducible over $F$.
\item[(b)] Now suppose that $G_f=\langle (1324),(12) \rangle$. Prove that $\Theta_f(y)=g(y)h(y)$, where $g(y),h(y)\in F[x]$ are irreducible of degree 2 and 4 respectively.
\item[(c)] Suppose that $G_f=\langle (12)(34),(13)(24) \rangle$. Prove that $\Theta_f(y)=g_1(y)g_2(y)g_3(y)$, where $g_1(y),g_2(y),g_3(y)\in F[x]$ are irreducible of degree 2.
\item[(d)] Finally, suppose that $G_f=\langle (1324) \rangle$. Prove that $\Theta_f(y)=g_1(y)g_2(y)g_3(y)$, where $g_1(y),g_2(y),g_3(y)\in F[x]$ are irreducible of degree 1,1 and 4 respectively.
\item[(e)] Explain why parts (a) through (d) enable one to determine $G_f$ up to conjugacy using only $\Theta_f(y)$ and $\Delta (f)$. 
\ee
\begin{proof}
\be
\item[(a)] Let $\varphi = \sqrt{\Delta}(x_1+x_2-x_3-x_4)$. We know by Ex. 13.3.4(a) that the orbit ${\cal O}_\varphi = S_n \cdot \varphi$ is 


$${\cal O}_\varphi = \{\varphi_0, \varphi_1,\ldots,\varphi_5\},$$
where
\begin{align*}
\varphi_0  = \phantom{3\,4}() \cdot \varphi &= \sqrt{\Delta}\, (x_1+x_2 - x_3-x_4),\\
\varphi_1 = (3\,4)\cdot \varphi &= \sqrt{\Delta}\, ( - x_1-x_2 + x_3 +x_4),\\
\varphi_2 = (2\,3)\cdot \varphi &= \sqrt{\Delta}\, ( - x_1+ x_2 -x_3+x_4),\\
\varphi_3 = (1\,4) \cdot \varphi &= \sqrt{\Delta}\, (x_1- x_2 +x_3 -x_4),\\
\varphi_4= (1\,3) \cdot \varphi &= \sqrt{\Delta}\, (x_1 - x_2   -x_3+x_4),\\
\varphi_5= (2\,4) \cdot \varphi &= \sqrt{\Delta}\, ( - x_1+ x_2+x_3 -x_4).\\
\end{align*}
We verify that the orbit $A_n\cdot \varphi$ is ${\cal O}_\varphi$. Since $A_n$ fixes $\sqrt{\Delta}$, we obtain
$$
 \begin{array}{c|c|}
 \sigma & \sigma \cdot \varphi\\
 \hline
() & \sqrt{\Delta}(x_1+x_2-x_3-x_4)\\
(1\, 3)(2\, 4)  & \sqrt{\Delta}(-x_1-x_2+x_3+x_4)\\
 (1\,2\,4) & \sqrt{\Delta} (-x_1+x_2 - x_3 +x_4)\\
 (2\,3\, 4)  & \sqrt{\Delta}(x_1 -x_2+x_3-x_4)\\
 (2\,4\, 3)  & \sqrt{\Delta} (x_1-x_2 -x_3 + x_4)\\
 (1\,3\, 4)  & \sqrt{\Delta}(-x_1 + x_2 + x_3 -x_4)\\
 \hline
 \end{array}
 $$
 This proves $A_n \cdot \varphi \supset S_n \cdot \varphi$, and since $A_n \subset S_n$, $A_n \cdot \varphi \subset S_n \cdot \varphi$, so that
 $$A_n \cdot \varphi = S_n \cdot \varphi.$$
Here $G_f = A_n$ or $G_f = S_n$. Therefore $G_f$ acts transitively over the roots $\varphi_i$ of the universal resolvent $\Theta(y) = \prod\limits_{i=0}^5 (y - \varphi_i)$.

Write $L = F(\alpha_1,\alpha_2,\alpha_3,\alpha_4)$ be the splitting field of $f$, and $\beta = \varphi_i(\alpha_1,\alpha_2,\alpha_3,\alpha_4) \in L, \beta_i =\varphi(\alpha_1,\alpha_2,\alpha_3,\alpha_4) \in L$.

Since $\Theta_f(y) = \prod\limits_{i=0}^5 (y - \varphi_i(\alpha_1,\alpha_2,\alpha_3,\alpha_4)) \in F[y]$,  $\Gal(L/F)$ acts on the roots of $\Theta_f(y)$. We show that this action is transitive.

We know that $A_n\cdot \varphi = \{\varphi_0,\ldots,\varphi_5\}$, so that for each subscript $i \in\{0,\ldots,5\}$, there exists $\tau \in A_n$ such that $\tau \cdot \varphi = \varphi_i$. 

Since $G_f \supset A_n$, $\tau \in G_f$, thus there is a corresponding $\sigma \in \Gal(L/F)$ such that $\sigma(\alpha_j) = \alpha_{\tau(j)},\ j = 1,2,3,4$. Then
\begin{align*}
\sigma(\beta) &= \sigma(\varphi(\alpha_1,\ldots,\alpha_4))\\
 &= \varphi(\tau(\alpha_1),\ldots,\tau(\alpha_5))\\
 &= (\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_4) \\
 &= \varphi_i(\alpha_1,\ldots,\alpha_4)\\
 &= \beta_i.
\end{align*}
Therefore the orbit of $\beta$ under the action of $\Gal(L/F)$ is $\{\beta = \beta_0, \ldots, \beta_5\}$.
 
 Then we prove that $\Theta_f(y)$ is irreducible with the same argument as in the proof of Theorem 7.1.1 or Proposition 6.3.7.
 
 If $h$ is the minimal polynomial of $\beta$ over $F$, then $h$ divides $\Theta_f(y)$. $h \in F[y]$, and $\beta$ is a root of $h$, therefore $\beta_i = \sigma(\beta) , \sigma \in \Gal(L/F)$ is a root of $h$. The six $\beta_i$ are distinct, as $\Theta_f(y)$ is separable, so that $\deg(h) \geq 6$, where $h \mid \Theta_f$, thus $\Theta_f = h$ is irreducible.


\item[(b)] Write, as in part (a),
\begin{align*}
\varphi &= \sqrt{\Delta}(x_1+x_2-x_3-x_4),\\
\varphi_2& = (1\,2\,4)\cdot \varphi = \sqrt{\Delta}(-x_1+x_2-x_3+x_4),\\
\varphi_4 & = (2\,4\,3)\cdot \varphi = \sqrt{\Delta}(x_1 -x _2 -x_3 + x_4).
\end{align*}
Then the orbit of $\varphi$ is $S_n\cdot \varphi = \{\varphi, -\varphi, \varphi_2, -\varphi_2, \varphi_4,-\varphi_4\}$, and the universal resolvent is
$$\Theta(y) = (y^2 - \varphi^2)(y^2 - \varphi_2^2)(y^2-\varphi_4^2).$$
Here $G_f =\langle (1\,3\,2\,4),(1\, 2)\rangle$ is the dihedral group $D_8$. We compute the orbits of $\varphi$ and of $\varphi_2$ under the action of $G_f$.
\begin{align*}
(1\,3\,2\,4) \cdot \varphi &= (-\sqrt{\Delta)}(x_3+x_4 -x_2 -x_1)\\
&=\sqrt{\Delta}(x_1+x_2-x_3 -x_4) = \varphi\\
(1\,2)\cdot \varphi &= (-\sqrt{\Delta})(x_2 + x_1 -x_3 -x_4) = -\varphi,
\end{align*}
so that $G_f\cdot \varphi = \{\varphi, -\varphi\}$.

Write $\beta = \varphi(\alpha_1,\alpha_2,\alpha_3,\alpha_4) = \sqrt{\Delta(f)}(\alpha_1+\alpha_2-\alpha_3-\alpha_4)$, and similarly $\beta_2 = \varphi_2(\alpha_1,\alpha_2,\alpha_3,\alpha_4),\beta_4 = \varphi_4(\alpha_1,\alpha_2,\alpha_3,\alpha_4)$.Then
$$\Theta_f(y) = (y^2 - \beta^2)(y^2-\beta_2^2)(y^2 - \beta_4^2).$$

If $\sigma \in \Gal(L/F)$, and if $\tau \in G_f$ is the corresponding permutation, then, as in part (a),
$$\sigma(\beta) = (\tau \cdot \varphi)(\alpha_1,\ldots,\alpha_4) = \pm \varphi(\alpha_1,\ldots,\alpha_4) = \pm \beta.$$
We know that $\beta \ne 0$, as $\Theta_f$ is separable. Thus $\sigma(\beta) \ne \beta$, so that $\beta \not \in F$, but $\sigma(\beta^2) = (\pm \beta)^2 = \beta^2$, thus $\beta^2 \in F$.
This proves that the factor $g(y) = y^2 - \beta^2 \in F[y]$, and $y^2 - \beta^2$ is irreducible over $F$.

Moreover,
\begin{align*}
(1\,3\,2\,4)\cdot \varphi_2 &= (-\sqrt{\Delta})(-x_3+x_4-x_2+x_1)\\
&=\sqrt{\Delta}(-x_1+x_2+x_3-x_4)\\
&=-\varphi_4\\
(1\,3\,2\,4)^2 \cdot \varphi_2&= -(1\,3\,2\,4)\cdot \varphi_4\\
&=-(-\sqrt{\Delta})(x_3-x_4-x_2+x_1)\\
&=\sqrt{\Delta}(x_1 - x_2+x_3-x_4)\\
&=-\varphi_2\\
(1\,3\,2\,4)^3 \cdot \varphi_2 &= -(1\,3\,2\,4)\cdot \varphi_2 = \varphi_4\\
(1\,2)\cdot \varphi_2 &= (-\sqrt{\Delta})(-x_2+x_1-x_3+x_4)\\
&=\sqrt{\Delta}(-x_1+x_2+x_3-x_4),
\end{align*}
so that $G_f\cdot \varphi_2 = \{\varphi_2,-\varphi_2,\varphi_4, -\varphi_4\}$. Therefore the orbit of $\beta_2$ under the action of $\Gal(L/F)$ is $\{\pm \beta_2, \pm \beta_4\}$.

Write $h(y) = (y^2-\beta_2^2)(y^2 - \beta_4^2)$. Since $h(y) = \Theta_f(y)/g(y)$, $h(y) \in F[y]$. The action of $\Gal(L/F)$ on the roots of the separable polynomial $h$ is transitive, thus, as in part (a), $h$ is irreducible over $F$.

$\Theta_f(y)=g(y)h(y)$, where $g(y),h(y)\in F[y]$ are irreducible of degree 2 and 4 respectively.

\item[(c)] By computing the orbits of $\varphi,\varphi_2,\varphi_4$, we obtain
\begin{align*}
(1\,2)(3\,4)\cdot \varphi &= \varphi,\\
(1\,3)(2\,4)\cdot \varphi &= -\varphi,\\
(1\,2)(3\,4)\cdot \varphi_2 &= -\varphi_2,\\
(1\,3)(2\,4)\cdot \varphi_2&= -\varphi_2,\\
(1\,2)(3\,4)\cdot \varphi_4 &= -\varphi_4,\\
(1\,3)(2\,4)\cdot \varphi_4 &= -\varphi_4.\\
\end{align*}
Therefore $$G_f\cdot \varphi = \{\varphi, - \varphi\},\qquad  G_f\cdot \varphi_2 = \{\varphi_2, - \varphi_2\}, \qquad G_f\cdot \varphi_4 = \{\varphi_4, - \varphi_4\},$$
and the orbits of $\beta, \beta_2,\beta_4$ under the action of $G = \Gal(L/F)$ are
$$G\cdot \beta = \{\beta, - \beta\},\qquad G\cdot \beta_2 = \{\beta_2, - \beta_2\}, \qquad G\cdot \beta_4 = \{\beta_4, - \beta_4\}.$$
If $\sigma \in \Gal(L/F)$ corresponds to $(1\,2)(3\,4)$, then $\sigma(\beta) = - \beta \ne \beta$, and $\sigma(\beta^2) = \beta^2$, so that $\beta \not \in F, \beta^2 \in F$, and the factor $y^2-\beta^2 \in F[y]$ is irreducible over $F$. Similarly, the two other factors are irreducible in $F[y]$.

$\Theta_f(y) = (y^2 - \beta^2)(y^2-\beta_2^2)(y^2 - \beta_4^2)$ is a decomposition in three irreducible factors of $F[y]$.

\item[(d)] Suppose now that $G_f = \langle (1\,3\,2\,4)\rangle$. We know that
\begin{align*}
(1\,3\,2\,4) \cdot \varphi =\varphi,
\end{align*}
thus the corresponding $\sigma \in \Gal(L/F)$ fixes $\beta = \varphi(\alpha_1,\ldots,\alpha_4)$, so that $\beta \in F$.

$g_1(y) = y- \beta, g_2(y) = y+ \beta$ are two factors of degree 1 of $\Theta_f(y)$.

Moreover, we know from part (b) that
\begin{align*}
(1\,3\,2\,4)\cdot \varphi_2 = -\varphi_4, (1\,3\,2\,4)^2 \cdot \varphi_2 = -\varphi_2, (1\,3\,2\,4)^3 \cdot \varphi_2 = \varphi_4
\end{align*}
As in part $b$, $\Gal(L/F)$ acts transitively on the distinct roots of $(y^2 - \beta_2^2)(y^2 - \beta_4^2) \in F[y]$, thus this polynomial is irreducible over $F$:

$\Theta_f(y)=g_1(y)g_2(y)g_3(y)$, where $g_1(y),g_2(y),g_3(y)\in F[y]$ are irreducible of degree 1,1 and 4 respectively.

\item[(e)] By Theorem 13.1.1, $G_f$ is conjugate to a permutation group examined in parts (a),(b), (c) or (d), and the four conclusions are mutually exclusive, so the factorisation of $\Theta_f(y)$ over $F$ enables to determine this case. In part (a), $\Delta(f)$ enables in characteristic $\ne 2$ to distinguish the cases $G_f = A_4$ and $G_f = A_4$. Therefore the factorisation of $\Theta_f(y)$ and $\Delta(f)$ give an algorithm to determine $G_f$ up to conjugacy.



\ee\end{proof}
}

\paragraph{Ex. 13.3.9}

{\it The action of $\mathrm{GL}(3,\mathbb{F}_2)$ on the nonzero vectors of $\mathbb{F}_2^3$ gives a group homomorphism $\mathrm{GL}(3,\mathbb{F}_2) \rightarrow S_7$. Prove that this map is one-to-one. 

\begin{proof}

Let 
$$
\psi 
\left\{
\begin{array}{ccl}
  \mathrm{GL}(3,\mathbb{F}_2)& \to  &  S_7 \\
  g& \mapsto  &   \sigma : \quad \forall i \in \{ 1,...,7\}, \ g \cdot \nu_i = \nu_{\sigma(i)}   
\end{array}
\right.
$$
If $\psi(g) = \psi(g')$, then $\ g \cdot \nu_i =\ g' \cdot \nu_i$ for all $i \in \{ 1,...,7\} $, then particularly $g \cdot e_1 = g' \cdot e_1, g \cdot e_2 = g' \cdot e_2, g \cdot e_3 = g' \cdot e_3$, where $e_1 =(1,0,0), e_2 = (0,1,0), e_3 = (0,0,1)$ is the standard basis of $\F_2^3$. Since a linear map (or its matrix) is determined by the images of the vectors of a base, $g = g'$

 $\psi:G \to S_m$ is a one-to-one group homomorphism.
\end{proof}
}

\paragraph{Ex. 13.3.10}

{\it Consider the vector space  $\mathbb{F}_2^3$.
\be
\item[(a)] Prove that $\mathbb{F}_2^3$ has exactly seven two-dimensional subspaces.
\item[(b)] For a field F, let $B=\{\{ \nu_1,\nu_2,\nu_3\} \subset F^3\, |\,  \nu_1,\nu_2,\nu_3$ are linearly independent over F\}. Prove that $\mathrm{GL}(3,F)$ acts transitively on B.

\item[(c)] Let F be as in part (b). Prove that $\mathrm{GL}(3,F)$ acts transitively on the set of two-dimensional subspaces of $F^3$.
\ee
\begin{proof}\be
\item[(a)] An orderer pair $(u,v) \in \F_2^2$ is a base of a vectorial plane if $u \ne 0$, and $v \not \in \langle u \rangle = \{0,u\}$, so there are $7 \times 6$ (ordered) bases of planes in $\F_3^2$.

A vectorial plane $P$ of $ \F_3^2$, which contains 4 vectors, has $3 \times 2$ bases, with the same reasoning: 3 choices for the first non null vector, and 2 choices for the second vector.

Therefore the number of two-dimensional subspaces of $\F_2^3$ is $\frac{7 \times 6}{3 \times 2} = 7$.

\item[(b)] 
Let $\{e_1,e_2,e_3\}$ be the standard basis of $F^3$, where $e_1 =(1,0,0), e_2 = (0,1,0), e_3 = (0,0,1)$. Any element of $\mathrm{GL}(3,F)$ applies a base on a base, thus the orbit of $\{e_1,e_2,e_3\}$ is included in $B$.


Conversely, let $\{\nu_1,\nu_2,\nu_3\}$ be any element of $B$. Define $g = [\nu_1,\nu_2,\nu_2]$ the matrix whose columns are $\nu_1,\nu_2,\nu_3$. Since $\nu_1,\nu_2,\nu_3$ are linearly independent, $g \in \mathrm{GL}(3,\F_2)$, and $g\cdot e_1 = \nu_1, g\cdot e_2 = \nu_2,g\cdot e_3 = \nu_3$, so that $\{\nu_1,\nu_2,\nu_3\} = g\cdot\{e_1,e_2,e_3\}$ is in the orbit of $\{e_1,e_2,e_3\}$. Therefore the orbit of $\{e_1,e_2,e_3\}$ is $B$, thus $ \mathrm{GL}(3,F)$ acts transitively over $B$.


\item[(c)] Let $P,Q$ be two-dimensional subspaces of $F^3$. Take $\{\nu_1,\nu_2\}$ a basis of $P$, and $\{\nu'_1,\nu'_2\}$ a basis of $Q$. We can complete them into bases of $F^3$, say $b = \{\nu_1,\nu_2,\nu_3\}$ and $ b' = \{\nu'_1,\nu'_2,\nu'_3\}$. By part $b$, there exists $g \in  \mathrm{GL}(3,F)$ such that $g\cdot b = b'$. Since $g$ maps a basis of $P$ on a basis of $Q$, $g\cdot P = Q$. Therefore $\mathrm{GL}(3,F)$  acts transitively on the set of two-dimensional subspaces of $F^3$ 
\ee

\bigskip

Note: Since there are exactly 3 nonzero vectors in a two-dimensional subspace of $\F_2^3$, each triple of distinct nonzero linearly dependant vectors in $\F_2^3$ determines a unique two-dimensional space. Therefore part (c) explains the statement in the proof of 13.3.9, that $ \mathrm{GL}(3,\F_2^3)$ acts transitively on this set of triples.
\end{proof}
}

\paragraph{Ex. 13.3.11}

{\it Prove that  $\mathrm{GL}(3,\mathbb{F}_2)=\mathrm{SL}(3,\mathbb{F}_2) \simeq \mathrm{PGL}(3,\mathbb{F}_2)=\mathrm{PSL}(3,\mathbb{F}_2)$. 

\begin{proof}
A matrix $M \in \mathrm{GL}(3,\mathbb{F}_2)$ is such that $\det(M)$ is invertible in $\F_2$, but only 1 is invertible in $\F_2$, so that $\det(M) = 1$ and $M \in \mathrm{SL}(3,\mathbb{F}_2)$. Therefore $\mathrm{GL}(3,\mathbb{F}_2) \subset \mathrm{SL}(3,\mathbb{F}_2)$, and $ \mathrm{SL}(3,F) \subset \mathrm{GL}(3,F)$ is true in every field $F$, thus
$$\mathrm{GL}(3,\mathbb{F}_2)=\mathrm{SL}(3,\mathbb{F}_2).$$

By definition, in any field $F$, $\mathrm{PGL}(n,F)=\mathrm{GL}(n,F)/F^*I$ and $\mathrm{PSL}(n,F)=\mathrm{SL}(n,F)/(F^*I\cap \mathrm{SL}(n,F))$. When $F=\mathbb{F}_2$, then $\mathbb{F}_2^*=\{1\}$, i.e., $\mathbb{F}_2^*I=(\mathbb{F}_2^*I\cap \mathrm{SL}(n,\mathbb{F}_2))=\{I\}$. Therefore, for n=3,
$$\mathrm{GL}(3,\mathbb{F}_2)=\mathrm{SL}(3,\mathbb{F}_2) \simeq \mathrm{PGL}(3,\mathbb{F}_2)=\mathrm{PSL}(3,\mathbb{F}_2).$$
\end{proof}
}

\paragraph{Ex. 13.3.12}

{\it Prove that  (13.31) from Example 13.3.4 is an example of a relative resolvent in the sense of Exercise 5. 

\begin{proof}
Suppose $f=x^4-c_1x^3+c_2x^2-c_3x+c_4 \in F[x]$ is separable and irreducible.
Let $H=\langle (1324),(12) \rangle$,  $G=\langle (1324)) \rangle \subset H$ and $\varphi=\sqrt{\Delta}(x_1+x_2-x_3-x_4)$. By Exercise 4, $G$ is the symmetry group of $\varphi$. Since $(12)\cdot \varphi=-\varphi$,  $H \cdot \varphi = \{\varphi,-\varphi\}$ is the orbit of $\varphi$ under the action of $H$.  Then $$\Theta_f^H(y)=( y - \varphi(\alpha_1,...,\alpha_4))( y + \varphi(\alpha_1,...,\alpha_4))=( y^2 - \varphi^2(\alpha_1,...,\alpha_4)),$$
where $\varphi^2(\alpha_1,...,\alpha_4)=\Delta(f)(4\beta_1+c_1^2-4c_2)$, $\beta_1=\alpha_1\alpha_2+\alpha_3\alpha_4$. By the assumption of Example 13.3.4, $\beta_1 \in F$, therefore $\Theta_f^H(y) \in F[y]$ and it is the relative resolvent in the sense of Exercise 5. 

Since $G_f \subset H$, depending on whether $\Theta_f^H(y)$ is reducible or not in $F$, the conclusion about whether $G_f=\langle (1324)) \rangle$ or $G_f=\langle (1324),(12) \rangle$ can be done.  

\end{proof}
}

\paragraph{Ex. 13.3.13}

{\it In the proof of Proposition 13.3.9, we showed that when $\mathrm{GL}(3,\mathbb{F}_2) \subset S_7$ acts on three-element subsets of $\{1,\ldots,7\}$, the orbits have lengths $7$ and $28$. We also asserted that up to conjugacy, $\mathrm{GL}(3,\mathbb{F}_2)$ is the only subgroup of $S_7$ with this property. In this exercise, you will study the action of some other subgroups of $S_7$.
\be
\item[(a)] Prove that $A_7$ and $S_7$ act transitively on three-element subsets of $\{1,\ldots,7\}$. Thus there is one orbit of length $35$ for these groups.
\item[(b)] In Section 13.2, the group $\mathrm{AGL}(1,\mathbb{F}_5) \subset S_5$ played an important role in understanding the Galois group of a quintic. In a similar way, we have $\mathrm{AGL}(1,\mathbb{F}_7) \subset S_7$ provided we think of the indices as congruences classes modulo $7$. Prove that the orbits of $A\mathrm{GL}(1,\mathbb{F}_7)$ acting on the triples $\{0,1,2\}$ and $\{0,1,3\}$ have $21$ and $14$ elements, respectively.
\ee

\begin{proof}
The action of a group G on the set of three-elements subsets of $\{1,\ldots,7\}$ is transitive when, for all triples of distinct elements $i,j,k$ and distinct elements $i',j',k'$, there is a $g\in G$ such that $\{g\cdot i,g\cdot j,g \cdot k\} = \{i',j',k'\}$ (which is less constraining that $\sigma(i) = i', \sigma(j) = j', \sigma(k) = k'$).

The distinctness of elements means $i\ne j$ and $j\ne k$ and $i\ne k$. The possibilities $i=i'$ (or $j'$ or $k'$) or $j=j'$ (or $i'$ or $k'$) or $k=k'$ (or $i'$ or $j'$) is allowed.
\be
\item[(a)]  Let $A$ be the set of three-elements subsets of $\{1,\ldots,7\}$. If $\{i,j,k\} \in A$, we show the existence of $\sigma \in A_7$ such that ${\sigma(1),\sigma(2), \sigma(3)} = \{i,j,k\}$.

Since $\mathrm{Card}(\{1,2,3\}) = \mathrm{Card}(\{i,j,k\}) = 3$, there exists some bijection $\sigma_1 :\{1,2,3\} \to \{i,j,k\}$, for instance $\sigma_1 : 1\mapsto k, 2 \mapsto i, 3 \mapsto j$.

Since $\mathrm{Card}(\{4,5,6,7\}) = \mathrm{Card}(\{1,\ldots,7\} \setminus \{i,j,k\}) = 4$, there exists a bijection $\sigma_2 : \{4,5,6,7\} \to \{1,\ldots,7\} \setminus \{i,j,k\}$. 

Then the map $s$ defined by $s(i) = \sigma_{1}(i)$ if $i\in \{1,2,3\}$ and $s(i) = \sigma_2(i)$ if $i\in \{4,5,6,7\}$ is a bijection, so that $s \in S_7$. 

If $s$ is even, take $\sigma = s$, and if $s$ is odd, take $\sigma = s \circ (1\, 2)$. In both cases $\sigma \in A_n$ and $\sigma(\{1,2,3\}) = \{i,j,k\}$.

Therefore the orbit of $\{1,2,3\}$ is $A_n \cdot \{1,2,3\} = A$, which  has 35 elements, so that $A_7$ acts transitively on three-element subsets of $\{1,\ldots,7\}$. A fortiori $S_n \supset A_n$ acts transitively on the same set.

\item[(b)] 
The following Sage instructions give the length of the orbits of $\{0,1,2\}$ and $\{0,1,3\}$
\begin{verbatim}
F = GF(7)

def t(a,b,i):
    return F(a*i + b)
	
def orbit(u,v,w):
    """ returns the orbit of {u,v,w} """
    orb = set()
        for a in range(1,7):
            for b in range(7):
                l = [t(a,b,u), t(a,b,v), t(a,b,w)]
                l.sort()
                orb.add(tuple(l))
    return orb
	
print(len(orbit(0,1,2)), len(orbit(0,1,3)))
\end{verbatim}
\begin{center}
(21,14)
\end{center}
For instance, the orbit of $\{0,1,3\}$ is
\begin{align*}
\mathrm{AGL}(1,\F_7) \cdot \{0,1,3\} =\{&\{3, 4, 6\}, \{2, 3, 5\}, \{0, 4, 5\}, \{2, 4, 5\}, \{0, 2, 3\}, \{0, 2, 6\}, \{1, 5, 6\}, \\
&\{3, 5, 6\}, \{1, 2, 4\}, \{1, 3, 4\}, \{0, 1, 5\}, \{1, 2, 6\}, \{0, 1, 3\}, \{0, 4, 6\} \}.
\end{align*}

Alternatively, one can find the isotropy group of these unordered triples :

The one-dimensional affine linear group $\mathrm{AGL}(1,\mathbb{F}_7)$ is the group of order $7 \times 6=42$ consisting of maps $i\mapsto ai+b$ where $i,a,b \in \mathbb{F}_7$ and $a \ne 0$. The isotropy group of an unordered triple $x^3=\{x_1,x_2,x_3\}$ is the subgroup $G_{x^3}=\{g\in \mathbb{F}_7\, |\, g\cdot x^3=x^3\}$. Solutions to the equations $ax_i+b=x_{\sigma(i)},~i\in(1,2,3), \sigma \in S_3$ are giving the elements of isotropy group.

In matrix form the equations are:
$$
\left(\begin{array}{rr}
x_{1} & 1 \\
x_{2} & 1 \\
x_{3} & 1 
\end{array}\right)
\left(\begin{array}{r}
a \\
b 
\end{array}\right)=
\left(\begin{array}{r}
x_{\sigma(1)}  \\
x_{\sigma(2)}  \\
x_{\sigma(3)}  
\end{array}\right)
$$
The extended matrix for all $\sigma \in S_3$ excluding identity permutation is: 

$$
\left(\begin{array}{rr|rrrrr}
x_{1} & 1 & x_{1} & x_{2} & x_{2} & x_{3} & x_{3} \\
x_{2} & 1 & x_{3} & x_{1} & x_{3} & x_{1} & x_{2} \\
x_{3} & 1 & x_{2} & x_{3} & x_{1} & x_{2} & x_{1}
\end{array}\right)
$$
 \item[$\bullet$] Case $x^3=(0,1,2)$: Gauss transformation of extended matrix to bring the first two columns to 
$$
\left(\begin{array}{rr}
0 & 1 \\
1 & 0 \\
0 & 1 
\end{array}\right) 
$$
\rm gives:
$$
\left(\begin{array}{rrrrrrr}
0 & 1 & 0 & 1 & 1 & 2 & 2 \\
1 & 1 & 2 & 0 & 2 & 0 & 1 \\
2 & 1 & 1 & 2 & 0 & 1 & 0
\end{array}\right)=
\left(\begin{array}{rrrrrrr}
0 & 1 & 0 & 1 & 1 & 2 & 2 \\
1 & 0 & 2 & 6 & 1 & 5 & 6 \\
2 & 1 & 1 & 2 & 0 & 1 & 0
\end{array}\right)=
\left(\begin{array}{rrrrrrr}
0 & 1 & 0 & 1 & 1 & 2 & 2 \\
1 & 0 & 2 & 6 & 1 & 5 & 6 \\
0 & 1 & 4 & 4 & 5 & 5 & 2
\end{array}\right)
$$
There is only one solution corresponding to $a=6,b=2$, i.e., the order of isotropy group is $2$ and (cf. Theorem A.4.9) the appropriate orbit has $42/2=21$ elements.  

 \item[$\bullet$] Case $x^3=(0,1,3)$:
 $$
\left(\begin{array}{rrrrrrr}
0 & 1 & 0 & 1 & 1 & 3 & 3 \\
1 & 1 & 3 & 0 & 3 & 0 & 1 \\
3 & 1 & 1 & 3 & 0 & 1 & 0
\end{array}\right)=
\left(\begin{array}{rrrrrrr}
0 & 1 & 0 & 1 & 1 & 3 & 3 \\
1 & 0 & 3 & 6 & 2 & 4 & 5 \\
3 & 1 & 1 & 3 & 0 & 1 & 0
\end{array}\right)=
\left(\begin{array}{rrrrrrr}
0 & 1 & 0 & 1 & 1 & 3 & 3 \\
1 & 0 & 3 & 6 & 2 & 4 & 5 \\
0 & 1 & 6 & 6 & 1 & 3 & 6
\end{array}\right)
$$
There are two solutions corresponding to $a=2,b=1$ and $a=4,b=3$, i.e., the order of isotropy group is $3$, hence the appropriate orbit has $42/3=14$ elements.
\ee
\end{proof}
}

\paragraph{Ex. 13.3.14}

{\it  The quadratic resolvent $D_f(y)$ used in Theorem 13.3.5 to compute the Galois group of a quartic in all characteristics was defined for a polynomial f of degree 4. Here you will study what happens when f is monic of degree n. We begin with the polynomial
$$D=\sum_{\sigma \in A_n} \sigma \cdot x_1^{n-1}x_2^{n-2} \dots x_{n-2}^2x_{n-1} \in F[x_1,...,x_n],$$
where F is a field of any characteristic.
\be
\item[(a)] Prove that $A_n$ is the symmetry group of D.
\item[(b)] Prove that $\sqrt \Delta = \prod_{1\leq i<j\leq n}(x_i-x_j)$ satisfies $\sqrt \Delta =D-D'$, where $D'=(12)\cdot D$.
\item[(c)] Let $f\in F[x]$ be monic of degree n and let $\alpha_1,...,\alpha_n$ be the roots of f in some splitting field L. Then define $D(f)=D(\alpha_1,...,\alpha_n)$ and $D'(f)=D'(\alpha_1,...,\alpha_n)$ and set 
$$D_f(y)=(y-D(f))(y-D'(f)).$$
Prove that $D_f(y)\in F[y]$ and that the discriminant of $D_f(y)$ is $\Delta(f)=\prod_{1\leq i<j\leq n}(\alpha_i-\alpha_j)^2$. Note that D(f) and $D'(f)$ depend on how we order the roots while the polynomial $D_f(y)$ depends only on f.
\item[(d)] Assume that f is separable and let $Gal(L/F) \simeq G_f \subset S_n$. Prove that $G_f \subset A_n$ if and only if $D_f(y)$ splits over F.
\ee
\begin{proof}
\be
\item[(a)] We proved in Exercise 12.1.9(b) that the symmetry group of
 $$\sum_{\sigma \in H} \sigma \cdot x_1^{n-1}x_2^{n-2} \dots x_{n-2}^2x_{n-1}$$
 is $H$.
 
Thus, $A_n$ is the symmetry group of 
$$D = \sum_{\sigma \in A_n} \sigma \cdot x_1^{n-1}x_2^{n-2} \dots x_{n-2}^2x_{n-1}.$$
\item[(b)] 
We proved in Ex. 2.4.1 the formula
$$\sqrt{\Delta} =\prod\limits_{1 \leq i < j \leq n} (x_i- x_j) =
\begin{vmatrix}
x_1^{n-1}&  x_2^{n-1} &   \cdots   & x_n^{n-1}\\
x_1^{n-2}&  x_2^{n-2} &   \cdots   & x_n^{n-2}\\
\vdots & \vdots & \ddots & \vdots\\
x_1&  x_2 &   \cdots   & x_n\\
1    & 1     &   \cdots    & 1\\
\end{vmatrix}
$$



By definition of the determinant, if $A = (a_{i,j})_{1\leq i,j \leq n}$
$$\det(A)=\sum_{\sigma \in S_n}\mathrm{sgn}(\sigma)  \prod_{i=1}^n a_{\sigma(i),i},
$$
and
$$ 
 \det(A) = \det(\,^t A) =\sum_{\sigma \in S_n}\mathrm{sgn}(\sigma)  \prod_{i=1}^n a_{i,\sigma(i)}.
$$
Applying this formula to $a_{i,j} = x_j^{n-i}$, with $\varphi = x_1^{n-1} x_2^{n-2}\cdots x_{n-1}$ and $\tau = (1\,2)$, we obtain
\begin{align*}
\sqrt{\Delta} &= \sum_{\sigma \in S_n} \mathrm{sgn}(\sigma)  x_{\sigma(1)}^{n-1} x_{\sigma(2)}^{n-2}\cdots x_{\sigma(n-1)}\\
&= \sum_{\sigma \in S_n} \mathrm{sgn}(\sigma)\  \sigma\cdot x_1^{n-1} x_2^{n-2}\cdots x_{n-1}\\
&= \sum_{\sigma \in A_n}  \sigma\cdot \varphi-  \sum_{\sigma \in S_n\setminus A_n} \sigma\cdot \varphi\\
&= \sum_{\sigma \in A_n} \sigma\cdot \varphi - \sum_{\sigma \in A_n} (\tau\sigma) \cdot \varphi\\
&=D - \tau\cdot D = D - D'.
\end{align*}


\item[(c)] Since $S_n = A_n \coprod \tau A_n$,
$$D + D' =  \sum_{\sigma \in S_n} \sigma\cdot \varphi.$$
For each $\chi \in S_n$, 
$$\chi \cdot (D+D') = \sum_{\sigma \in S_n} (\chi\sigma) \cdot \varphi  = \sum_{\sigma' \in S_n} \sigma' \cdot \varphi  = D+D' \qquad (\sigma' = \chi \sigma).$$
Therefore the symmetry group of $D+D'$ is $S_n$.

Since $(D(f)+ D'(f)=  (D+D')(\alpha_1,\ldots,\alpha_n)$, where $D+D'$ is a symmetric polynomial, $D(f) + D'(f) \in F$.

Moreover
$$DD' = \sum_{\sigma \in A_n} \sigma\cdot \varphi \sum_{\sigma' \in A_n} (\tau \sigma')\cdot \varphi.$$

Similarly, if $\chi \in A_n$, then $\chi \cdot D = D$. Since 
$$D' =\sum_{\sigma' \in A_n} (\tau \sigma')\cdot \varphi = \sum_{\sigma'' \in A_n}(\sigma'' \tau) \cdot \varphi,$$
$\chi \cdot D' = D'$.

Therefore $\chi\cdot (DD') = DD'$ for all $\chi \in A_n$, and 
$$\tau \cdot (DD') = \sum_{\sigma \in A_n} (\tau\sigma)\cdot \varphi \sum_{\sigma' \in A_n}  \sigma' \cdot \varphi = D'D = DD',$$
so that $\chi\cdot (DD') = DD'$ for all $\chi \in S_n$, and $DD'$ is a symmetric polynomial. Thus $D(f) D'(f) = (DD')(\alpha_1,\ldots,\alpha_n) \in F$.

This proves 
$$D_f(y) = (y - D(f))(y - D'(f)) = y^2 - (D(f)+D'(f)) y + D(f)D'(f) \in F[y].$$

Finally, the evaluation mapping $(x_1,\ldots,x_n) \mapsto (\alpha_1,\ldots,\alpha_n)$ gives
$$\sqrt{\Delta(f)} = \prod_{1\leq i < j \leq n }(\alpha_i - \alpha_j),$$
thus
$$\Delta(f) =  \prod_{1\leq i < j \leq n} (\alpha_i - \alpha_j)^2.$$


\item[(d)] 
The discriminant of $D_f(y)$ is $(D(f) - D'(f))^2 = \sqrt{\Delta(f)} \ne 0$, since we assumed that $f$ is separable. Therefore $D_f(y)$ is separable, so that the roots $D(f) ,D'(f)$ are simple roots.

Since $D_f(y)$ is the resolvent associated to $\varphi$ with symmetry group $A_n$, Proposition 13.3.2 shows that $G_f \subset A_n$ if and only if $D_f(y)$ has a root in $F$, if and only if $D_f(y)$ splits over $F$.

\ee
\end{proof}
}

\paragraph{Ex. 13.3.15}

{\it Let $f=x^3-c_1x^2+c_2x-c_3 \in F[x]$ and let $D_f(y) \in F[y]$ be as in the previous exercise.
\be
\item[(a)] Show that $D_f(y)=y^2-(c_1c_2-3c_3)y+c_2^3+c_1^3c_3-6c_1c_2c_3+9c_3^2$.
\item[(b)] Assume in addition that f is separable and irreducible. Explain how $D_f(y)$ determines Galois group of f up to isomorphism.
\ee

\begin{proof}
\be
\item[(a)] By (2.26), we obtain
$$\Delta(f)=-4c_2^3-27c_3^2+c_1^2c_2^2-4c_1^3c_3+18c_1c_2c_3,$$
and by Ex.2.2.10,
 $$D+D'=\sum_{\sigma \in A_3}\sigma\cdot x_1^2x_2+(12)\sum_{\sigma \in A_3}\sigma\cdot x_1^2x_2=\sum_{\sigma \in S_3}\sigma\cdot x_1^2x_2=\sigma_1\sigma_2-3\sigma_3,$$ 
 so that
 $$D(f) + D'(f) = c_1c_2 - 3c_3.$$
(Note: If the characteristic is not 2, we could write
$$D(f) = \frac{1}{2}(D(f) + D'(f) + (D(f) - D'(f)) = \frac{1}{2}(c_1c_2 - 3c_3 \pm \sqrt{\Delta(f)}),$$
and compute $D(f)D'(f)$, but here we compute in all characteristic.)

But $DD'$ is symmetric, where
\begin{align*}
D D' &= \left(\sum_{\sigma \in A_3}\sigma\cdot x_1^2x_2\right)\left(\sum_{\sigma \in A_3}(\tau\sigma)\cdot x_1^2x_2\right)\\
&=(x_1^2x_2+x_2^2x_3+x_3^2x_1)(x_2^2x_1+x_1^2x_3+x_3^2x_2)\\
&=x_{1}^{3} x_{2}^{3} + x_{1}^{4} x_{2} x_{3} + x_{1} x_{2}^{4} x_{3} + 3 x_{1}^{2} x_{2}^{2} x_{3}^{2} + x_{1}^{3} x_{3}^{3} + x_{2}^{3}x_{3}^{3} + x_{1} x_{2} x_{3}^{4} 
\end{align*}
With the usual Sage instructions, we obtain $D(f)D'(f)$
\begin{verbatim}
R.<x1,x2,x3,y1,y2,y3> = PolynomialRing(QQ, order = 'degrevlex')
elt = SymmetricFunctions(QQ).e()
e = [elt([i]).expand(3).subs(x0=x1, x1=x2, x2=x3) for i in range(4)]
J = R.ideal(e[1]-y1, e[2]-y2, e[3]-y3)
G = J.groebner_basis()
f = (x1^2*x2+x2^2*x3+x3^2*x1)*(x2^2*x1+x1^2*x3+x3^2*x2)
var('sigma_1,sigma_2,sigma_3')
var('c1,c2,c3')
g=f.reduce(G).subs(y1=c1,y2=c2,y3=c3)
g
\end{verbatim}
$$c_{1}^{3} c_{3} + c_{2}^{3} - 6 \, c_{1} c_{2} c_{3} + 9 \, c_{3}^{2}$$
Then 
\begin{align*}
 D(f)D'(f) &= c_2^3+c_1^3c_3-6c_1c_2c_3+9c_3^2
\end{align*}
and 
\begin{align*}
D_f(y) &=y^2-(D(f)+D'(f))y+D(f)D'(f) \\
& =y^2-(c_1c_2-3c_3)y+c_2^3+c_1^3c_3-6c_1c_2c_3+9c_3^2
\end{align*}
\item[(b)] By Ex.6.2.6, $f$ being irreducible and separable, we know that $3 \mid |G_f|$. Therefore $G_f = A_3$ or $G_f = S_3$. Then Ex.14(d) proves that
\begin{align*}
G_f &= A_3 \iff D_f(y)\text{ splits over } F,\\
G_f &=S_3 \iff D_f(y) \text{ is irreducible over } F.
\end{align*}
\ee
\end{proof}
}

\subsection{Other Methods}

\paragraph{Ex. 13.4.1}

{\it Verify the computations given in Example 13.4.1.
\begin{proof}
\be
The following Sage instructions:
\begin{verbatim}
R.<y,x1,x2,x3,sigma1,sigma2,sigma3,u1,u2,u3> = PolynomialRing(QQ, order = 'lex')
elt = SymmetricFunctions(QQ).e()
e = [elt([i]).expand(3).subs(x0=x1, x1=x2, x2=x3) for i in range(4)]
J = R.ideal(e[1]-sigma1, e[2]-sigma2, e[3]-sigma3)
G = J.groebner_basis()
S = y-(u1*x1 + u2*x2 + u3*x3)
S1 = S  * S.subs(x1=x1,x2=x3,x3=x2) * S.subs(x1=x2,x2=x1,x3=x3)
S1 = S1 * S.subs(x1=x2,x2=x3,x3=x1) * S.subs(x1=x3,x2=x1,x3=x2)
S = S1 * S.subs(x1=x3,x2=x2,x3=x1)
S = S.subs(u1=-1,u2=1,u3=2)
f = S.reduce(G).polynomial(y)
f
\end{verbatim}
give output $S(y)$:
\begin{align*}
& y^{6} - 4\sigma_{1}y^{5} + (2\sigma_{1}^{2} + 14\sigma_{2}) y^{4} + (8 \sigma_{1}^{3} - 44\sigma_{1} \sigma_{2} + 20\sigma_{3}) y^{3} \\
& + (-7\sigma_{1}^{4} + 18 \sigma_{1}^{2} \sigma_{2} + 49 \sigma_{2}^{2} - 40\sigma_{1} \sigma_{3}) y^{2} + (-4 \sigma_{1}^{5} + 44\sigma_{1}^{3} \sigma_{2} \\ & - 112\sigma_{1} \sigma_{2}^{2} - 20\sigma_{1}^{2} \sigma_{3} + 140\sigma_{2} \sigma_{3}) y+4\sigma_{1}^{6}  - 32 \sigma_{1}^{4}\sigma_{2} + 55 \sigma_{1}^{2} \sigma_{2}^{2} \\
& + 36\sigma_{2}^{3} + 76 \sigma_{1}^{3} \sigma_{3} - 322  \sigma_{1} \sigma_{2} \sigma_{3} + 343 \sigma_{3}^{2}. 
\end{align*}
Using $\sigma_1 \mapsto -1,\sigma_2 \mapsto -2,\sigma_3 \mapsto 1$, we obtain:
\begin{verbatim}
f1 = f.subs(sigma_1=-1, sigma_2=-2, sigma_3=1); f1
\end{verbatim}
$$y^{6} + 4 y^{5} - 26 y^{4} - 76 y^{3} + 193 y^{2} + 240 y - 377$$
The Sage output coincides with Example 13.4.1:
\begin{verbatim}
factor(f1)
\end{verbatim}
$$(y^{3} + 2 y^{2} - 15 y - 29) \cdot (y^{3} + 2 y^{2} - 15 y + 13)$$
\ee\end{proof}
}

\paragraph{Ex. 13.4.2}

{\it Prove that the polynomial $s_u(y)$ defined in (13.41) lies in $K[u_1,...,u_n,y]$.
\begin{proof}
\be
Let $f(x)=x^n-c_1x^{n-1}+...+(-1)^n c_n \in K[x]$. The universal version of $s_u(y)$ is given by :
$$S(y)=\prod_{\sigma\in S_n} ( y - (u_1x_{\sigma(1)}+...+u_nx_{\sigma(n)}))\in K[x_1,...,x_n,u_1,...,u_n,y]$$
For any $\tau \in S_n$, 
\begin{align*}
\tau \cdot S(y)&=\prod_{\sigma\in S_n} ( y - (u_1x_{(\tau\sigma)(1)}+...+u_nx_{(\tau\sigma)(n)}))\\&=\prod_{\sigma'\in S_n} ( y - (u_1x_{\sigma'(1)}+...+u_nx_{\sigma'(n)}))=S(y).
\end{align*}

Thus the application of $\tau$ has merely permuted the roots of $S(y)$ leaving the coefficients fixed. It means that the coefficients of $S(y)$ are symmetric and are polynomials in $\sigma_1,...,\sigma_n$ (cf. Ex.9.1.6), i.e., $S(y)\in K[\sigma_1,...,\sigma_n,u_1,...,u_n,y]$.

The application of evaluation map $\sigma_i \mapsto c_i$ to $S(y)$ gives $s_u(y) \in K[c_1,...,c_n,u_1,...,u_n,y] = K[u_1,...,u_n,y]$. 

\ee\end{proof}
}

\paragraph{Ex. 13.4.3}

{\it This exercise is concerned with the proof of Theorem 13.4.2.
\be
\item[(a)] Let $\beta_1,...,\beta_n\in L$. Prove that $y+\sum_{i=1}^r\beta_iu_i$ is irreducible in $L[u_1,...,u_n,y]$. (This implies that (13.41) is the irreducible factorization of $s_u(y)$ in $L[u_1,...,u_n,y]$.)
\item[(b)] Let $g,h\in F[u_1,...,u_n,y]$, and assume that in the larger ring $L[u_1,...,u_n,y]$ we have $h=gq$ for some $q\in L[u_1,...,u_n,y]$. Prove that $q\in F[u_1,...,u_n,y]$.
\item[(c)] In the final part of the proof of Theorem 13.4.2, we showed that $G\subset\sigma^{-1}G_f\sigma$. Prove the opposite inclusion.
\ee
\begin{proof}
\be
\item[(a)] Assume that $h=y+\sum_{i=1}^r\beta_iu_i$ is reducible, i.e., $h=ge$ with $g,e\in L[u_1,...,u_n,y]$. In the ring $L[u_1,...,u_n][y]$ the polynomial $h$ is clearly irreducible as every polynomial of degree 1. Then $g$ or $e$ is in $L[u_1,...,u_n]$. In case $g\in L[u_1,...,u_n]$, the comparison of coefficients in $y$ gives $g\mid 1$, and then $g$ is a unit in $L[u_1,\ldots,u_n,y]$. 

Hence the assumption is wrong and $h$ is irreducible in $L[u_1,...,u_n,y]$.
\item[(b)] The equality $h = gq$, where $h,g,q \in L[u_1,\ldots,u_n,y]$, is also true in the ring $L(u_1,\ldots,u_n)[y] = K[y]$, 
where $K = L(u_1,\ldots,u_n)$ is a field, so that $K[y]$ is an Euclidean ring. Write $k = F(u_1,\ldots,u_n)$. 

The division in the Euclidean ring $k[y]$ gives $q_1,r_1 \in k[y]$ such that $h = gq_1+r_1$. The two equalities $f =g q = q_1 g +r_1$ in $K[y]$, and the unicity of the division in this ring proves $q = q_1 \in F(u_1,\ldots,u_n)[y]$. Moreover $q \in L[u_1,\ldots,u_n,y]$ is a polynomial, therefore $q \in F[u_1,\ldots,u_n,y]$.

\item[(c)] 
By the proof of Theorem 13.4.2, 
$$h = \prod_{\mu \in G_f} \left(y - \prod_{i = 1}^n u_i \alpha_{\mu \sigma(i)} \right) \qquad (= \tilde{h}).$$
Let $\tau \in \sigma^{-1} G_f \sigma$. There exists $\nu \in G_f$ such that $\tau = \sigma^{-1} \nu^{-1} \sigma$. Then
\begin{align*}
\tau \cdot h &= \prod_{\mu \in G_f}  \left(y - \prod_{i = 1}^n u_{(\sigma^{-1} \nu^{-1} \sigma)(i)} \alpha_{(\mu \sigma)(i)} \right) \\
&=\prod_{\mu \in G_f}  \left(y - \prod_{j= 1}^n u_{(\sigma^{-1} \nu^{-1})(j) } \alpha_{\mu (j)} \right) \qquad (j = \sigma(i))\\
&= \prod_{\mu \in G_f}  \left(y - \prod_{k= 1}^n u_k \alpha_{(\mu \nu \sigma)(k)} \right) \qquad (k =( \sigma^{-1} \nu^{-1})(j))\\
&= \prod_{\lambda \in G_f}  \left(y - \prod_{k= 1}^n u_k \alpha_{(\lambda \sigma)(k)} \right) \qquad (\lambda = \mu \nu)\\
&=  \prod_{\mu \in G_f} \left(y - \prod_{i = 1}^n u_i \alpha_{(\mu \sigma)(i)} \right)\\
&= h.
\end{align*}
Therefore $\tau \in G$. We have proved $\sigma^{-1} G_f \sigma \subset G$.
\ee\end{proof}
}

\paragraph{Ex. 13.4.4}

{\it Consider the polynomial $s_u(y)$ when $f=x^3+x^2-2x-1$ from Example 13.4.3.
\be
\item[(a)] Compute $s_u(y) \in \mathbb{Q}[u_1,u_2,u_3,y]$, and derive factorization given in Example 13.4.3.
\item[(b)] Let h be the first factor of $s_u(y)$ given in Example 13.4.3, multiplied by -1 so that it is monic in y. Using Sage, write h as a polynomial in y so that its coefficients are of the form
\begin{align*}
\rm a~symmetric~polynomial~in~ \it u_1,u_2,u_3 \rm ~+~ a~remainder~in~ \it u_1,u_2,u_3. 
\end{align*}
This should give the formula for h given in Example 13.4.3. 
\ee
\begin{proof}
\be
\item[(a)] The following Sage instructions:
\begin{verbatim}
R.<y,x1,x2,x3,sigma1,sigma2,sigma3,u1,u2,u3> = PolynomialRing(QQ, order = 'lex')
elt = SymmetricFunctions(QQ).e()
e = [elt([i]).expand(3).subs(x0=x1, x1=x2,x2=x3) for i in range(4)]
J = R.ideal(e[1]-sigma1, e[2]-sigma2, e[3]-sigma3)
G = J.groebner_basis()
S = y - (u1*x1 + u2*x2 + u3*x3)
S1 = S * S.subs(x1=x1,x2=x3,x3=x2) *S .subs(x1=x2,x2=x1,x3=x3)
S1 = S1 * S.subs(x1=x2,x2=x3,x3=x1) * S.subs(x1=x3,x2=x1,x3=x2)
S = S1 * S.subs(x1=x3,x2=x2,x3=x1)
s = S.reduce(G).polynomial(y)
sf = s.subs(sigma1=-1,sigma2=-2,sigma3=1)
dec = sf.factor(); dec
\end{verbatim}
give the same output as in Example 13.4.3:
\begin{align*}
s_u(y)&=       	
(-y^{3} + \left(- u_{1} -  u_{2} -  u_{3}\right) y^{2} + \left(2
u_{1}^{2} - 3 u_{1} u_{2} + 2 u_{2}^{2} - 3 u_{1} u_{3} - 3 u_{2} u_{3}
+ 2 u_{3}^{2}\right) y \\
&+ u_{1}^{3} - 4 u_{1}^{2} u_{2} + 3 u_{1}
u_{2}^{2} + u_{2}^{3} + 3 u_{1}^{2} u_{3} -  u_{1} u_{2} u_{3} - 4
u_{2}^{2} u_{3} - 4 u_{1} u_{3}^{2} + 3 u_{2} u_{3}^{2} + u_{3}^{3})\\
&\cdot (-y^{3} + \left(- u_{1} -  u_{2} -  u_{3}\right) y^{2} + \left(2
u_{1}^{2} - 3 u_{1} u_{2} + 2 u_{2}^{2} - 3 u_{1} u_{3} - 3 u_{2} u_{3}
+ 2 u_{3}^{2}\right) y\\ 
&+ u_{1}^{3} + 3 u_{1}^{2} u_{2} - 4 u_{1}
u_{2}^{2} + u_{2}^{3} - 4 u_{1}^{2} u_{3} -  u_{1} u_{2} u_{3} + 3
u_{2}^{2} u_{3} + 3 u_{1} u_{3}^{2} - 4 u_{2} u_{3}^{2} + u_{3}^{3})
\end{align*}
\item[(b)] The following Sage instruction:
\begin{verbatim}
h =  (-1)* dec[1][0]; h
\end{verbatim}
gives the second (it's the good one) irreducible factor $h$ of $s_u(y)$, given in Example 13.4.3, multiplied by -1:
\begin{align*}
h=& y^{3} + \left(u_{1} + u_{2} + u_{3}\right) y^{2} + \left(-2 u_{1}^{2} +
3 u_{1} u_{2} - 2 u_{2}^{2} + 3 u_{1} u_{3} + 3 u_{2} u_{3} - 2
u_{3}^{2}\right) y \\
&-  u_{1}^{3} - 3 u_{1}^{2} u_{2} + 4 u_{1} u_{2}^{2}
-  u_{2}^{3} + 4 u_{1}^{2} u_{3} + u_{1} u_{2} u_{3} - 3 u_{2}^{2} u_{3}
- 3 u_{1} u_{3}^{2} + 4 u_{2} u_{3}^{2} -  u_{3}^{3}
\end{align*}
A second reduction doesn't give quite the expected result 
\begin{verbatim}
R.<y,u1,u2,u3,sigma1,sigma2,sigma3> = PolynomialRing(QQ, order = 'lex')
elt = SymmetricFunctions(QQ).e()
e = [elt([i]).expand(3).subs(x0=u1, x1=u2,x2=u3) for i in range(4)]
J = R.ideal(e[1]-sigma1, e[2]-sigma2, e[3]-sigma3)
G = J.groebner_basis()
g = R(h).reduce(G).polynomial(y); g
\end{verbatim}
$$y^{3} + \sigma_{1} y^{2} + \left(-2 \sigma_{1}^{2} + 7 \sigma_{2}\right)
y + 21 u_{2} u_{3}^{2} - 14 u_{2} u_{3} \sigma_{1} - 7 u_{3}^{2}
\sigma_{1} + 7 u_{3} \sigma_{1}^{2} -  \sigma_{1}^{3} + 7 u_{2}
\sigma_{2} - 7 u_{3} \sigma_{2} + 7 \sigma_{3}
$$
But this last instructions verify the formula of the text:
\begin{verbatim}
S.<u1,u2,u3>=ZZ[]
A=S(h(0))
B = 7*sigma3 -sigma1^3 + 7*(u1*u2^2  + u1^2*u3 + u2*u3^2)
B = B.subs(sigma1 = e[1],sigma2=e[2], sigma3=e[3])
B = S(B)
A-B
\end{verbatim}
$$0$$
This is a verification of
\begin{align*}
h&=y^{3}+ (u_{1} + u_{2} + u_{3}) y^{2} + (7(u_{1} u_{2} + u_{1} u_{3} + u_{2} u_{3})-2(u_{1} + u_{2} + u_{3})^{2}) y\\ 
& +7u_{1} u_{2} u_{3}-(u_{1} + u_{2} + u_{3})^{3}+ 7(u_{1} u_{2}^{2} + u_{1}^{2} u_{3} + u_{2} u_{3}^{2}).
\end{align*}

\ee\end{proof}
}

\paragraph{Ex. 13.4.5}

{\it Use the method of part (a) of Exercise 4 to derive the factorization of $s_u(y)$ given in Example 13.4.4.
\begin{proof}
\be
The following Sage instructions :
\begin{verbatim}
R.<y,x1,x2,x3,sigma1,sigma2,sigma3,u1,u2,u3> = PolynomialRing(QQ, order = 'lex')
elt = SymmetricFunctions(QQ).e()
e = [elt([i]).expand(3).subs(x0=x1, x1=x2,x2=x3) for i in range(4)]
J = R.ideal(e[1]-sigma1, e[2]-sigma2, e[3]-sigma3)
G = J.groebner_basis()
S = y - (u1*x1 + u2*x2 + u3*x3)
S1 = S * S.subs(x1=x1,x2=x3,x3=x2) * S.subs(x1=x2,x2=x1,x3=x3)
S1 = S1 * S.subs(x1=x2,x2=x3,x3=x1) * S.subs(x1=x3,x2=x1,x3=x2)
S = S1 * S.subs(x1=x3,x2=x2,x3=x1)
s = S.reduce(G).polynomial(y)
sf = s.subs(sigma1=0,sigma2=0,sigma3=1)
dec = sf.factor(); dec 
\end{verbatim}
give the same output as in Example 13.4.4:
\begin{align*}
s_u(y)=&       	
(y^{2} + \left(-2 u_{1} + u_{2} + u_{3}\right) y + u_{1}^{2} -  u_{1}
u_{2} + u_{2}^{2} -  u_{1} u_{3} -  u_{2} u_{3} + u_{3}^{2}) \cdot\\
& 
(y^{2} + \left(u_{1} - 2 u_{2} + u_{3}\right) y + u_{1}^{2} -  u_{1}
u_{2} + u_{2}^{2} -  u_{1} u_{3} -  u_{2} u_{3} + u_{3}^{2}) \cdot\\
&
(y^{2} + \left(u_{1} + u_{2} - 2 u_{3}\right) y + u_{1}^{2} -  u_{1}
u_{2} + u_{2}^{2} -  u_{1} u_{3} -  u_{2} u_{3} + u_{3}^{2})
\end{align*}

\ee\end{proof}
}

\paragraph{Ex. 13.4.6}

{\it As in the proof of Theorem 13.4.5, suppose that we have $s_u(y)\in \mathbb{Z}[u_1,...,u_n,y]$ and $h\in \mathbb{Q}[u_1,...,u_n,y]$ is an irreducible factor of $s_u(y)$ when $s_u(y)$ is regarded as an element of $\mathbb{Q}[u_1,...,u_n,y]$. In this exercise we will study how close $h$ is to being an irreducible factor of $s_u(y)$ in $\mathbb{Z}[x_1,...,x_n,y]$.
\be
\item[(a)] We know that the rings $\mathbb{Z}[x_1,...,x_n,y]$ and $\mathbb{Q}[x_1,...,x_n,y]$ are both UFDs. Prove that if $f\in\mathbb{Z}[x_1,...,x_n,y]$ is irreducible and nonconstant, then it is also irreducible when regarded as an element of $\mathbb{Q}[x_1,...,x_n,y]$.
\item[(b)] Prove that $s_u(y)$ and $h$ are as above, then $h$ is a $\mathbb{Q}$-multiple of an irreducible factor of $s_u(y)$ in  $\mathbb{Z}[x_1,...,x_n,y]$. 
\ee
\begin{proof}
\be
\item[(a)] 
Assume that $f\in\mathbb{Z}[x_1,...,x_n,y]$ is irreducible and nonconstant.

 Suppose that $f = g h$, where $g,h$ are in $\Q[x_1,\ldots,x_n,y]$. There are positive integers $r,s$ such that $rg, sh \in \Z[x_1,\ldots,x_n,y]$ (it is not needed to take $r,s$ as small as possible). Then $rs f = (rg)(sh) =g_1 h_1$, where $g_1 = rg, h_1 = sh$ are in $\Z[x_1,\ldots,x_n,y]$.
 
Write $rs = p_1^{a_1}\cdots p_r^{a_r}$ the decomposition of $rs$ in prime integers. Note that every prime in $\Z$ is irreducible in $\Z[x_1,\ldots,x_n]$, so that 
$$rs f = p_1^{a_1}\cdots p_r^{a_r}f$$
is a decomposition in irreducible factors in $\Z[x_1,\ldots,x_n]$. The only units of this UFD are $\pm 1$, so that the unicity of the decomposition in irreducible factors in $\Z[x_1,\ldots,x_n]$ shows that the decompositions of $g_1=rg,h_1=sh$ are in the form
$$ g_1 = \pm p_1^{b_1}\cdots p_r^{b_r} f,\qquad  h_1 = \pm  p_1^{c_1}\cdots p_r^{c_r},$$
or
$$ g_1 = \pm p_1^{b_1}\cdots p_r^{b_r} ,\qquad h_1 = \pm  p_1^{c_1}\cdots p_r^{c_r} f.$$
Therefore $h_1$ or $g_1$ is in $\Z$, thus $g$ or $h$ is in $\Q$, so is a unit in $\Q[x_1,\ldots,x_n,y]$. This proves that $f$ is irreducible in $\Q[x_1,\ldots,x_n,y]$.


\item[(b)] Since $\mathbb{Z}[x_1,...,x_n,y]$ is UFD, $s_u(y)$ can be uniquely factorized $s_u(y)=h_1\cdots h_n$, where $h_1,...,h_n\in\mathbb{Z}[x_1,...,x_n,y]$ and are irreducible. By the part (a), $h_1,...,h_n$ are irreducible when regarded as elements of $\mathbb{Q}[x_1,...,x_n,y]$. Hence for any  irreducible factor $h\in\mathbb{Q}[x_1,...,x_n,y]$  of $s_u(y)$, there exists $i$ such that $h\mid h_i$. It follows that $h$ is associate to $h_i$, $h=\lambda h_i, \lambda \in \Q$, is the product of $h_i$ by a suitable constant from $\mathbb{Q}$, where $h_i$ is a factor of $s_u(y)$ irreducible in $\mathbb{Z}[x_1,...,x_n,y]$.
\ee
\end{proof}
}

\paragraph{Ex. 13.4.7}

{\it Let $f=x^5+20x+16 \in \mathbb{Q}[x]$ be the polynomial of Example 13.4.6. Show that f is irreducible over $\mathbb{Q}$, and compute its discriminant and irreducible factorization modulo $7$.
\begin{proof}
\be
The given polynomial $f$ is irreducible, since $f(x-1)=(x-1)^5+20(x-1)+16=x^5-5x^4+10x^3-10x^2+25x-5$ is irreducible by Sch\"onemann-Eisenstein criterion with $p=5$.

The discriminant may be calculated by the formula (cf. Ex.13.2.15):
$$\Delta(f) = 256a^5+3125b^4,$$
where $a=20,b=16$. Then
\begin{align*}
\Delta(f) &= 2^820^5+5^516^4=2^{18}5^5+5^52^{16}=2^{16}5^5(4+1)=2^{16}5^6.
\end{align*}
Reducing the polynomial modulo 7 gives:
$\bar f(x)=x^5+6x+2$. 

We have $\bar f(4)=\bar f(5)=0$ and $\bar f(i)\ne 0$ for $i\in \{0,1,2,3,6\}$. Division of $\bar f$ by $(x-4)=(x+3)$ and $(x-5)=(x+2)$ gives:
$$\bar f=(x+2)(x+3)(x^3+2x^2+5x+5) ~~ in~\mathbb{F}_7.$$
\ee\end{proof}
}

\paragraph{Ex. 13.4.8}

{\it Compute the Galois group of  $f=x^5-6x+3$ over $\mathbb{Q}$ using reduction modulo 11 and the method of Example 13.4.6.
}
\begin{proof}

The discriminant calculation (cf. Ex.13.2.15):
$$\Delta(f) = 256a^5+3125b^4,$$
where $a=-6,b=3$. Then
\begin{align*}
\Delta(f) &= 2^8(-6)^5+5^53^4=3^4(5^5-3\cdot 2^{13})=3^4(3125-256\cdot96)=-3^4\cdot19\cdot1129.
\end{align*}
Reducing the polynomial modulo 11 gives:
$\bar f(x)=x^5+5x+3$.

The Sage instructions :
\begin{verbatim}
R.<x> = PolynomialRing(GF(11))
f = x^5 - 6*x + 3
f.factor()
\end{verbatim}
gives the irreducible factorization:
\begin{align*}
\bar f=(x^2 + 3x + 8)(x^3 + 8x^2 + x + 10).
\end{align*}
Since $\Delta(f)<0$, the Galois group $G_f\subset S_5$ of $f$ over $\mathbb{Q}$ is not a subgroup of $A_5$. The classification of transitive subgroups of $S_5$ given in (13.16) shows that $G_f =S_5$ or $G_f \simeq \mathrm{AGL}(1,\F_5)$.

 Since $11\nmid \Delta(f)$, by Theorem 13.4.5, $G_f$ contains the disjoint product of a 3-cycle and a 2-cycle, which has order $6$, thus the order of the Galois group is divisible by 3 and 2.

 The order of  $\mathrm{AGL}(1,\F_5)$ is $20$. Hence the Galois group $G_f$ of $f$ over $\mathbb{Q}$ is  $G_f = S_5$.

\end{proof}


\paragraph{Ex. 13.4.9}

{\it Prove that two permutations in $S_n$ are conjugate if and only if they have the same cycle type.
\begin{proof}
\be
Let $\sigma \in S_n$ have cycle type $(k_1,k_2,...,k_l)$. Then $\sigma$ can be expressed uniquely as the product of disjoint cycles $\sigma=\alpha_1\alpha_2\cdots\alpha_l$, where $\alpha_i$ is a $k_i$-cycle.

Let $\tau\in S_n$ such that $\rho=\tau\sigma\tau^{-1}$. Then:
\begin{align*}
  \tau\sigma\tau^{-1}&=\tau\alpha_1\alpha_2\cdots\alpha_l\tau^{-1}=\tau\alpha_1\tau^{-1}\tau\alpha_2\tau^{-1}\cdots\tau\alpha_l\tau^{-1}=\alpha_{\tau(1)}\alpha_{\tau(2)}\cdots\alpha_{\tau(l)}  
\end{align*}
Since $\alpha_i$ and $\alpha_j$ are disjoint for $i,j\in\{1,2,...,l\}$, then $\tau\alpha_i\tau^{-1}$ and $\tau\alpha_j\tau^{-1}$ are also disjoint. 

Indeed, being disjoint means no number is moved by both $\alpha_i$ and $\alpha_j$, i.e., there is no $k$ such that $\alpha_i(k)\ne k$ and $\alpha_j(k)\ne k$. If $\tau\alpha_i\tau^{-1}$ and $\tau\alpha_j\tau^{-1}$ are not disjoint, then they both move some number $l$. Then $\tau\alpha_i\tau^{-1}(l)\ne l$ and $\tau\alpha_j\tau^{-1}(l)\ne l$, hence $\alpha_i\tau^{-1}(l)\ne \tau^{-1}(l)$ and $\alpha_j\tau^{-1}(l)\ne \tau^{-1}(l)$, which means that $\tau^{-1}(l)$ is moved by both $\alpha_i$ and $\alpha_j$. This is a contradiction. 

Therefore $\tau\sigma\tau^{-1}$ is the product of $\tau$-conjugates of disjoint cycles for $\sigma$, and these $\tau$-conjugates are disjoint cycles with the same respective lengths, i.e., $\tau\sigma\tau^{-1}$ has the same cycle type as $\sigma$.

For the converse direction, suppose $\sigma_1$ and $\sigma_2$ have the same cycle type $(k_1,k_2,...,k_l)$. Then
$$\sigma_1=(a_1a_2... a_{k_1})(a_{k_1+1}a_{k_1+2}... a_{k_1+k_2})\cdots$$
and
$$\sigma_2=(b_1b_2... b_{k_1})(b_{k_1+1}b_{k_1+2}... b_{k_1+k_2})\cdots$$
where the cycles are disjoint. Let define the permutation $\tau\in S_n$ by $\tau(a_i)=b_i$ for all $i$. Then $\tau\sigma_1\tau^{-1}=\sigma_2$, i.e., $\sigma_1$ and $\sigma_2$ are $\tau$-conjugate.
\ee\end{proof}
}

\paragraph{Ex. 13.4.10}

{\it Let G be a subgroup of $S_n$. For a fixed cycle type $d_1,...,d_r$, consider the set (13.44) of all elements of G with this cycle type.
\be
\item[(a)] Prove that this set is either empty or a union of conjugacy classes of G.
\item[(b)] Give an example where the set is empty, and give another example where it is a union of two conjugacy classes of G.
\ee
\begin{proof}
\be
\item[(a)] For an element $g$ of a subgroup $G$, its conjugacy class is the set of elements conjugate to it: $$\{xgx^{-1} : x \in G\}.$$
Suppose the conjugacy classes of $g$ and $h$ overlap, i.e., $xgx^{-1} = yhy^{-1}$ for some $x$ and $y$ in the subgroup. Therefore
$$g = x^{-1}yhy^{-1}x = (x^{-1}y)h(x^{-1}y)^{-1},$$
which shows each element of $G$ that is conjugate to $g$ is also conjugate to $h$. In the other way, from $xgx^{-1} = yhy^{-1}$ write $h = (y^{-1}x)h(y^{-1}x)^{-1},$ and  similar calculation shows that each element of $G$ that is conjugate to $h$ is also conjugate to $g$.

Hence the conjugacy classes are equal, which means that subgroup $G$ is the set of distinct conjugacy classes $\{S_1,S_2,...,S_l\}$ and any element $x\in G$ belongs to one of the conjugacy class. 

Let $S=\{\sigma\in G \mid \sigma \rm ~has~ cycle~ type~\it d_1,...,d_r\} $. If $G$ does not have element with cycle type $d_1,...,d_r$, then $S$ is empty.

If $S$ is not empty, then any $\sigma\in S$ belongs to some conjugacy class. Let the subset $\{S_{k_1},S_{k_2},...,S_{k_m}\} \subset\{S_1,S_2,...,S_l\}$ is such that any element of $S$ belongs to one of subset in $\{S_{k_1},S_{k_2},...,S_{k_m}\}$.

In Ex. 13.4.9 has been showed that all elements of conjugate class have the same cycle type. It means that if $\tau\in S_{k_i}$, then $\tau$ has cycle type $d_1,...,d_r$, i.e., $\tau\in S$, and this is valid for all $S_{k_i}, k_i\in(k_1,...,k_m)$.  

Therefore, $S=\cup_{i=1}^{m} S_{k_i}$, i.e., the set of elements of $G$ with the same cycle type is either empty or a union of conjugacy classes of $G$.
\item[(b)] Consider subgroup $A_3\subset S_3$. Since $A_3$ doesn't have transpositions,  the cycle type $(d_1,d_2)=(1,2)$ is not possible and set of $A_3$ elements with cycle type (1,2) is empty.

Consider subgroup $A_4\subset S_4$.

The 3-cycle (123) and its inverse (132) are not conjugate in A4. To see this, let's determine all possible $\sigma\in S_4$ that
conjugate (123) to (132). For $\sigma\in S_4$, the condition $\sigma(123)\sigma^{-1} = (132)$ is the same as
$(\sigma(1)\sigma(2)\sigma(3)) = (132)$. There are three possibilities:
 \item[$\bullet$] $\sigma(1) = 1$, so $\sigma(2) = 3$ and $\sigma(3) = 2$, and necessarily $\sigma(4) = 4$. Thus $\sigma = (23)$.
 \item[$\bullet$] $ \sigma(1) = 3$, so $ \sigma(2) = 2$ and $ \sigma(3) = 1$, and necessarily $ \sigma(4) = 4$. Thus $ \sigma = (13)$.
 \item[$\bullet$] $\sigma(1) = 2$, so $ \sigma(2) = 1$ and $ \sigma(3) = 3$, and necessarily $ \sigma(4) = 4$. Thus $ \sigma = (12)$.
 
Therefore the only possible $ \sigma$'s are transpositions, which are not in $A_4$. It is obvious that all other 3-cycles are conjugate to (123) or (132).

Hence, all elements of $A_4$ with cycle type $(d_1,d_2)=(1,3)$ are in the union of two conjugacy classes with the representatives $\{(123),(132)\}$. 

\ee\end{proof}
}

\paragraph{Ex. 13.4.11}

{\it This exercise will explore the ideas introduced in Example 13.4.8.
\be
\item[(a)] For each transitive subgroup of $S_4$, make a table similar to (13.46) that lists the number of elements of each possible cycle type for that subgroup.
\item[(b)] For each polynomial in Exercise 14 of Section 13.1, compute its factorization modulo 200 primes, and record your results in a table similar to (13.45). Use this to guess the Galois group of each polynomial. 
\ee
}

\begin{proof}
\be
\item[(a)] There are five transitive subgroups of $S_4$ - $\{S_4,A_4,C_2\times C_2,C_4,D_8\}$. The following Sage instructions produce the similar to (13.46) table with the percentage of elements of each possible cycle for each subgroup:
\begin{verbatim}
S4 = SymmetricGroup(4)
A4 = AlternatingGroup(4)
C2C2 = PermutationGroup(["(1,3)(2,4)","(1,2)(3,4)"])
C4 = CyclicPermutationGroup(4)
D8 = DihedralGroup(4)
G =[S4,A4,C2C2,C4,D8]

for j in range(5):
    V =[g.cycle_type() for g in G[j]]
    K=[0,0,0,0,0]
    for i in range(len(V)):
        if V[i]==[1,1,1,1] : K[0]=K[i]+1
        elif V[i]==[2,1,1] : K[1]=K[1]+1
        elif V[i]==[3,1] : K[2]=K[2]+1
        elif V[i]==[2,2] : K[3]=K[3]+1
        elif V[i]==[4] : K[4]=K[4]+1
        else : print("Error")
        Sm=sum(K)
    if j==0 :
        row = matrix([round(K[0]/Sm*100.0,1), round(K[1]/Sm*100.0,1)
            ,round(K[2]/Sm*100.0,1)*1,round(K[3]/Sm*100.0,1)
            ,round(K[4]/Sm*100.0,1)])
    else :
        U = [round(K[0]/Sm*100.0,1), round(K[1]/Sm*100.0,1)
            ,round(K[2]/Sm*100.0,1)*1,round(K[3]/Sm*100.0,1)
            ,round(K[4]/Sm*100.0,1)]]
        row = matrix(row.rows()+[U])
C=[["1,1,1,1","1,1,2","1,3","2,2","4"]]+[list(row) for row in row] 
A = ["cycle type","S_4","A_4","C_2xC_2","C_4","D_8"]
C = [[a] + u for a, u in zip(A, C)]
(table(C, header_row=True, frame=True))
\end{verbatim}


\begin{tabular}{|l|l|l|l|l|l|} \hline
cycle type & 1,1,1,1 & 1,1,2 & 1,3 & 2,2 & 4 \\ \hline \hline
$S_4$ & $4.2$ & $25.0$ & $33.3$ & $12.5$ & $25.0$ \\ \hline
$A_4$ & $8.3$ & $0.0$ & $66.7$ & $25.0$ & $0.0$ \\ \hline
$C_2\times C_2$ & $25.0$ & $0.0$ & $0.0$ & $75.0$ & $0.0$ \\ \hline
$C_4$ & $25.0$ & $0.0$ & $0.0$ & $25.0$ & $50.0$ \\ \hline
$D_8$ & $12.5$ & $25.0$ & $0.0$ & $37.5$ & $25.0$ \\ \hline
\end{tabular}

\item[(b)] The following Sage instructions produce the similar to (13.45) table. The percentage of primes corresponding to each possible cycle for 200 primes $7\leq p\leq 1237$ is calculated for each polynomial in Exercise 13.1.14 and the polynomial from Example 13.4.8:
\begin{verbatim}
R.<X> = PolynomialRing(ZZ)
P = Primes()
f=[X^4 - 7*X^3 + 19*X^2 - 23*X + 11,X^4 + 4*X + 2,X^4 + 8*X + 12
    ,X^4 + 1,X^4 + X^3 + X^2 + X + 1,X^4 - 2]
for r in range(6):
    K=[0,0,0,0,0]
    for i in range(2,203):
        R11.<x> = PolynomialRing(GF(P.unrank(i)))
        S=[0,0,0,0]
        for j in range(len(R11(f[r]).factor())):
            d=R11(f[r]).factor()[j][0].degree()
            m=R11(f[r]).factor()[j][1]
            S[d-1]=S[d-1]+m
        if S[0]==4: K[0]=K[0]+1
        elif S[0]==2 and S[1]==1: K[1]=K[1]+1
        elif S[0]==1 and S[2]==1: K[2]=K[2]+1
        elif S[1]==2 : K[3]=K[3]+1
        elif S[3]==1 : K[4]=K[4]+1
        else : print("Error")
        Sm=sum(K)
    if r==0 :
        row = matrix([round(K[0]/Sm*100.0,1), round(K[1]/Sm*100.0,1)
            ,round(K[2]/Sm*100.0,1)*1,round(K[3]/Sm*100.0,1)
            ,round(K[4]/Sm*100.0,1)])
    else :
        U = [round(K[0]/Sm*100.0,1), round(K[1]/Sm*100.0,1)
            ,round(K[2]/Sm*100.0,1)*1,round(K[3]/Sm*100.0,1)
            ,round(K[4]/Sm*100.0,1)]
        row = matrix(row.rows()+[U])
C=[["1,1,1,1","1,1,2","1,3","2,2","4"]]+[list(row) for row in row]
A = ["cycle type"]+f
C = [[a] + u for a, u in zip(A, C)]
B = ["Galois group","C_4","S_4","A_4","C_2xC_2","C_4","D_8"]
C = [a + [u] for a, u in zip(C, B)]
(table(C, header_row=True, frame=True))
\end{verbatim}

\begin{tabular}{|l|l|l|l|l|l|l|} \hline
cycle type & 1,1,1,1 & 1,1,2 & 1,3 & 2,2 & 4 & Galois group \\ \hline \hline
$X^{4} - 7X^{3} + 19X^{2} - 23X + 11$ & $25.4$ & $0.0$ & $0.0$ & $22.9$ & $51.7$ & $C_4$ \\ \hline
$X^{4} + 4X + 2$ & $3.0$ & $26.9$ & $33.8$ & $13.4$ & $22.9$ & $S_4$ \\ \hline
$X^{4} + 8X + 12$ & $6.5$ & $0.0$ & $67.2$ & $26.4$ & $0.0$ & $A_4$ \\ \hline
$X^{4} + 1$ & $22.9$ & $0.0$ & $0.0$ & $77.1$ & $0.0$ & $C_2\times C_2$ \\ \hline
$X^{4} + X^{3} + X^{2} + X + 1$ & $25.4$ & $0.0$ & $0.0$ & $22.9$ & $51.7$ & $C_4$ \\ \hline
$X^{4} - 2$ & $10.4$ & $25.4$ & $0.0$ & $37.3$ & $26.9$ & $D_8$ \\ \hline
\end{tabular}
\\ \\ \\
The last column provides the guess about the Galois group of each polynomial. The comparison with Exercise 14 of Section 13.1 and Example 13.4.8 results supports the Chebotarev Density Theorem. 
%\begin{align*}
%\end{align*}

\ee
\end{proof}
\end{document}
